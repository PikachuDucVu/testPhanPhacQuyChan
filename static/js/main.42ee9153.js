/*! For license information please see main.42ee9153.js.LICENSE.txt */
!function(){var t={7465:function(t){"use strict";var e,i="object"===typeof Reflect?Reflect:null,n=i&&"function"===typeof i.apply?i.apply:function(t,e,i){return Function.prototype.apply.call(t,e,i)};e=i&&"function"===typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var r=Number.isNaN||function(t){return t!==t};function s(){s.init.call(this)}t.exports=s,t.exports.once=function(t,e){return new Promise((function(i,n){function r(i){t.removeListener(e,s),n(i)}function s(){"function"===typeof t.removeListener&&t.removeListener("error",r),i([].slice.call(arguments))}p(t,e,s,{once:!0}),"error"!==e&&function(t,e,i){"function"===typeof t.on&&p(t,"error",e,i)}(t,r,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var a=10;function o(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?s.defaultMaxListeners:t._maxListeners}function u(t,e,i,n){var r,s,a,u;if(o(i),void 0===(s=t._events)?(s=t._events=Object.create(null),t._eventsCount=0):(void 0!==s.newListener&&(t.emit("newListener",e,i.listener?i.listener:i),s=t._events),a=s[e]),void 0===a)a=s[e]=i,++t._eventsCount;else if("function"===typeof a?a=s[e]=n?[i,a]:[a,i]:n?a.unshift(i):a.push(i),(r=h(t))>0&&a.length>r&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=t,l.type=e,l.count=a.length,u=l,console&&console.warn&&console.warn(u)}return t}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function c(t,e,i){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:i},r=l.bind(n);return r.listener=i,n.wrapFn=r,r}function g(t,e,i){var n=t._events;if(void 0===n)return[];var r=n[e];return void 0===r?[]:"function"===typeof r?i?[r.listener||r]:[r]:i?function(t){for(var e=new Array(t.length),i=0;i<e.length;++i)e[i]=t[i].listener||t[i];return e}(r):f(r,r.length)}function d(t){var e=this._events;if(void 0!==e){var i=e[t];if("function"===typeof i)return 1;if(void 0!==i)return i.length}return 0}function f(t,e){for(var i=new Array(e),n=0;n<e;++n)i[n]=t[n];return i}function p(t,e,i,n){if("function"===typeof t.on)n.once?t.once(e,i):t.on(e,i);else{if("function"!==typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function r(s){n.once&&t.removeEventListener(e,r),i(s)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!==typeof t||t<0||r(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||r(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},s.prototype.getMaxListeners=function(){return h(this)},s.prototype.emit=function(t){for(var e=[],i=1;i<arguments.length;i++)e.push(arguments[i]);var r="error"===t,s=this._events;if(void 0!==s)r=r&&void 0===s.error;else if(!r)return!1;if(r){var a;if(e.length>0&&(a=e[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var h=s[t];if(void 0===h)return!1;if("function"===typeof h)n(h,this,e);else{var u=h.length,l=f(h,u);for(i=0;i<u;++i)n(l[i],this,e)}return!0},s.prototype.addListener=function(t,e){return u(this,t,e,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(t,e){return u(this,t,e,!0)},s.prototype.once=function(t,e){return o(e),this.on(t,c(this,t,e)),this},s.prototype.prependOnceListener=function(t,e){return o(e),this.prependListener(t,c(this,t,e)),this},s.prototype.removeListener=function(t,e){var i,n,r,s,a;if(o(e),void 0===(n=this._events))return this;if(void 0===(i=n[t]))return this;if(i===e||i.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete n[t],n.removeListener&&this.emit("removeListener",t,i.listener||e));else if("function"!==typeof i){for(r=-1,s=i.length-1;s>=0;s--)if(i[s]===e||i[s].listener===e){a=i[s].listener,r=s;break}if(r<0)return this;0===r?i.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(i,r),1===i.length&&(n[t]=i[0]),void 0!==n.removeListener&&this.emit("removeListener",t,a||e)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(t){var e,i,n;if(void 0===(i=this._events))return this;if(void 0===i.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==i[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete i[t]),this;if(0===arguments.length){var r,s=Object.keys(i);for(n=0;n<s.length;++n)"removeListener"!==(r=s[n])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(e=i[t]))this.removeListener(t,e);else if(void 0!==e)for(n=e.length-1;n>=0;n--)this.removeListener(t,e[n]);return this},s.prototype.listeners=function(t){return g(this,t,!0)},s.prototype.rawListeners=function(t){return g(this,t,!1)},s.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):d.call(t,e)},s.prototype.listenerCount=d,s.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},3294:function(t,e,i){"use strict";var n=i(4704).default;function r(t){if(this.words=[],null!=(s=t)&&void 0!==s[Symbol.iterator]){var e,i=n(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.add(r)}}catch(a){i.e(a)}finally{i.f()}}var s}r.prototype.add=function(t){this.resize(t),this.words[t>>>5]|=1<<t},r.prototype.flip=function(t){this.resize(t),this.words[t>>>5]^=1<<t},r.prototype.clear=function(){this.words=[]},r.prototype.remove=function(t){this.resize(t),this.words[t>>>5]&=~(1<<t)},r.prototype.isEmpty=function(t){for(var e=this.words.length,i=0;i<e;i++)if(0!==this.words[i])return!1;return!0},r.prototype.has=function(t){return 0!==(this.words[t>>>5]&1<<t)},r.prototype.checkedAdd=function(t){this.resize(t);var e=this.words[t>>>5],i=e|1<<t;return this.words[t>>>5]=i,(i^e)>>>t},r.prototype.trim=function(t){for(var e=this.words.length;e>0&&0===this.words[e-1];)e--;this.words=this.words.slice(0,e)},r.prototype.resize=function(t){for(var e=t+32>>>5,i=this.words.length;i<e;i++)this.words[i]=0},r.prototype.hammingWeight=function(t){return 16843009*((t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)>>>24},r.prototype.hammingWeight4=function(t,e,i,n){return 16843009*((t=(t=(858993459&(t-=t>>>1&1431655765))+(t>>>2&858993459))+(t>>>4)&252645135)+(e=(e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)+(i=(i=(858993459&(i-=i>>>1&1431655765))+(i>>>2&858993459))+(i>>>4)&252645135)+(n=(n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135))>>>24},r.prototype.size=function(){for(var t=0,e=this.words.length,i=this.words,n=0;n<e;n++)t+=this.hammingWeight(i[n]);return t},r.prototype.array=function(){for(var t=new Array(this.size()),e=0,i=this.words.length,n=0;n<i;++n)for(var r=this.words[n];0!=r;){var s=r&-r;t[e++]=(n<<5)+this.hammingWeight(s-1|0),r^=s}return t},r.prototype.forEach=function(t){for(var e=this.words.length,i=0;i<e;++i)for(var n=this.words[i];0!=n;){var r=n&-n;t((i<<5)+this.hammingWeight(r-1|0)),n^=r}},r.prototype.clone=function(){var t=Object.create(r.prototype);return t.words=this.words.slice(),t},r.prototype.intersects=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i<e;++i)if(0!==(this.words[i]&t.words[i]))return!0;return!1},r.prototype.intersection=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i+7<e;i+=8)this.words[i]&=t.words[i],this.words[i+1]&=t.words[i+1],this.words[i+2]&=t.words[i+2],this.words[i+3]&=t.words[i+3],this.words[i+4]&=t.words[i+4],this.words[i+5]&=t.words[i+5],this.words[i+6]&=t.words[i+6],this.words[i+7]&=t.words[i+7];for(;i<e;++i)this.words[i]&=t.words[i];var n=this.words.length;for(i=e;i<n;++i)this.words[i]=0;return this},r.prototype.intersection_size=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0,n=0;n<e;++n)i+=this.hammingWeight(this.words[n]&t.words[n]);return i},r.prototype.new_intersection=function(t){var e=Object.create(r.prototype),i=Math.min(this.words.length,t.words.length);e.words=new Array(i);for(var n=i,s=0;s+7<n;s+=8)e.words[s]=this.words[s]&t.words[s],e.words[s+1]=this.words[s+1]&t.words[s+1],e.words[s+2]=this.words[s+2]&t.words[s+2],e.words[s+3]=this.words[s+3]&t.words[s+3],e.words[s+4]=this.words[s+4]&t.words[s+4],e.words[s+5]=this.words[s+5]&t.words[s+5],e.words[s+6]=this.words[s+6]&t.words[s+6],e.words[s+7]=this.words[s+7]&t.words[s+7];for(;s<n;++s)e.words[s]=this.words[s]&t.words[s];return e},r.prototype.equals=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i<e;++i)if(this.words[i]!=t.words[i])return!1;if(this.words.length<t.words.length){var n=t.words.length;for(i=this.words.length;i<n;++i)if(0!=t.words[i])return!1}else if(t.words.length<this.words.length)for(n=this.words.length,i=t.words.length;i<n;++i)if(0!=this.words[i])return!1;return!0},r.prototype.difference=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i+7<e;i+=8)this.words[i]&=~t.words[i],this.words[i+1]&=~t.words[i+1],this.words[i+2]&=~t.words[i+2],this.words[i+3]&=~t.words[i+3],this.words[i+4]&=~t.words[i+4],this.words[i+5]&=~t.words[i+5],this.words[i+6]&=~t.words[i+6],this.words[i+7]&=~t.words[i+7];for(;i<e;++i)this.words[i]&=~t.words[i];return this},r.prototype.difference_size=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0,n=0;n<e;++n)i+=this.hammingWeight(this.words[n]&~t.words[n]);for(var r=this.words.length;n<r;++n)i+=this.hammingWeight(this.words[n]);return i},r.prototype.toString=function(){return"{"+this.array().join(",")+"}"},r.prototype.union=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0;i+7<e;i+=8)this.words[i]|=t.words[i],this.words[i+1]|=t.words[i+1],this.words[i+2]|=t.words[i+2],this.words[i+3]|=t.words[i+3],this.words[i+4]|=t.words[i+4],this.words[i+5]|=t.words[i+5],this.words[i+6]|=t.words[i+6],this.words[i+7]|=t.words[i+7];for(;i<e;++i)this.words[i]|=t.words[i];if(this.words.length<t.words.length){this.resize((t.words.length<<5)-1);var n=t.words.length;for(i=e;i<n;++i)this.words[i]=t.words[i]}return this},r.prototype.new_union=function(t){var e=Object.create(r.prototype),i=Math.max(this.words.length,t.words.length);e.words=new Array(i);for(var n=Math.min(this.words.length,t.words.length),s=0;s+7<n;s+=8)e.words[s]=this.words[s]|t.words[s],e.words[s+1]=this.words[s+1]|t.words[s+1],e.words[s+2]=this.words[s+2]|t.words[s+2],e.words[s+3]=this.words[s+3]|t.words[s+3],e.words[s+4]=this.words[s+4]|t.words[s+4],e.words[s+5]=this.words[s+5]|t.words[s+5],e.words[s+6]=this.words[s+6]|t.words[s+6],e.words[s+7]=this.words[s+7]|t.words[s+7];for(;s<n;++s)e.words[s]=this.words[s]|t.words[s];var a=this.words.length;for(s=n;s<a;++s)e.words[s]=this.words[s];var o=t.words.length;for(s=n;s<o;++s)e.words[s]=t.words[s];return e},r.prototype.new_difference=function(t){return this.clone().difference(t)},r.prototype.union_size=function(t){for(var e=Math.min(this.words.length,t.words.length),i=0,n=0;n<e;++n)i+=this.hammingWeight(this.words[n]|t.words[n]);if(this.words.length<t.words.length){var r=t.words.length;for(n=this.words.length;n<r;++n)i+=this.hammingWeight(0|t.words[n])}else for(r=this.words.length,n=t.words.length;n<r;++n)i+=this.hammingWeight(0|this.words[n]);return i},t.exports=r},6894:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default,s=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Archetype=void 0;var a=s(i(3294)),o=n((function t(e){r(this,t),this.componentBits=new a.default,this.componentBitsInitialized=!1,this.componentTypes=e}));e.Archetype=o},8315:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Component=void 0;var s=n((function t(){r(this,t)}));e.Component=s},3907:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ComponentMapper=void 0;var s=function(){function t(){n(this,t),this.data=[]}return r(t,[{key:"add",value:function(t,e){this.data[t]=e}},{key:"get",value:function(t){return this.data[t]}},{key:"remove",value:function(t){delete this.data[t]}}]),t}();e.ComponentMapper=s},1776:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=i(1588).default,o=i(3808).default,h=i(1655).default,u=i(6389).default,l=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.EntityIteratingSystem=void 0;var c=i(7812),g=l(i(3294)),d=function(t){h(i,t);var e=u(i);function i(t){var n;return r(this,i),(n=e.call(this)).componentBits=new g.default,n.types=t,n}return s(i,[{key:"setWorld",value:function(t){a(o(i.prototype),"setWorld",this).call(this,t);var e,r=n(this.types);try{for(r.s();!(e=r.n()).done;){var s=e.value;this.componentBits.add(t.getComponentIndex(s))}}catch(h){r.e(h)}finally{r.f()}}},{key:"process",value:function(){this.begin(),this.world.getEntities(this.componentBits,this.processEntity.bind(this)),this.end()}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),i}(c.System);e.EntityIteratingSystem=d},3929:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default,s=i(1655).default,a=i(6389).default;Object.defineProperty(e,"__esModule",{value:!0}),e.EntitySystem=void 0;var o=function(t){s(i,t);var e=a(i);function i(){var t;return n(this,i),(t=e.apply(this,arguments)).entities=[],t}return r(i,[{key:"process",value:function(){this.entities.length=0,this.begin(),this.world.getEntities(this.componentBits,this.processEntity.bind(this)),this.processEntities(this.entities),this.end()}},{key:"processEntity",value:function(t){this.entities.push(t)}}]),i}(i(1776).EntityIteratingSystem);e.EntitySystem=o},8841:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Inject=void 0,e.Inject=function(t){return function(e,i){var n=e.constructor;n.hasOwnProperty("__inject__")||(n.__inject__={}),n.__inject__[i]=t}}},8675:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.InjectMapper=void 0,e.InjectMapper=function(t){return function(e,i){var n=e.constructor;n.hasOwnProperty("__injectMapper__")||(n.__injectMapper__={}),n.__injectMapper__[i]=t}}},7812:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.System=void 0;var s=function(){function t(){n(this,t)}return r(t,[{key:"setWorld",value:function(t){this.world=t}},{key:"initialized",value:function(){}},{key:"dispose",value:function(){}}]),t}();e.System=s},1694:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default,a=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=a(i(3294)),h=i(3907),u=function(){function t(){r(this,t),this.index=0,this.mappers={},this.componentBitsMap=[],this.componentIndices=new Map,this.currentComponentIndex=0,this.activeSystems=[],this.passiveSystems=[],this.injectionRegistry={},this.delta=0}return s(t,[{key:"getNewId",value:function(){return this.index++}},{key:"createEntity",value:function(){return this.getNewId()}},{key:"getComponentBits",value:function(t){return this.componentBitsMap[t]||(this.componentBitsMap[t]=new o.default),this.componentBitsMap[t]}},{key:"getMapper",value:function(t){var e=this.getComponentIndex(t);return this.getMapperByIndex(e)}},{key:"getMapperByIndex",value:function(t){return this.mappers[t]||(this.mappers[t]=new h.ComponentMapper),this.mappers[t]}},{key:"getComponentIndex",value:function(t){var e=this.componentIndices.get(t);return void 0===e&&(e=this.currentComponentIndex++,this.componentIndices.set(t,e)),e}},{key:"createEntityByArchetype",value:function(t){var e=this,i=this.getNewId();return t.componentTypes.forEach((function(n){var r=new n;t.componentBitsInitialized||t.componentBits.add(e.getComponentIndex(n)),e.addComponent(i,r,!1)})),this.componentBitsMap[i]=t.componentBits,i}},{key:"addComponent",value:function(t,e){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getComponentIndex(e.constructor),r=this.getMapperByIndex(n);return r.add(t,e),i&&this.getComponentBits(t).add(n),e}},{key:"getComponent",value:function(t,e){return this.getMapper(e).get(t)}},{key:"getEntities",value:function(t,e){for(var i=0;i<this.componentBitsMap.length;i++)if(this.componentBitsMap[i]){var n=this.componentBitsMap[i];t.union_size(n)===n.size()&&e(i)}}},{key:"addSystem",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e?this.activeSystems.push(t):this.passiveSystems.push(t),t.setWorld(this),this.injectMapper(t),this.inject(t),t.initialized()}},{key:"injectMapper",value:function(t){var e=t.constructor.__injectMapper__||{};for(var i in e){var n=e[i];t[i]=this.getMapper(n)}}},{key:"register",value:function(t,e){this.injectionRegistry[t]=e}},{key:"inject",value:function(t){var e=t.constructor.__inject__||{};for(var i in e){var n=e[i];t[i]=this.injectionRegistry[n]}}},{key:"dispose",value:function(){var t,e=n(this.activeSystems);try{for(e.s();!(t=e.n()).done;){t.value.dispose()}}catch(s){e.e(s)}finally{e.f()}var i,r=n(this.passiveSystems);try{for(r.s();!(i=r.n()).done;){i.value.dispose()}}catch(s){r.e(s)}finally{r.f()}}},{key:"setDelta",value:function(t){this.delta=t}},{key:"processActiveSystem",value:function(){var t,e=n(this.activeSystems);try{for(e.s();!(t=e.n()).done;){t.value.process()}}catch(i){e.e(i)}finally{e.f()}}},{key:"processPassiveSystem",value:function(){var t,e=n(this.passiveSystems);try{for(e.s();!(t=e.n()).done;){t.value.process()}}catch(i){e.e(i)}finally{e.f()}}},{key:"deleteEntity",value:function(t){for(var e in this.mappers)this.mappers[e].remove(t);delete this.componentBitsMap[t]}},{key:"isEntityActive",value:function(t){return!!this.componentBitsMap[t]}}]),t}();e.default=u},7530:function(t,e,i){"use strict";var n=i(1694);Object.defineProperty(e,"q3",{enumerable:!0,get:function(){return n.default}});var r=i(6894);Object.defineProperty(e,"Yl",{enumerable:!0,get:function(){return r.Archetype}});var s=i(8315);Object.defineProperty(e,"wA",{enumerable:!0,get:function(){return s.Component}});var a=i(3907);var o=i(1776);Object.defineProperty(e,"Iw",{enumerable:!0,get:function(){return o.EntityIteratingSystem}});var h=i(3929);var u=i(7812);Object.defineProperty(e,"xP",{enumerable:!0,get:function(){return u.System}});var l=i(8675);Object.defineProperty(e,"rr",{enumerable:!0,get:function(){return l.InjectMapper}});var c=i(8841);Object.defineProperty(e,"tB",{enumerable:!0,get:function(){return c.Inject}})},9054:function(t,e,i){"use strict";var n,r=i(4704).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Animation=e.PlayMode=void 0,function(t){t[t.NORMAL=0]="NORMAL",t[t.LOOP=1]="LOOP",t[t.LOOP_PINGPONG=2]="LOOP_PINGPONG",t[t.REVERSED=3]="REVERSED",t[t.LOOP_REVERSED=4]="LOOP_REVERSED"}(n=e.PlayMode||(e.PlayMode={}));var o=function(){function t(e,i){s(this,t),this.totalDuration=0,this.keyFrames=e,Array.isArray(i)||(i=[i]);for(var n=i[i.length-1]||0;i.length<e.length;)i.push(n);var a,o=r(i);try{for(o.s();!(a=o.n()).done;){var h=a.value;this.totalDuration+=h}}catch(u){o.e(u)}finally{o.f()}this.frameDurations=i}return a(t,[{key:"getFrameNumber",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.frameDurations,n=e?i.length-1:0;!((t-=i[n])<0);)e?n--:n++;return n}},{key:"getKeyFrame",value:function(t,e){var i=this.keyFrames,r=this.frameDurations,s=this.totalDuration,a=Math.floor(t/s),o=t%s,h=0;switch(e){case n.NORMAL:h=0===a?this.getFrameNumber(o):r.length-1;break;case n.LOOP:h=this.getFrameNumber(o);break;case n.LOOP_PINGPONG:h=this.getFrameNumber(o,a%2===1);break;case n.REVERSED:h=0===a?this.getFrameNumber(o,!0):0;break;case n.LOOP_REVERSED:h=this.getFrameNumber(o,!0)}return i[h]}}]),t}();e.Animation=o},7035:function(t,e,i){"use strict";var n=i(861).default,r=i(7061).default,s=i(4704).default,a=i(6690).default,o=i(9728).default,h=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{h(n.next(t))}catch(e){s(e)}}function o(t){try{h(n.throw(t))}catch(e){s(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}h((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.AssetManager=void 0;var u=i(5283),l=i(3432),c=i(8143),g=function(){function t(e){a(this,t),this.promises=[],this.atlases=new Map,this.textures=new Map,this.jsonData=new Map,this.binaryData=new Map,this.done=0,this.listeners=[],this.fonts=new Map,this.gl=e}return o(t,[{key:"addListener",value:function(t){this.listeners.push(t)}},{key:"reportDone",value:function(){this.done++;var t,e=s(this.listeners);try{for(e.s();!(t=e.n()).done;){(0,t.value)(this.done/this.getTotal()*100,this.done>=this.getTotal())}}catch(i){e.e(i)}finally{e.f()}}},{key:"loadAtlas",value:function(t,e){var i=this,n=c.TextureAtlas.load(this.gl,t,{}).then((function(t){return i.atlases.set(e,t),i.reportDone(),t}));return this.promises.push(n),n}},{key:"getAtlas",value:function(t){return this.atlases.get(t)}},{key:"loadJsonData",value:function(t,e){var i=this,n=fetch(t).then((function(t){return t.json()})).then((function(t){return i.jsonData.set(e,t),i.reportDone(),t}));return this.promises.push(n),n}},{key:"getJsonData",value:function(t){return this.jsonData.get(t)}},{key:"loadBinaryData",value:function(t,e){var i=this,n=fetch(t).then((function(t){return t.arrayBuffer()})).then((function(t){return i.binaryData.set(e,t),i.reportDone(),t}));return this.promises.push(n),n}},{key:"getBinaryData",value:function(t){return this.binaryData.get(t)}},{key:"loadFont",value:function(t,e){var i=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=u.BitmapFont.load(this.gl,t,n).then((function(t){return i.fonts.set(e,t),i.reportDone(),t}));return this.promises.push(r),r}},{key:"getFont",value:function(t){return this.fonts.get(t)}},{key:"loadTexture",value:function(t,e){var i=this,n=l.Texture.load(this.gl,t).then((function(t){return i.textures.set(e,t),i.reportDone(),t}));return this.promises.push(n),n}},{key:"getTexture",value:function(t){return this.textures.get(t)}},{key:"finishLoading",value:function(){return h(this,void 0,void 0,r().mark((function t(){return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(this.promises);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"getDone",value:function(){return this.done}},{key:"getTotal",value:function(){return this.promises.length}},{key:"disposeAll",value:function(){var t=this;n(this.atlases.keys()).forEach((function(e){var i;((null===(i=t.atlases.get(e))||void 0===i?void 0:i.getRegions())||[]).forEach((function(t){var e;null===(e=t.texture)||void 0===e||e.destroy()})),t.atlases.delete(e)})),n(this.textures.keys()).forEach((function(e){var i;null===(i=t.textures.get(e))||void 0===i||i.destroy(),t.textures.delete(e)})),n(this.fonts.keys()).forEach((function(e){var i;((null===(i=t.fonts.get(e))||void 0===i?void 0:i.getRegions())||[]).forEach((function(t){var e;null===(e=t.texture)||void 0===e||e.destroy()})),t.fonts.delete(e)}))}}]),t}();e.AssetManager=g,e.default=g},5283:function(t,e,i){"use strict";var n=i(7061).default,r=i(9728).default,s=i(6690).default,a=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{h(n.next(t))}catch(e){s(e)}}function o(t){try{h(n.throw(t))}catch(e){s(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}h((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFont=void 0;var o=i(6735),h=i(909),u=i(8637),l=r((function t(e,i,n){var r=this;s(this,t),this.load=function(t){for(var e=Object.values(t.glyphs),i=0;i<e.length;i++){var n=e[i];if(n)for(var s=0;s<n.length;s++){var a=n[s];a&&t.setGlyphRegion(a,r.regions[a.page])}}null!=t.missingGlyph&&t.setGlyphRegion(t.missingGlyph,r.regions[t.missingGlyph.page])},this.draw=function(t,e,i,n,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:u.Align.left,o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:e.length,c=arguments.length>9?arguments[9]:void 0;r.cache.clear(),r.cache.addText(e,i,n,h,l,s,a,o,c),r.cache.draw(t)},this.getColor=function(){return r.cache.getColor()},this.getScaleX=function(){return r.data.scaleX},this.getScaleY=function(){return r.data.scaleY},this.getRegions=function(){return r.regions},this.getRegion=function(t){return r.regions[t]},this.getLineHeight=function(){return r.data.lineHeight},this.getSpaceXadvance=function(){return r.data.spaceXadvance},this.getXHeight=function(){return r.data.xHeight},this.getCapHeight=function(){return r.data.capHeight},this.getAscent=function(){return r.data.ascent},this.getDescent=function(){return r.data.descent},this.isFlipped=function(){return r.flipped},this.dispose=function(){if(r.ownsTexture)for(var t=0;t<r.regions.length;t++)r.regions[t].texture.dispose()},this.setFixedWidthGlyphs=function(t){for(var e=r.data,i=0,n=0,s=t.length;n<s;n++){var a=e.getGlyph(t.charAt(n));null!=a&&a.xadvance>i&&(i=a.xadvance)}for(var o=0,h=t.length;o<h;o++){var u=e.getGlyph(t.charAt(o));u&&(u.xoffset+=(i-u.xadvance)/2,u.xadvance=i,u.kerning=[],u.kerning=null,u.fixedWidth=!0)}},this.setUseIntegerPositions=function(t){r.integer=t,r.cache.setUseIntegerPositions(t)},this.usesIntegerPositions=function(){return r.integer},this.getCache=function(){return r.cache},this.getData=function(){return r.data},this.getOwnsTexture=function(){return r.ownsTexture},this.setOwnsTexture=function(t){r.ownsTexture=t},this.newFontCache=function(){return new o.BitmapFontCache(r,r.integer)},this.regions=i,this.flipped=e.flipped,this.data=e,this.integer=n,0!==this.regions.length?(this.ownsTexture=!1,this.cache=this.newFontCache(),this.load(e)):console.log("No texture region were found")}));e.BitmapFont=l,l.load=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return a(void 0,void 0,void 0,n().mark((function s(){var a;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=new h.BitmapFontData(e,i),n.next=3,a.loadFont(t);case 3:return n.abrupt("return",new l(a,a.regions,r));case 4:case"end":return n.stop()}}),s)})))}},6735:function(t,e,i){"use strict";var n=i(861).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFontCache=void 0;var a=i(417),o=i(2226),h=i(8637),u=function(){function t(e,i){var s=this;r(this,t),this.tempColor=new h.Color(1,1,1,1),this.drawingTexts=[],this.layouts=[],this.pooledLayouts=[],this.color=new h.Color(1,1,1,1),this.setPosition=function(t,e){s.translate(t-s.x,e-s.y)},this.translate=function(t,e){if(0!==t||0!==e){s.integer&&(t=Math.round(t),e=Math.round(e)),s.x+=t,s.y+=e;for(var i=s.pageVertices,n=0,r=i.length;n<r;n++)for(var a=i[n],o=0,h=s.idx[n];o<h;o+=5)a[o]+=t,a[o+1]+=e}},this.setColors=function(t,e,i,n){for(var r=255<<24|255*i<<16|255*e<<8|255*t,a=o.NumberUtil.intToFloatColor(r),h=0,u=s.pageVertices.length;h<u;h++)for(var l=s.pageVertices[h],c=2,g=s.idx[h];c<g;c+=5)l[c]=a},this.getColor=function(){return s.color},this.setColor=function(t,e,i,n){s.color.set(t,e,i,n)},this.clear=function(){s.x=0,s.y=0,h.Pools.freeAll("GlyphLayout",s.pooledLayouts),s.pooledLayouts.length=0,s.layouts.length=0;for(var t=0,e=s.idx.length;t<e;t++)null!=s.pageGlyphIndices&&(s.pageGlyphIndices[t].length=0),s.idx[t]=0},this.requireGlyphs=function(t){if(1===s.pageVertices.length)s.requirePageGlyphs(0,t.glyphCount);else{for(var e=s.tempGlyphCount,i=0;i<e.length;i++)e[i]=0;for(var n=0,r=t.runs.length;n<r;n++)for(var a=t.runs[n].glyphs,o=a,h=0,u=a.length;h<u;h++)e[o[h].page]++;for(var l=0,c=e.length;l<c;l++)s.requirePageGlyphs(l,e[l])}},this.requirePageGlyphs=function(t,e){var i=s.idx[t]+20*e,n=s.pageVertices[t];if(n){if(n.length<i){var r=new Array(i);h.Utils.arrayCopy(n,0,r,0,s.idx[t]),s.pageVertices[t]=r}}else s.pageVertices[t]=new Array(i)},this.setPageCount=function(t){var e=new Array(t).fill([]);h.Utils.arrayCopy(s.pageVertices,0,e,0,s.pageVertices.length),s.pageVertices=n(e);var i=new Array(t);h.Utils.arrayCopy(s.idx,0,i,0,s.idx.length),s.idx=i;var r=new Array(t),a=0;null!=s.pageGlyphIndices&&(a=s.pageGlyphIndices.length,h.Utils.arrayCopy(s.pageGlyphIndices,0,r,0,s.pageGlyphIndices.length));for(var o=a;o<t;o++)r[o]=[];s.pageGlyphIndices=r,s.tempGlyphCount=new Array(t)},this.addToCache=function(t,e,i){var n=t.runs.length;if(0!==n){s.pageVertices.length<s.font.regions.length&&s.setPageCount(s.font.regions.length),s.layouts.push(t),s.requireGlyphs(t);var r=t.colors,a=0,h=0,u=0,l=0;s.drawingTexts.length=0;for(var c=0;c<n;c++)for(var g=t.runs[c],d=g.glyphs,f=g.xAdvances,p=e+g.x,_=i+g.y,v=0,y=g.glyphs.length;v<y;v++)u++===h&&(l=o.NumberUtil.intToFloatColor(r[++a]),h=++a<r.length?r[a]:-1),p+=f[v],s.drawingTexts.push(d[v].id),s.addGlyph(d[v],p,_,l);s.currentTint=o.NumberUtil.intToFloatColor(-1)}},this.addGlyph=function(t,e,i,n){var r=s.font.data.scaleX,a=s.font.data.scaleY;e+=t.xoffset*r,i+=t.yoffset*a;var o=t.width*r,h=t.height*a,u=t.u,l=t.u2,c=t.v,g=t.v2;s.integer&&(e=Math.round(e),i=Math.round(i),o=Math.round(o),h=Math.round(h));var d=e+o,f=i+h,p=t.page,_=s.idx[p];s.idx[p]+=20,null!=s.pageGlyphIndices&&s.pageGlyphIndices[p].push(s.glyphCount++);var v=s.pageVertices[p];v[_++]=e,v[_++]=i,v[_++]=n,v[_++]=u,v[_++]=c,v[_++]=e,v[_++]=f,v[_++]=n,v[_++]=u,v[_++]=g,v[_++]=d,v[_++]=f,v[_++]=n,v[_++]=l,v[_++]=g,v[_++]=d,v[_++]=i,v[_++]=n,v[_++]=l,v[_]=c},this.setText=function(t,e,i,n,r,a,o,h,u){return s.clear(),s.addText(t,e,i,n,r,a,o,h,u)},this.setTextToCache=function(t,e,i){s.clear(),s.addTextToCache(t,e,i)},this.addText=function(t,e,i,n,r,a,o,u,l){var c=h.Pools.obtain("GlyphLayout");return s.pooledLayouts.push(c),c.setText(s.font,t,n,r,s.color,a,o,u,l),s.addTextToCache(c,e,i),c},this.addTextToCache=function(t,e,i){s.addToCache(t,e,i+s.font.data.ascent)},this.getX=function(){return s.x},this.getY=function(){return s.y},this.getFont=function(){return s.font},this.setUseIntegerPositions=function(t){s.integer=t},this.usesIntegerPositions=function(){return s.integer},this.getVertices=function(t){return s.pageVertices[t]},this.getVertexCount=function(t){return s.idx[t]},this.getLayouts=function(){return s.layouts},this.font=e,this.integer=i;var u=e.regions.length;if(0===u&&console.log("The specified font must contain at least one texture page."),this.pageVertices=new Array(u).fill([]),this.idx=new Array(u),u>1){this.pageGlyphIndices=new Array(u);for(var l=0,c=this.pageGlyphIndices.length;l<c;l++)this.pageGlyphIndices[l]=[]}this.tempGlyphCount=new Array(u),h.Pools.get("GlyphLayout",(function(){return new a.GlyphLayout(e,"",0,0,h.Color.WHITE,0,h.Align.left,!1)}))}return s(t,[{key:"draw",value:function(t){for(var e=this,i=this.font.getRegions(),n=0;n<this.pageVertices.length;n++)if(this.idx[n]>0)for(var r=this.pageVertices[n],s=function(n){var s=20*n,a=i.find((function(t){var i;return t.id===(null===(i=e.drawingTexts)||void 0===i?void 0:i[n])}));a&&a.draw(t,r[0+s],r[1+s],r[10+s]-r[0+s],r[11+s]-r[1+s])},a=0;a<this.idx[n]/20;a++)s(a)}}]),t}();e.BitmapFontCache=u},909:function(t,e,i){"use strict";var n=i(861).default,r=i(7061).default,s=i(6690).default,a=i(9728).default,o=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{h(n.next(t))}catch(e){s(e)}}function o(t){try{h(n.throw(t))}catch(e){s(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}h((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BitmapFontData=void 0;var h=i(5508),u=i(3432),l=i(8026);function c(t,e){for(var i=t.split("/"),n=e.split("/"),r=[],s=0,a=i.length;s<a;s++)if(".."===i[s])r.pop();else{if("."===i[s])continue;r.push(i[s])}for(var o=0,h=n.length;o<h;o++)if(".."===n[o])r.pop();else{if("."===n[o])continue;r.push(n[o])}return r.join("/")}var g=65535,d=function(){function t(e,i){var n=this;s(this,t),this.capHeight=1,this.blankLineScale=1,this.scaleX=1,this.scaleY=1,this.glyphs={},this.xHeight=1,this.xChars=["x","e","a","o","n","s","r","c","u","m","v","w","z"],this.capChars=["M","N","B","D","C","E","F","K","A","G","H","I","J","L","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this.loadFont=function(t){return o(n,void 0,void 0,r().mark((function e(){var i,n,s,a,o,d,p,_,v,y,m,x,M,w,b,E,S,C,k,P,I,D,R,T,L,A,V,O,F,N,j,B,z,G,W,H,X,Y,U,q,Z,K,J,Q,$,tt,et,it,nt,rt,st,at,ot,ht,ut,lt,ct,gt,dt,ft,pt,_t,vt,yt,mt,xt;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.imagePaths){e.next=2;break}return e.abrupt("return");case 2:return i=0,e.next=5,fetch(this.fontFile);case 5:return s=e.sent,e.next=8,s.text();case 8:if(n=e.sent,a=n.split(/\r?\n/).map((function(t){return t.trim()})),e.prev=10,"string"===typeof(o=a[i])){e.next=14;break}throw new Error("File is empty.");case 14:if(o=o.substring(o.indexOf("padding=")+8),4===(d=o.substring(0,o.indexOf(" ")).split(",",4)).length){e.next=18;break}throw new Error("Invalid padding.");case 18:if(this.padTop=parseInt(d[0]),this.padRight=parseInt(d[1]),this.padBottom=parseInt(d[2]),this.padLeft=parseInt(d[3]),p=this.padTop+this.padBottom,i++,"string"===typeof(o=a[i])){e.next=27;break}throw new Error("Missing common header.");case 27:if(!((_=o.split(" ",9)).length<3)){e.next=30;break}throw new Error("Invalid common header.");case 30:if(_[1].startsWith("lineHeight=")){e.next=32;break}throw new Error("Missing: lineHeight");case 32:if(this.lineHeight=parseInt(_[1].substring(11)),_[2].startsWith("base=")){e.next=35;break}throw new Error("Missing: base");case 35:if(v=parseInt(_[2].substring(5)),y=1,_.length>=6&&null!=_[5]&&_[5].startsWith("pages="))try{y=Math.max(1,parseInt(_[5].substring(6)))}catch(r){}this.imagePaths=new Array(y),m=[],x=0;case 41:if(!(x<y)){e.next=65;break}if(i++,"string"===typeof(o=a[i])){e.next=46;break}throw new Error("Missing additional page definitions.");case 46:if(!((M=o.match(new RegExp(".*id=(\\d+)")))&&M.length>1)){e.next=57;break}if(w=M[1],e.prev=49,parseInt(w)===x){e.next=53;break}throw new Error("Page IDs must be indices starting at 0: "+w);case 53:e.next=57;break;case 55:e.prev=55,e.t0=e.catch(49);case 57:if((b=o.match(new RegExp('.*file="?([^"]+)"?')))&&!(b.length<=1)){e.next=60;break}throw new Error("Missing: file");case 60:E=b[1],m[x]=E;case 62:x++,e.next=41;break;case 65:this.descent=0;case 66:if(i++,o=a[i]){e.next=71;break}return e.abrupt("break",105);case 71:if(!o.startsWith("kernings ")){e.next=73;break}return e.abrupt("break",105);case 73:if(!o.startsWith("metrics ")){e.next=75;break}return e.abrupt("break",105);case 75:if(o.startsWith("char ")){e.next=77;break}return e.abrupt("continue",66);case 77:if(S=new h.Glyph,(C=new f(o,"=")).nextToken(),C.nextToken(),!((k=parseInt(C.nextToken()))>0&&k>g)){e.next=84;break}return e.abrupt("continue",66);case 84:if(S.id=k+"",C.nextToken(),S.srcX=parseInt(C.nextToken()),C.nextToken(),S.srcY=parseInt(C.nextToken()),C.nextToken(),S.width=parseInt(C.nextToken()),C.nextToken(),S.height=parseInt(C.nextToken()),C.nextToken(),S.xoffset=parseInt(C.nextToken()),C.nextToken(),this.flipped?S.yoffset=parseInt(C.nextToken()):S.yoffset=-(S.height+parseInt(C.nextToken())),C.nextToken(),S.xadvance=parseInt(C.nextToken()),C.hasMoreTokens()&&C.nextToken(),C.hasMoreTokens())try{S.page=parseInt(C.nextToken())}catch(Mt){}S.width>0&&S.height>0&&(this.descent=Math.min(v+S.yoffset,this.descent)),k<=0?this.missingGlyph=S:k<=g&&this.setGlyph(k,S),e.next=66;break;case 105:this.descent+=this.padBottom;case 106:if(i++,"string"===typeof(o=a[i])){e.next=111;break}return e.abrupt("break",127);case 111:if(o.startsWith("kerning ")){e.next=113;break}return e.abrupt("break",127);case 113:if((P=new f(o,"=")).nextToken(),P.nextToken(),I=parseInt(P.nextToken()),P.nextToken(),D=parseInt(P.nextToken()),!(I<0||I>g||D<0||D>g)){e.next=121;break}return e.abrupt("continue",106);case 121:R=this.getGlyph(I+""),P.nextToken(),T=parseInt(P.nextToken()),R&&R.setKerning(D,T),e.next=106;break;case 127:L=!1,A=0,V=0,O=0,F=0,N=0,j=0,B=0,null!=o&&o.startsWith("metrics ")&&(L=!0,(z=new f(o,"=")).nextToken(),z.nextToken(),A=parseFloat(z.nextToken()),z.nextToken(),V=parseFloat(z.nextToken()),z.nextToken(),O=parseFloat(z.nextToken()),z.nextToken(),F=parseFloat(z.nextToken()),z.nextToken(),N=parseFloat(z.nextToken()),z.nextToken(),j=parseFloat(z.nextToken()),z.nextToken(),B=parseFloat(z.nextToken())),(G=this.getGlyph("32"))||((G=new h.Glyph).id="32",(W=this.getGlyph("l"))||(W=this.getFirstGlyph()),G.xadvance=W.xadvance,this.setGlyph(32,G)),0===G.width&&(G.width=this.padLeft+G.xadvance+this.padRight,G.xoffset=-this.padLeft),this.spaceXadvance=G.xadvance,X=0;case 141:if(!(X<this.xChars.length)){e.next=148;break}if(!(H=this.getGlyph(this.xChars[X]))){e.next=145;break}return e.abrupt("break",148);case 145:X++,e.next=141;break;case 148:H||(H=this.getFirstGlyph()),this.xHeight=H.height-p,U=0;case 151:if(!(U<this.capChars.length)){e.next=158;break}if(!(Y=this.getGlyph(this.capChars[U]))){e.next=155;break}return e.abrupt("break",158);case 155:U++,e.next=151;break;case 158:if(Y){e.next=178;break}q=Object.values(this.glyphs),Z=0;case 161:if(!(Z<q.length)){e.next=176;break}if(K=q[Z]){e.next=165;break}return e.abrupt("continue",173);case 165:J=0;case 166:if(!(J<K.length)){e.next=173;break}if(K[J]&&0!==K[J].height&&0!==K[J].width){e.next=169;break}return e.abrupt("continue",170);case 169:this.capHeight=Math.max(this.capHeight,K[J].height);case 170:J++,e.next=166;break;case 173:Z++,e.next=161;break;case 176:e.next=179;break;case 178:this.capHeight=Y.height;case 179:for(this.capHeight-=p,this.ascent=v-this.capHeight,this.down=-this.lineHeight,this.flipped&&(this.ascent=-this.ascent,this.down=-this.down),L&&(this.ascent=A,this.descent=V,this.down=O,this.capHeight=F,this.lineHeight=N,this.spaceXadvance=j,this.xHeight=B),Q=[],$=Object.values(this.glyphs),tt=0;tt<$.length;tt++)for(et=Object.values($[tt]),it=0;it<et.length;it++)nt={id:et[it].id,left:et[it].srcX,top:et[it].srcY,width:et[it].width,height:et[it].height,xoffset:et[it].xoffset,yoffset:et[it].yoffset,xadvance:et[it].xadvance,page:m[et[it].page],pageId:et[it].page},Q.push(nt);rt=[],st=0;case 189:if(!(st<y)){e.next=199;break}return e.next=192,u.Texture.load(t,c(this.fontFile,"../".concat(m[st])));case 192:at=e.sent,ot=1/at.width,ht=1/at.height,rt.push({texture:at,invTexWidth:ot,invTexHeight:ht});case 196:st++,e.next=189;break;case 199:for(this.regions=[],ut=0,lt=Q;ut<lt.length;ut++)ct=lt[ut],gt=ct.left,dt=ct.top,ft=ct.width,pt=ct.height,_t=rt[ct.pageId],vt=_t.texture,yt=_t.invTexWidth,mt=_t.invTexHeight,(xt=new l.TextureRegion(vt,gt,dt,ft,pt,ct,yt,mt)).originalWidth=ft,xt.originalHeight=pt,xt.offsetX=0,xt.offsetY=0,this.regions.push(xt);e.next=206;break;case 203:e.prev=203,e.t1=e.catch(10),console.error(e.t1);case 206:case"end":return e.stop()}}),e,this,[[10,203],[49,55]])})))},this.setGlyphRegion=function(t,e){var i=e.texture,r=1/i.width,s=1/i.height,a=e.u,o=e.v,h=(e.originalWidth,e.originalHeight,t.srcX),u=t.srcX+t.width,l=t.srcY,c=t.srcY+t.height;t.u=a+h*r,t.u2=a+u*r,n.flipped?(t.v=o+l*s,t.v2=o+c*s):(t.v2=o+l*s,t.v=o+c*s)},this.setLineHeight=function(t){n.lineHeight=t*n.scaleY,n.down=n.flipped?n.lineHeight:-n.lineHeight},this.setGlyph=function(t,e){var i=n.glyphs[t/h.PAGE_SIZE];i||(i=new Array(h.PAGE_SIZE),n.glyphs[t/h.PAGE_SIZE]=i),i[t&h.PAGE_SIZE-1]=e},this.getFirstGlyph=function(){for(var t=Object.values(n.glyphs),e=0;e<t.length;e++){var i=t[e];if(i)for(var r=0;r<i.length;r++){var s=i[r];if(s&&0!==s.height&&0!==s.width)return s}}},this.hasGlyph=function(t){return!!n.missingGlyph||null!=n.getGlyph(t)},this.getGlyph=function(t){var e=n.glyphs[t.charCodeAt(0)/h.PAGE_SIZE];if(null!=e)return e[t.charCodeAt(0)&h.PAGE_SIZE-1]},this.getGlyphs=function(t,e,i,r,s){if(0!==r-i){var a=n.markupEnabled,o=n.scaleX,h=t.glyphs,u=t.xAdvances;do{var l=e.charAt(i++);if("\r"!==l){var c=n.getGlyph(l);if(!c){if(!n.missingGlyph)continue;c=n.missingGlyph}h.push(c),u.push(s?(s.xadvance+s.getKerning(l))*o:c.fixedWidth?0:-c.xoffset*o-n.padLeft),s=c,a&&"["===l&&i<r&&"["===e.charAt(i)&&i++}}while(i<r);if(s){var g=s.fixedWidth?s.xadvance*o:(s.width+s.xoffset)*o-n.padRight;u.push(g)}}},this.getWrapIndex=function(t,e){var i=e-1,r=t,s=r[i].id;if(n.isWhitespace(s+""))return i;for(n.isBreakChar(s+"")&&i--;i>0;i--)if(s=r[i].id,n.isWhitespace(s+"")||n.isBreakChar(s+""))return i+1;return 0},this.isBreakChar=function(t){if(!n.breakChars)return!1;for(var e=String.fromCharCode(parseInt(t)),i=0;i<n.breakChars.length;i++)if(e===n.breakChars[i])return!0;return!1},this.isWhitespace=function(t){switch(String.fromCharCode(parseInt(t))){case"\n":case"\r":case"\t":case" ":return!0;default:return!1}},this.getImagePath=function(t){return n.imagePaths[t]},this.getImagePaths=function(){return n.imagePaths},this.setScale=function(t,e){if(0!==t&&0!==e){var i=t/n.scaleX,r=e/n.scaleY;n.lineHeight*=r,n.spaceXadvance*=i,n.xHeight*=r,n.capHeight*=r,n.ascent*=r,n.descent*=r,n.down*=r,n.padLeft*=i,n.padRight*=i,n.padTop*=r,n.padBottom*=r,n.scaleX=t,n.scaleY=e}},this.scale=function(t){n.setScale(n.scaleX+t,n.scaleY+t)},this.fontFile=e,this.flipped=i}return a(t,[{key:"setXYScale",value:function(t){this.setScale(t,t)}}]),t}();e.BitmapFontData=d;var f=function(){function t(e,i){s(this,t),this.strArray=[],this.currentIndex=0;for(var r=e.split(/\s+/),a=0;a<r.length;a++){var o,h=r[a];(o=this.strArray).push.apply(o,n(h.split(i)))}}return a(t,[{key:"hasMoreTokens",value:function(){return this.currentIndex>=this.strArray.length}},{key:"nextToken",value:function(){return this.strArray[this.currentIndex++]}}]),t}()},2691:function(t,e,i){"use strict";var n=i(4704).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.BoundingBox=void 0;var a=i(2668),o=function(){function t(){r(this,t),this.min=new a.Vector3,this.max=new a.Vector3,this.cnt=new a.Vector3,this.dim=new a.Vector3,this.clr()}return s(t,[{key:"getCenter",value:function(t){return t.setFrom(this.cnt)}},{key:"getCenterX",value:function(){return this.cnt.x}},{key:"getCenterY",value:function(){return this.cnt.y}},{key:"getCenterZ",value:function(){return this.cnt.z}},{key:"getCorner000",value:function(t){return t.set(this.min.x,this.min.y,this.min.z)}},{key:"getCorner001",value:function(t){return t.set(this.min.x,this.min.y,this.max.z)}},{key:"getCorner010",value:function(t){return t.set(this.min.x,this.max.y,this.min.z)}},{key:"getCorner011",value:function(t){return t.set(this.min.x,this.max.y,this.max.z)}},{key:"getCorner100",value:function(t){return t.set(this.max.x,this.min.y,this.min.z)}},{key:"getCorner101",value:function(t){return t.set(this.max.x,this.min.y,this.max.z)}},{key:"getCorner110",value:function(t){return t.set(this.max.x,this.max.y,this.min.z)}},{key:"getCorner111",value:function(t){return t.set(this.max.x,this.max.y,this.max.z)}},{key:"getDimensions",value:function(t){return t.setFrom(this.dim)}},{key:"getWidth",value:function(){return this.dim.x}},{key:"getHeight",value:function(){return this.dim.y}},{key:"getDepth",value:function(){return this.dim.z}},{key:"getMin",value:function(t){return t.setFrom(this.min)}},{key:"getMax",value:function(t){return t.setFrom(this.max)}},{key:"setFromBounds",value:function(t){return this.set(t.min,t.max)}},{key:"set",value:function(t,e){return this.min.set(t.x<e.x?t.x:e.x,t.y<e.y?t.y:e.y,t.z<e.z?t.z:e.z),this.max.set(t.x>e.x?t.x:e.x,t.y>e.y?t.y:e.y,t.z>e.z?t.z:e.z),this.update(),this}},{key:"update",value:function(){this.cnt.setFrom(this.min).add(this.max).scale(.5),this.dim.setFrom(this.max).sub(this.min)}},{key:"setFromPoints",value:function(t){this.inf();var e,i=n(t);try{for(i.s();!(e=i.n()).done;){var r=e.value;this.extPoint(r)}}catch(s){i.e(s)}finally{i.f()}return this}},{key:"inf",value:function(){return this.min.set(1/0,1/0,1/0),this.max.set(-1/0,-1/0,-1/0),this.cnt.set(0,0,0),this.dim.set(0,0,0),this}},{key:"extPoint",value:function(t){return this.set(this.min.set(Math.min(this.min.x,t.x),Math.min(this.min.y,t.y),Math.min(this.min.z,t.z)),this.max.set(Math.max(this.max.x,t.x),Math.max(this.max.y,t.y),Math.max(this.max.z,t.z)))}},{key:"clr",value:function(){return this.set(this.min.set(0,0,0),this.max.set(0,0,0))}},{key:"isValid",value:function(){return this.min.x<=this.max.x&&this.min.y<=this.max.y&&this.min.z<=this.max.z}},{key:"extBounds",value:function(t){return this.set(this.min.set(Math.min(this.min.x,t.min.x),Math.min(this.min.y,t.min.y),Math.min(this.min.z,t.min.z)),this.max.set(Math.max(this.max.x,t.max.x),Math.max(this.max.y,t.max.y),Math.max(this.max.z,t.max.z)))}},{key:"extSphere",value:function(t,e){return this.set(this.min.set(Math.min(this.min.x,t.x-e),Math.min(this.min.y,t.y-e),Math.min(this.min.z,t.z-e)),this.max.set(Math.max(this.max.x,t.x+e),Math.max(this.max.y,t.y+e),Math.max(this.max.z,t.z+e)))}},{key:"extTransformedBox",value:function(e,i){return this.extPoint(t.tmpVector.set(e.min.x,e.min.y,e.min.z).multiply(i)),this.extPoint(t.tmpVector.set(e.min.x,e.min.y,e.max.z).multiply(i)),this.extPoint(t.tmpVector.set(e.min.x,e.max.y,e.min.z).multiply(i)),this.extPoint(t.tmpVector.set(e.min.x,e.max.y,e.max.z).multiply(i)),this.extPoint(t.tmpVector.set(e.max.x,e.min.y,e.min.z).multiply(i)),this.extPoint(t.tmpVector.set(e.max.x,e.min.y,e.max.z).multiply(i)),this.extPoint(t.tmpVector.set(e.max.x,e.max.y,e.min.z).multiply(i)),this.extPoint(t.tmpVector.set(e.max.x,e.max.y,e.max.z).multiply(i)),this}},{key:"mul",value:function(e){var i=this.min.x,n=this.min.y,r=this.min.z,s=this.max.x,a=this.max.y,o=this.max.z;return this.inf(),this.extPoint(t.tmpVector.set(i,n,r).multiply(e)),this.extPoint(t.tmpVector.set(i,n,o).multiply(e)),this.extPoint(t.tmpVector.set(i,a,r).multiply(e)),this.extPoint(t.tmpVector.set(i,a,o).multiply(e)),this.extPoint(t.tmpVector.set(s,n,r).multiply(e)),this.extPoint(t.tmpVector.set(s,n,o).multiply(e)),this.extPoint(t.tmpVector.set(s,a,r).multiply(e)),this.extPoint(t.tmpVector.set(s,a,o).multiply(e)),this}},{key:"containsBounds",value:function(t){return!this.isValid()||this.min.x<=t.min.x&&this.min.y<=t.min.y&&this.min.z<=t.min.z&&this.max.x>=t.max.x&&this.max.y>=t.max.y&&this.max.z>=t.max.z}},{key:"intersects",value:function(t){if(!this.isValid())return!1;var e=Math.abs(this.cnt.x-t.cnt.x),i=this.dim.x/2+t.dim.x/2,n=Math.abs(this.cnt.y-t.cnt.y),r=this.dim.y/2+t.dim.y/2,s=Math.abs(this.cnt.z-t.cnt.z),a=this.dim.z/2+t.dim.z/2;return e<=i&&n<=r&&s<=a}},{key:"containsPoint",value:function(t){return this.min.x<=t.x&&this.max.x>=t.x&&this.min.y<=t.y&&this.max.y>=t.y&&this.min.z<=t.z&&this.max.z>=t.z}},{key:"ext",value:function(t,e,i){return this.set(this.min.set(Math.min(this.min.x,t),Math.min(this.min.y,e),Math.min(this.min.z,i)),this.max.set(Math.max(this.max.x,t),Math.max(this.max.y,e),Math.max(this.max.z,i)))}}]),t}();e.BoundingBox=o,o.tmpVector=new a.Vector3},814:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.OrthoCamera=void 0;var s=i(5474),a=i(2668),o=function(){function t(e,i,r,o){n(this,t),this.position=new a.Vector3(0,0,0),this.direction=new a.Vector3(0,0,-1),this.up=new a.Vector3(0,1,0),this.near=0,this.far=100,this.zoom=1,this.viewportWidth=0,this.viewportHeight=0,this.projectionView=new s.Matrix4,this.inverseProjectionView=new s.Matrix4,this.projection=new s.Matrix4,this.view=new s.Matrix4,this.tmp3=new a.Vector3,this.resize(e,i,r,o)}return r(t,[{key:"setYDown",value:function(t){t?(this.up.set(0,-1,0),this.direction.set(0,0,1)):(this.up.set(0,1,0),this.direction.set(0,0,-1)),this.update()}},{key:"resize",value:function(t,e,i,n){this.viewportWidth=t,this.viewportHeight=e,this.screenWidth=i,this.screenHeight=n,this.update()}},{key:"setPosition",value:function(t,e){this.position.set(t,e,this.position.z)}},{key:"update",value:function(){var t=this.projection,e=this.view,i=this.projectionView,n=this.inverseProjectionView,r=this.zoom,s=this.viewportWidth,a=this.viewportHeight;t.ortho(r*(-s/2),r*(s/2),r*(-a/2),r*(a/2),this.near,this.far),e.lookAt(this.position,this.direction,this.up),i.set(t.values),i.multiply(e),n.set(i.values).invert(),this.combined=i.values}},{key:"screenToWorld",value:function(t,e,i){e=e||this.screenWidth,i=i||this.screenHeight;var n=t.x,r=i-t.y-1;return t.x=2*n/e-1,t.y=2*r/i-1,t.z=2*t.z-1,t.project(this.inverseProjectionView),t}},{key:"worldToScreen",value:function(t,e,i){return e=e||this.screenWidth,i=i||this.screenHeight,t.project(this.projectionView),t.x=e*(t.x+1)/2,t.y=i*(t.y+1)/2,t.z=(t.z+1)/2,t}},{key:"unprojectVector2",value:function(t,e){this.tmp3.set(e.x,e.y,0),this.screenToWorld(this.tmp3),t.set(this.tmp3.x,this.tmp3.y)}},{key:"setViewport",value:function(t,e){this.viewportWidth=t,this.viewportHeight=e}}]),t}();e.OrthoCamera=o},2229:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Game=void 0;var s=function(){function t(){n(this,t)}return r(t,[{key:"setScreen",value:function(t){this.currentScreen&&this.currentScreen.dispose&&this.currentScreen.dispose(),this.currentScreen=t,this.currentScreen&&this.currentScreen.init&&this.currentScreen.init(this)}},{key:"update",value:function(t){this.currentScreen&&this.currentScreen.update&&this.currentScreen.update(t,this)}}]),t}();e.Game=s,s.shared=new s},5508:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Glyph=e.PAGES=e.PAGE_SIZE=e.LOG2_PAGE_SIZE=void 0,e.LOG2_PAGE_SIZE=9,e.PAGE_SIZE=1<<e.LOG2_PAGE_SIZE,e.PAGES=65536/e.PAGE_SIZE;var s=function(){function t(){n(this,t),this.page=0}return r(t,[{key:"getKerning",value:function(t){if(this.kerning){var i=this.kerning[t.charCodeAt(0)>>>e.LOG2_PAGE_SIZE];if(null!=i)return i[t.charCodeAt(0)&e.PAGE_SIZE-1]}return 0}},{key:"setKerning",value:function(t,i){this.kerning||(this.kerning=[]);var n=this.kerning[t>>>e.LOG2_PAGE_SIZE];n||(this.kerning[t>>>e.LOG2_PAGE_SIZE]=n=new Uint32Array(new ArrayBuffer(e.PAGE_SIZE))),n[t&e.PAGE_SIZE-1]=i}}]),t}();e.Glyph=s},417:function(t,e,i){"use strict";var n=i(861).default,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphLayout=void 0;var a=i(1013),o=i(8637),h=function(){function t(e,i,s,h,u,l,c,g,d){var f=this;r(this,t),this.epsilon=1e-4,this.glyphRunPool=o.Pools.get("GlyphRun",(function(){return new a.GlyphRun})),this.colorStack=new Array(4),this.runs=[],this.colors=[],this.setText=function(t,e,i,n,r,s,a,o,h){f.reset();var u=t.data;if(i!==n){o&&(s=Math.max(s,3*u.spaceXadvance));var l=o||null!=h,c=r.toIntBits(),g=c;f.colors.shift();var d=u.markupEnabled;d&&f.colorStack.push(c);for(var p=!1,_=0,v=u.down,y=null,m=null,x=i;;){var M=void 0,w=!1;if(i===n){if(x===n)break;M=n,p=!0}else{if("\n"!==e.charAt(i++))continue;M=i-1,w=!0}t:{var b=f.glyphRunPool.obtain();if(b.x=0,b.y=_,u.getGlyphs(b,e,x,M,m),f.glyphCount+=b.glyphs.length,g!==c&&(f.colors[f.colors.length-2]===f.glyphCount?f.colors[f.colors.length-1]=g:(f.colors.push(f.glyphCount),f.colors.push(g)),c=g),0===b.glyphs.length){if(f.glyphRunPool.free(b),!y)break}else y?(y.appendRun(b),f.glyphRunPool.free(b)):(y=b,f.runs.push(y));if(w||p?(f.setLastGlyphXAdvance(u,y),m=null):m=y.glyphs[y.glyphs.length-1],l&&0!==y.glyphs.length&&(w||p))for(var E=y.xAdvances[0]+y.xAdvances[1],S=2;S<y.xAdvances.length;S++){var C=y.glyphs[S-1];if(E+f.getGlyphWidth(C,u)-f.epsilon<=s)E+=y.xAdvances[S];else{if(null!=h){f.truncate(u,y,s,h);break}var k=u.getWrapIndex(y.glyphs,S);if((0===k&&0===y.x||k>=y.glyphs.length)&&(k=S-1),!(y=f.wrap(u,y,k)))break t;f.runs.push(y),_+=v,y.x=0,y.y=_,E=y.xAdvances[0]+y.xAdvances[1],S=1}}}w&&(y=null,m=null,_+=M===x?v*u.blankLineScale:v),x=i}f.height=u.capHeight+Math.abs(_),f.calculateWidths(u),f.alignRuns(s,a),d&&(f.colorStack.length=0)}else f.height=u.capHeight},this.calculateWidths=function(t){for(var e,i=0,r=n(f.runs),s=0,a=f.runs.length;s<a;s++){for(var o=r[s],h=o.xAdvances,u=o.x+h[0],l=0,c=o.glyphs,g=0;g<o.glyphs.length;){var d=c[g],p=f.getGlyphWidth(d,t);l=Math.max(l,u+p),u+=null!==(e=h[++g])&&void 0!==e?e:0}o.width=Math.max(u,l)-o.x,i=Math.max(i,o.x+(isNaN(o.width)?u:o.width))}f.width=i},this.alignRuns=function(t,e){if(0===(e&o.Align.left))for(var i=0!==(e&o.Align.center),r=n(f.runs),s=0,a=f.runs.length;s<a;s++){var h=r[s];h.x+=i?.5*(t-h.width):t-h.width}},this.truncate=function(t,e,i,n){var r=e.glyphs.length,s=f.glyphRunPool.obtain();t.getGlyphs(s,n,0,n.length,null);var a=0;if(s.xAdvances.length>0){f.setLastGlyphXAdvance(t,s);for(var h=s.xAdvances,u=1;u<s.xAdvances.length;u++)a+=h[u]}i-=a;for(var l=0,c=e.x,g=e.xAdvances;l<e.xAdvances.length;){if((c+=g[l])>i)break;l++}if(l>1){if(l-1>=0&&e.glyphs.length>l-1)for(var d=l-1;d<e.glyphs.length;d++)e.glyphs.splice(d,1);if(l>=0&&e.xAdvances.length>l)for(var p=l;p<e.xAdvances.length;p++)e.xAdvances.splice(p,1);f.setLastGlyphXAdvance(t,e),s.xAdvances.length>0&&o.Utils.arrayCopy(s.xAdvances,1,e.xAdvances,e.xAdvances.length,s.xAdvances.length-1)}else e.glyphs.length=0,e.xAdvances.length=0,o.Utils.arrayCopy(s.xAdvances,0,e.xAdvances,e.xAdvances.length,s.xAdvances.length);var _=r-e.glyphs.length;if(_>0&&(f.glyphCount-=_,t.markupEnabled))for(;f.colors.length>2&&f.colors[f.colors.length-2]>=f.glyphCount;)f.colors.length-=2;o.Utils.arrayCopy(s.glyphs,0,e.glyphs,e.glyphs.length,s.glyphs.length),f.glyphCount+=n.length,f.glyphRunPool.free(s)},this.setLastGlyphXAdvance=function(t,e){var i=e.glyphs[e.glyphs.length-1];i.fixedWidth||(e.xAdvances[e.xAdvances.length-1]=f.getGlyphWidth(i,t))},this.getGlyphWidth=function(t,e){return(t.width+t.xoffset)*e.scaleX-e.padRight},this.getLineOffset=function(t,e){return-t[0].xoffset*e.scaleX-e.padLeft},this.reset=function(){f.glyphRunPool.freeAll(f.runs),f.runs.length=0,f.colors.length=0,f.glyphCount=0,f.width=0,f.height=0},this.setText(e,i,s,h,u,l,c,g,d)}return s(t,[{key:"wrap",value:function(t,e,i){for(var n=e.glyphs.length,r=e.glyphs,s=e.xAdvances,a=i;a>0&&t.isWhitespace(r[a-1].id);a--);for(var h,u=i;u<n&&t.isWhitespace(r[u].id);u++);if(u<n){var l=(h=this.glyphRunPool.obtain()).glyphs;o.Utils.arrayCopy(r,0,l,l.length,a),r.splice(0,u-1+1),e.glyphs=l,h.glyphs=r;var c=h.xAdvances;o.Utils.arrayCopy(s,0,c,c.length,a+1),s.splice(1,u),s[0]=this.getLineOffset(r,t),e.xAdvances=c,h.xAdvances=s;var g=e.glyphs.length,d=h.glyphs.length,f=n-g-d;if(this.glyphCount-=f,t.markupEnabled&&f>0)for(var p=this.glyphCount-d,_=this.colors.length-2;_>=2;_-=2){var v=this.colors[_];if(v<=p)break;this.colors[_]=v-f}}else{r=r.slice(0,a),s=s.slice(0,a+1);var y=u-a;if(y>0&&(this.glyphCount-=y,t.markupEnabled&&this.colors[this.colors.length-2]>this.glyphCount)){for(var m=this.colors[this.colors.length-1];this.colors[this.colors.length-2]>this.glyphCount;)this.colors.length-=2;this.colors[this.colors.length-2]=this.glyphCount,this.colors[this.colors.length-1]=m}}return 0===a?(this.glyphRunPool.free(e),this.runs.pop()):this.setLastGlyphXAdvance(t,e),h}}]),t}();e.GlyphLayout=h},1013:function(t,e,i){"use strict";var n=i(9728).default,r=i(6690).default;Object.defineProperty(e,"__esModule",{value:!0}),e.GlyphRun=void 0;var s=n((function t(){var e=this;r(this,t),this.glyphs=[],this.xAdvances=[],this.appendRun=function(t){e.glyphs.concat(t.glyphs),e.xAdvances.length||e.xAdvances.length--,e.xAdvances.concat(t.xAdvances)},this.reset=function(){e.glyphs.length=0,e.xAdvances.length=0}}));e.GlyphRun=s},3233:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.InputHandler=e.InputEvent=void 0;var s=i(7465),a=i(3192);!function(t){t.TouchStart="touchStart",t.TouchEnd="touchEnd",t.TouchMove="touchMove"}(e.InputEvent||(e.InputEvent={}));var o=function(){function t(e){var i=this;n(this,t),this.screenCoord=new a.Vector2,this.worldCoord=new a.Vector2,this.canvas=e,this.lastX=0,this.lastY=0,this.touched=!1;var r=this.emitter=new s.EventEmitter;this.mouseDownHandler=function(t){i.touched=!0,i.handleMove(t),r.emit("touchStart",i.getX(),i.getY())},this.mouseUpHandler=function(t){i.touched=!1,r.emit("touchEnd",i.getX(),i.getY())},this.mouseMoveHandler=function(t){i.handleMove(t),r.emit("touchMove",i.getX(),i.getY())},this.touchStartHandler=function(t){t.preventDefault();var e=t.touches[0];i.canvas.dispatchEvent(new MouseEvent("mousedown",{clientX:e.clientX,clientY:e.clientY}))},this.touchEndHandler=function(t){t.preventDefault(),i.canvas.dispatchEvent(new MouseEvent("mouseup"))},this.touchMoveHandler=function(t){t.preventDefault();var e=t.touches[0];i.canvas.dispatchEvent(new MouseEvent("mousemove",{clientX:e.clientX,clientY:e.clientY}))},this.canvas.addEventListener("mousedown",this.mouseDownHandler,!1),this.canvas.addEventListener("mouseup",this.mouseUpHandler,!1),this.canvas.addEventListener("mousemove",this.mouseMoveHandler,!1),this.canvas.addEventListener("touchstart",this.touchStartHandler,!1),this.canvas.addEventListener("touchend",this.touchEndHandler,!1),this.canvas.addEventListener("touchmove",this.touchMoveHandler,!1)}return r(t,[{key:"cleanup",value:function(){this.canvas.removeEventListener("mousedown",this.mouseDownHandler),this.canvas.removeEventListener("mouseup",this.mouseUpHandler),this.canvas.removeEventListener("mousemove",this.mouseMoveHandler),this.canvas.removeEventListener("touchstart",this.touchStartHandler),this.canvas.removeEventListener("touchend",this.touchEndHandler),this.canvas.removeEventListener("touchmove",this.touchMoveHandler)}},{key:"addEventListener",value:function(t,e){this.emitter.addListener(t,e)}},{key:"handleMove",value:function(t){var e=this.canvas.getBoundingClientRect(),i=t.clientX-e.left,n=t.clientY-e.top;this.lastX=i,this.lastY=n}},{key:"getX",value:function(){return this.lastX}},{key:"getY",value:function(){return this.lastY}},{key:"isTouched",value:function(){return this.touched}},{key:"getTouchedWorldCoord",value:function(t){return this.screenCoord.set(this.getX(),this.getY()),t.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}}]),t}();e.InputHandler=o},5474:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix4=e.M33=e.M32=e.M31=e.M30=e.M23=e.M22=e.M21=e.M20=e.M13=e.M12=e.M11=e.M10=e.M03=e.M02=e.M01=e.M00=void 0;var s=i(2668);e.M00=0,e.M01=4,e.M02=8,e.M03=12,e.M10=1,e.M11=5,e.M12=9,e.M13=13,e.M20=2,e.M21=6,e.M22=10,e.M23=14,e.M30=3,e.M31=7,e.M32=11,e.M33=15;var a=function(){function t(){n(this,t),this.temp=new Float32Array(16),this.values=new Float32Array(16);var i=this.values;i[e.M00]=1,i[e.M11]=1,i[e.M22]=1,i[e.M33]=1}return r(t,[{key:"set",value:function(t){return this.values.set(t),this}},{key:"transpose",value:function(){var t=this.temp,i=this.values;return t[e.M00]=i[e.M00],t[e.M01]=i[e.M10],t[e.M02]=i[e.M20],t[e.M03]=i[e.M30],t[e.M10]=i[e.M01],t[e.M11]=i[e.M11],t[e.M12]=i[e.M21],t[e.M13]=i[e.M31],t[e.M20]=i[e.M02],t[e.M21]=i[e.M12],t[e.M22]=i[e.M22],t[e.M23]=i[e.M32],t[e.M30]=i[e.M03],t[e.M31]=i[e.M13],t[e.M32]=i[e.M23],t[e.M33]=i[e.M33],this.set(t)}},{key:"identity",value:function(){var t=this.values;return t[e.M00]=1,t[e.M01]=0,t[e.M02]=0,t[e.M03]=0,t[e.M10]=0,t[e.M11]=1,t[e.M12]=0,t[e.M13]=0,t[e.M20]=0,t[e.M21]=0,t[e.M22]=1,t[e.M23]=0,t[e.M30]=0,t[e.M31]=0,t[e.M32]=0,t[e.M33]=1,this}},{key:"invert",value:function(){var t=this.values,i=this.temp,n=t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33];if(0===n)throw new Error("non-invertible matrix");var r=1/n;return i[e.M00]=t[e.M12]*t[e.M23]*t[e.M31]-t[e.M13]*t[e.M22]*t[e.M31]+t[e.M13]*t[e.M21]*t[e.M32]-t[e.M11]*t[e.M23]*t[e.M32]-t[e.M12]*t[e.M21]*t[e.M33]+t[e.M11]*t[e.M22]*t[e.M33],i[e.M01]=t[e.M03]*t[e.M22]*t[e.M31]-t[e.M02]*t[e.M23]*t[e.M31]-t[e.M03]*t[e.M21]*t[e.M32]+t[e.M01]*t[e.M23]*t[e.M32]+t[e.M02]*t[e.M21]*t[e.M33]-t[e.M01]*t[e.M22]*t[e.M33],i[e.M02]=t[e.M02]*t[e.M13]*t[e.M31]-t[e.M03]*t[e.M12]*t[e.M31]+t[e.M03]*t[e.M11]*t[e.M32]-t[e.M01]*t[e.M13]*t[e.M32]-t[e.M02]*t[e.M11]*t[e.M33]+t[e.M01]*t[e.M12]*t[e.M33],i[e.M03]=t[e.M03]*t[e.M12]*t[e.M21]-t[e.M02]*t[e.M13]*t[e.M21]-t[e.M03]*t[e.M11]*t[e.M22]+t[e.M01]*t[e.M13]*t[e.M22]+t[e.M02]*t[e.M11]*t[e.M23]-t[e.M01]*t[e.M12]*t[e.M23],i[e.M10]=t[e.M13]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M20]*t[e.M32]+t[e.M10]*t[e.M23]*t[e.M32]+t[e.M12]*t[e.M20]*t[e.M33]-t[e.M10]*t[e.M22]*t[e.M33],i[e.M11]=t[e.M02]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M22]*t[e.M30]+t[e.M03]*t[e.M20]*t[e.M32]-t[e.M00]*t[e.M23]*t[e.M32]-t[e.M02]*t[e.M20]*t[e.M33]+t[e.M00]*t[e.M22]*t[e.M33],i[e.M12]=t[e.M03]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M10]*t[e.M32]+t[e.M00]*t[e.M13]*t[e.M32]+t[e.M02]*t[e.M10]*t[e.M33]-t[e.M00]*t[e.M12]*t[e.M33],i[e.M13]=t[e.M02]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M12]*t[e.M20]+t[e.M03]*t[e.M10]*t[e.M22]-t[e.M00]*t[e.M13]*t[e.M22]-t[e.M02]*t[e.M10]*t[e.M23]+t[e.M00]*t[e.M12]*t[e.M23],i[e.M20]=t[e.M11]*t[e.M23]*t[e.M30]-t[e.M13]*t[e.M21]*t[e.M30]+t[e.M13]*t[e.M20]*t[e.M31]-t[e.M10]*t[e.M23]*t[e.M31]-t[e.M11]*t[e.M20]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M33],i[e.M21]=t[e.M03]*t[e.M21]*t[e.M30]-t[e.M01]*t[e.M23]*t[e.M30]-t[e.M03]*t[e.M20]*t[e.M31]+t[e.M00]*t[e.M23]*t[e.M31]+t[e.M01]*t[e.M20]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M33],i[e.M22]=t[e.M01]*t[e.M13]*t[e.M30]-t[e.M03]*t[e.M11]*t[e.M30]+t[e.M03]*t[e.M10]*t[e.M31]-t[e.M00]*t[e.M13]*t[e.M31]-t[e.M01]*t[e.M10]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M33],i[e.M23]=t[e.M03]*t[e.M11]*t[e.M20]-t[e.M01]*t[e.M13]*t[e.M20]-t[e.M03]*t[e.M10]*t[e.M21]+t[e.M00]*t[e.M13]*t[e.M21]+t[e.M01]*t[e.M10]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M23],i[e.M30]=t[e.M12]*t[e.M21]*t[e.M30]-t[e.M11]*t[e.M22]*t[e.M30]-t[e.M12]*t[e.M20]*t[e.M31]+t[e.M10]*t[e.M22]*t[e.M31]+t[e.M11]*t[e.M20]*t[e.M32]-t[e.M10]*t[e.M21]*t[e.M32],i[e.M31]=t[e.M01]*t[e.M22]*t[e.M30]-t[e.M02]*t[e.M21]*t[e.M30]+t[e.M02]*t[e.M20]*t[e.M31]-t[e.M00]*t[e.M22]*t[e.M31]-t[e.M01]*t[e.M20]*t[e.M32]+t[e.M00]*t[e.M21]*t[e.M32],i[e.M32]=t[e.M02]*t[e.M11]*t[e.M30]-t[e.M01]*t[e.M12]*t[e.M30]-t[e.M02]*t[e.M10]*t[e.M31]+t[e.M00]*t[e.M12]*t[e.M31]+t[e.M01]*t[e.M10]*t[e.M32]-t[e.M00]*t[e.M11]*t[e.M32],i[e.M33]=t[e.M01]*t[e.M12]*t[e.M20]-t[e.M02]*t[e.M11]*t[e.M20]+t[e.M02]*t[e.M10]*t[e.M21]-t[e.M00]*t[e.M12]*t[e.M21]-t[e.M01]*t[e.M10]*t[e.M22]+t[e.M00]*t[e.M11]*t[e.M22],t[e.M00]=i[e.M00]*r,t[e.M01]=i[e.M01]*r,t[e.M02]=i[e.M02]*r,t[e.M03]=i[e.M03]*r,t[e.M10]=i[e.M10]*r,t[e.M11]=i[e.M11]*r,t[e.M12]=i[e.M12]*r,t[e.M13]=i[e.M13]*r,t[e.M20]=i[e.M20]*r,t[e.M21]=i[e.M21]*r,t[e.M22]=i[e.M22]*r,t[e.M23]=i[e.M23]*r,t[e.M30]=i[e.M30]*r,t[e.M31]=i[e.M31]*r,t[e.M32]=i[e.M32]*r,t[e.M33]=i[e.M33]*r,this}},{key:"determinant",value:function(){var t=this.values;return t[e.M30]*t[e.M21]*t[e.M12]*t[e.M03]-t[e.M20]*t[e.M31]*t[e.M12]*t[e.M03]-t[e.M30]*t[e.M11]*t[e.M22]*t[e.M03]+t[e.M10]*t[e.M31]*t[e.M22]*t[e.M03]+t[e.M20]*t[e.M11]*t[e.M32]*t[e.M03]-t[e.M10]*t[e.M21]*t[e.M32]*t[e.M03]-t[e.M30]*t[e.M21]*t[e.M02]*t[e.M13]+t[e.M20]*t[e.M31]*t[e.M02]*t[e.M13]+t[e.M30]*t[e.M01]*t[e.M22]*t[e.M13]-t[e.M00]*t[e.M31]*t[e.M22]*t[e.M13]-t[e.M20]*t[e.M01]*t[e.M32]*t[e.M13]+t[e.M00]*t[e.M21]*t[e.M32]*t[e.M13]+t[e.M30]*t[e.M11]*t[e.M02]*t[e.M23]-t[e.M10]*t[e.M31]*t[e.M02]*t[e.M23]-t[e.M30]*t[e.M01]*t[e.M12]*t[e.M23]+t[e.M00]*t[e.M31]*t[e.M12]*t[e.M23]+t[e.M10]*t[e.M01]*t[e.M32]*t[e.M23]-t[e.M00]*t[e.M11]*t[e.M32]*t[e.M23]-t[e.M20]*t[e.M11]*t[e.M02]*t[e.M33]+t[e.M10]*t[e.M21]*t[e.M02]*t[e.M33]+t[e.M20]*t[e.M01]*t[e.M12]*t[e.M33]-t[e.M00]*t[e.M21]*t[e.M12]*t[e.M33]-t[e.M10]*t[e.M01]*t[e.M22]*t[e.M33]+t[e.M00]*t[e.M11]*t[e.M22]*t[e.M33]}},{key:"translate",value:function(t,i,n){var r=this.values;return r[e.M03]+=t,r[e.M13]+=i,r[e.M23]+=n,this}},{key:"copy",value:function(){return(new t).set(this.values)}},{key:"projection",value:function(t,i,n,r){this.identity();var s=1/Math.tan(n*(Math.PI/180)/2),a=(i+t)/(t-i),o=2*i*t/(t-i),h=this.values;return h[e.M00]=s/r,h[e.M10]=0,h[e.M20]=0,h[e.M30]=0,h[e.M01]=0,h[e.M11]=s,h[e.M21]=0,h[e.M31]=0,h[e.M02]=0,h[e.M12]=0,h[e.M22]=a,h[e.M32]=-1,h[e.M03]=0,h[e.M13]=0,h[e.M23]=o,h[e.M33]=0,this}},{key:"ortho2d",value:function(t,e,i,n){return this.ortho(t,t+i,e,e+n,0,1)}},{key:"ortho",value:function(t,i,n,r,s,a){this.identity();var o=2/(i-t),h=2/(r-n),u=-2/(a-s),l=-(i+t)/(i-t),c=-(r+n)/(r-n),g=-(a+s)/(a-s),d=this.values;return d[e.M00]=o,d[e.M10]=0,d[e.M20]=0,d[e.M30]=0,d[e.M01]=0,d[e.M11]=h,d[e.M21]=0,d[e.M31]=0,d[e.M02]=0,d[e.M12]=0,d[e.M22]=u,d[e.M32]=0,d[e.M03]=l,d[e.M13]=c,d[e.M23]=g,d[e.M33]=1,this}},{key:"multiply",value:function(t){var i=this.temp,n=this.values,r=t.values;return i[e.M00]=n[e.M00]*r[e.M00]+n[e.M01]*r[e.M10]+n[e.M02]*r[e.M20]+n[e.M03]*r[e.M30],i[e.M01]=n[e.M00]*r[e.M01]+n[e.M01]*r[e.M11]+n[e.M02]*r[e.M21]+n[e.M03]*r[e.M31],i[e.M02]=n[e.M00]*r[e.M02]+n[e.M01]*r[e.M12]+n[e.M02]*r[e.M22]+n[e.M03]*r[e.M32],i[e.M03]=n[e.M00]*r[e.M03]+n[e.M01]*r[e.M13]+n[e.M02]*r[e.M23]+n[e.M03]*r[e.M33],i[e.M10]=n[e.M10]*r[e.M00]+n[e.M11]*r[e.M10]+n[e.M12]*r[e.M20]+n[e.M13]*r[e.M30],i[e.M11]=n[e.M10]*r[e.M01]+n[e.M11]*r[e.M11]+n[e.M12]*r[e.M21]+n[e.M13]*r[e.M31],i[e.M12]=n[e.M10]*r[e.M02]+n[e.M11]*r[e.M12]+n[e.M12]*r[e.M22]+n[e.M13]*r[e.M32],i[e.M13]=n[e.M10]*r[e.M03]+n[e.M11]*r[e.M13]+n[e.M12]*r[e.M23]+n[e.M13]*r[e.M33],i[e.M20]=n[e.M20]*r[e.M00]+n[e.M21]*r[e.M10]+n[e.M22]*r[e.M20]+n[e.M23]*r[e.M30],i[e.M21]=n[e.M20]*r[e.M01]+n[e.M21]*r[e.M11]+n[e.M22]*r[e.M21]+n[e.M23]*r[e.M31],i[e.M22]=n[e.M20]*r[e.M02]+n[e.M21]*r[e.M12]+n[e.M22]*r[e.M22]+n[e.M23]*r[e.M32],i[e.M23]=n[e.M20]*r[e.M03]+n[e.M21]*r[e.M13]+n[e.M22]*r[e.M23]+n[e.M23]*r[e.M33],i[e.M30]=n[e.M30]*r[e.M00]+n[e.M31]*r[e.M10]+n[e.M32]*r[e.M20]+n[e.M33]*r[e.M30],i[e.M31]=n[e.M30]*r[e.M01]+n[e.M31]*r[e.M11]+n[e.M32]*r[e.M21]+n[e.M33]*r[e.M31],i[e.M32]=n[e.M30]*r[e.M02]+n[e.M31]*r[e.M12]+n[e.M32]*r[e.M22]+n[e.M33]*r[e.M32],i[e.M33]=n[e.M30]*r[e.M03]+n[e.M31]*r[e.M13]+n[e.M32]*r[e.M23]+n[e.M33]*r[e.M33],this.set(this.temp)}},{key:"multiplyLeft",value:function(t){var i=this.temp,n=this.values,r=t.values;return i[e.M00]=r[e.M00]*n[e.M00]+r[e.M01]*n[e.M10]+r[e.M02]*n[e.M20]+r[e.M03]*n[e.M30],i[e.M01]=r[e.M00]*n[e.M01]+r[e.M01]*n[e.M11]+r[e.M02]*n[e.M21]+r[e.M03]*n[e.M31],i[e.M02]=r[e.M00]*n[e.M02]+r[e.M01]*n[e.M12]+r[e.M02]*n[e.M22]+r[e.M03]*n[e.M32],i[e.M03]=r[e.M00]*n[e.M03]+r[e.M01]*n[e.M13]+r[e.M02]*n[e.M23]+r[e.M03]*n[e.M33],i[e.M10]=r[e.M10]*n[e.M00]+r[e.M11]*n[e.M10]+r[e.M12]*n[e.M20]+r[e.M13]*n[e.M30],i[e.M11]=r[e.M10]*n[e.M01]+r[e.M11]*n[e.M11]+r[e.M12]*n[e.M21]+r[e.M13]*n[e.M31],i[e.M12]=r[e.M10]*n[e.M02]+r[e.M11]*n[e.M12]+r[e.M12]*n[e.M22]+r[e.M13]*n[e.M32],i[e.M13]=r[e.M10]*n[e.M03]+r[e.M11]*n[e.M13]+r[e.M12]*n[e.M23]+r[e.M13]*n[e.M33],i[e.M20]=r[e.M20]*n[e.M00]+r[e.M21]*n[e.M10]+r[e.M22]*n[e.M20]+r[e.M23]*n[e.M30],i[e.M21]=r[e.M20]*n[e.M01]+r[e.M21]*n[e.M11]+r[e.M22]*n[e.M21]+r[e.M23]*n[e.M31],i[e.M22]=r[e.M20]*n[e.M02]+r[e.M21]*n[e.M12]+r[e.M22]*n[e.M22]+r[e.M23]*n[e.M32],i[e.M23]=r[e.M20]*n[e.M03]+r[e.M21]*n[e.M13]+r[e.M22]*n[e.M23]+r[e.M23]*n[e.M33],i[e.M30]=r[e.M30]*n[e.M00]+r[e.M31]*n[e.M10]+r[e.M32]*n[e.M20]+r[e.M33]*n[e.M30],i[e.M31]=r[e.M30]*n[e.M01]+r[e.M31]*n[e.M11]+r[e.M32]*n[e.M21]+r[e.M33]*n[e.M31],i[e.M32]=r[e.M30]*n[e.M02]+r[e.M31]*n[e.M12]+r[e.M32]*n[e.M22]+r[e.M33]*n[e.M32],i[e.M33]=r[e.M30]*n[e.M03]+r[e.M31]*n[e.M13]+r[e.M32]*n[e.M23]+r[e.M33]*n[e.M33],this.set(this.temp)}},{key:"lookAt",value:function(i,n,r){t.initTemps();var s=t.xAxis,a=t.yAxis,o=t.zAxis;o.setFrom(n).normalize(),s.setFrom(n).normalize(),s.cross(r).normalize(),a.setFrom(s).cross(o).normalize(),this.identity();var h=this.values;return h[e.M00]=s.x,h[e.M01]=s.y,h[e.M02]=s.z,h[e.M10]=a.x,h[e.M11]=a.y,h[e.M12]=a.z,h[e.M20]=-o.x,h[e.M21]=-o.y,h[e.M22]=-o.z,t.tmpMatrix.identity(),t.tmpMatrix.values[e.M03]=-i.x,t.tmpMatrix.values[e.M13]=-i.y,t.tmpMatrix.values[e.M23]=-i.z,this.multiply(t.tmpMatrix),this}}],[{key:"initTemps",value:function(){null===t.xAxis&&(t.xAxis=new s.Vector3),null===t.yAxis&&(t.yAxis=new s.Vector3),null===t.zAxis&&(t.zAxis=new s.Vector3)}}]),t}();e.Matrix4=a,a.xAxis=null,a.yAxis=null,a.zAxis=null,a.tmpMatrix=new a},4731:function(t,e,i){"use strict";var n=i(1655).default,r=i(6389).default,s=i(6690).default,a=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Color2Attribute=e.ColorAttribute=e.TexCoordAttribute=e.Position3Attribute=e.Position2Attribute=e.VertexAttribute=e.VertexAttributeType=e.Mesh=void 0;var o,h=i(6403),u=function(){function t(e,i,n,r){s(this,t),this.attributes=i,this.verticesLength=0,this.dirtyVertices=!1,this.indicesLength=0,this.dirtyIndices=!1,this.elementsPerVertex=0,this.context=e,this.elementsPerVertex=0;for(var a=0;a<i.length;a++)this.elementsPerVertex+=i[a].numElements;this.vertices=new Float32Array(n*this.elementsPerVertex),this.indices=new Uint16Array(r)}return a(t,[{key:"getAttributes",value:function(){return this.attributes}},{key:"maxVertices",value:function(){return this.vertices.length/this.elementsPerVertex}},{key:"numVertices",value:function(){return this.verticesLength/this.elementsPerVertex}},{key:"setVerticesLength",value:function(t){this.dirtyVertices=!0,this.verticesLength=t}},{key:"getVertices",value:function(){return this.vertices}},{key:"maxIndices",value:function(){return this.indices.length}},{key:"numIndices",value:function(){return this.indicesLength}},{key:"setIndicesLength",value:function(t){this.dirtyIndices=!0,this.indicesLength=t}},{key:"getIndices",value:function(){return this.indices}},{key:"getVertexSizeInFloats",value:function(){for(var t=0,e=0;e<this.attributes.length;e++){t+=this.attributes[e].numElements}return t}},{key:"setVertices",value:function(t){if(this.dirtyVertices=!0,t.length>this.vertices.length)throw Error("Mesh can't store more than "+this.maxVertices()+" vertices");this.vertices.set(t,0),this.verticesLength=t.length}},{key:"setIndices",value:function(t){if(this.dirtyIndices=!0,t.length>this.indices.length)throw Error("Mesh can't store more than "+this.maxIndices()+" indices");this.indices.set(t,0),this.indicesLength=t.length}},{key:"draw",value:function(t,e){this.drawWithOffset(t,e,0,this.indicesLength>0?this.indicesLength:this.verticesLength/this.elementsPerVertex)}},{key:"drawWithOffset",value:function(t,e,i,n){var r=this.context;(this.dirtyVertices||this.dirtyIndices)&&this.update(),this.bind(t),this.indicesLength>0?r.drawElements(e,n,r.UNSIGNED_SHORT,2*i):r.drawArrays(e,i,n),this.unbind(t)}},{key:"bind",value:function(t){var e=this.context;e.bindBuffer(e.ARRAY_BUFFER,this.verticesBuffer);for(var i=0,n=0;n<this.attributes.length;n++){var r=this.attributes[n],s=t.getAttributeLocation(r.name);e.enableVertexAttribArray(s),e.vertexAttribPointer(s,r.numElements,e.FLOAT,!1,4*this.elementsPerVertex,4*i),i+=r.numElements}this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,this.indicesBuffer)}},{key:"unbind",value:function(t){for(var e=this.context,i=0;i<this.attributes.length;i++){var n=this.attributes[i],r=t.getAttributeLocation(n.name);e.disableVertexAttribArray(r)}e.bindBuffer(e.ARRAY_BUFFER,null),this.indicesLength>0&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)}},{key:"update",value:function(){var t=this.context;this.dirtyVertices&&(this.verticesBuffer||(this.verticesBuffer=t.createBuffer()),t.bindBuffer(t.ARRAY_BUFFER,this.verticesBuffer),t.bufferData(t.ARRAY_BUFFER,this.vertices.subarray(0,this.verticesLength),t.DYNAMIC_DRAW),this.dirtyVertices=!1),this.dirtyIndices&&(this.indicesBuffer||(this.indicesBuffer=t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indicesBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices.subarray(0,this.indicesLength),t.DYNAMIC_DRAW),this.dirtyIndices=!1)}},{key:"restore",value:function(){this.verticesBuffer=null,this.indicesBuffer=null,this.update()}},{key:"dispose",value:function(){var t=this.context;t.deleteBuffer(this.verticesBuffer),t.deleteBuffer(this.indicesBuffer)}}]),t}();e.Mesh=u,function(t){t[t.Float=0]="Float"}(o=e.VertexAttributeType||(e.VertexAttributeType={}));var l=a((function t(e,i,n){s(this,t),this.name=e,this.type=i,this.numElements=n}));e.VertexAttribute=l;var c=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,h.Shader.POSITION,o.Float,2)}return a(i)}(l);e.Position2Attribute=c;var g=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,h.Shader.POSITION,o.Float,3)}return a(i)}(l);e.Position3Attribute=g;var d=function(t){n(i,t);var e=r(i);function i(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return s(this,i),e.call(this,h.Shader.TEXCOORDS+(0===t?"":t),o.Float,2)}return a(i)}(l);e.TexCoordAttribute=d;var f=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,h.Shader.COLOR,o.Float,4)}return a(i)}(l);e.ColorAttribute=f;var p=function(t){n(i,t);var e=r(i);function i(){return s(this,i),e.call(this,h.Shader.COLOR2,o.Float,4)}return a(i)}(l);e.Color2Attribute=p},2226:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.NumberUtil=void 0;var s=new Int8Array(4),a=new Int32Array(s.buffer,0,1),o=new Float32Array(s.buffer,0,1),h=function(){function t(){n(this,t)}return r(t,null,[{key:"intBitsToFloat",value:function(t){return a[0]=t,o[0]}},{key:"floatToIntBits",value:function(t){return o[0]=t,a[0]}},{key:"intToFloatColor",value:function(e){return t.intBitsToFloat(4278190079&e)}},{key:"colorToFloat",value:function(e,i,n,r){var s=e<<24|i<<16|n<<8|r;return t.intToFloatColor(s)}},{key:"isPowerOfTwo",value:function(t){return 0===(t&t-1)}},{key:"nextPowerOfTwo",value:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1}}]),t}();e.NumberUtil=h},2991:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.PolygonBatch=void 0;var s=i(8637),a=i(4731),o=i(6403),h=[0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0],u=new s.Color(1,1,1,1),l=function(){function t(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10920;if(n(this,t),this.isDrawing=!1,this.shader=null,this.lastTexture=null,this.verticesLength=0,this.indicesLength=0,this.projectionValues=new Float32Array(16),this.color=u,this.twoColorTint=!0,this.yDown=!1,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);this.context=e;var s=i?[new a.Position2Attribute,new a.ColorAttribute,new a.TexCoordAttribute,new a.Color2Attribute]:[new a.Position2Attribute,new a.ColorAttribute,new a.TexCoordAttribute];this.mesh=new a.Mesh(e,s,r,3*r),this.shader=o.Shader.newTwoColoredTextured(e);var h=this.context;this.srcColorBlend=h.SRC_ALPHA,this.srcAlphaBlend=h.ONE,this.dstBlend=h.ONE_MINUS_SRC_ALPHA,this.twoColorTint=i}return r(t,[{key:"setColor",value:function(t){this.color=t}},{key:"setShader",value:function(t){this.shader.dispose(),this.shader=t}},{key:"setProjection",value:function(t){this.projectionValues=t}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("PolygonBatch is already drawing. Call PolygonBatch.end() before calling PolygonBatch.begin()");this.drawCalls=0;var t=this.shader;this.lastTexture=null,this.isDrawing=!0,t.bind(),t.setUniform4x4f(o.Shader.MVP_MATRIX,this.projectionValues),t.setUniformi("u_texture",0);var e=this.context;e.enable(e.BLEND),e.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(t,e,i){this.srcColorBlend===t&&this.srcAlphaBlend===e&&this.dstBlend===i||(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=i,this.isDrawing&&(this.flush(),this.context.blendFuncSeparate(t,i,e,i)))}},{key:"drawVerticesWithOffset",value:function(e,i,n,r){for(var s=[],a=0;a<r;a++)s[a]=i[a+n];this.drawVertices(e,s,t.QUAD_TRIANGLES)}},{key:"drawVertices",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.QUAD_TRIANGLES;e!==this.lastTexture?(this.flush(),this.lastTexture=e):(this.verticesLength+i.length>this.mesh.getVertices().length||this.indicesLength+n.length>this.mesh.getIndices().length)&&this.flush();var r=this.mesh.numVertices();this.mesh.getVertices().set(i,this.verticesLength),this.verticesLength+=i.length,this.mesh.setVerticesLength(this.verticesLength);for(var s=this.mesh.getIndices(),a=this.indicesLength,o=0;o<n.length;a++,o++)s[a]=n[o]+r;this.indicesLength+=n.length,this.mesh.setIndicesLength(this.indicesLength)}},{key:"flush",value:function(){0!==this.verticesLength&&(this.lastTexture.bind(),this.mesh.draw(this.shader,this.context.TRIANGLES),this.verticesLength=0,this.indicesLength=0,this.mesh.setVerticesLength(0),this.mesh.setIndicesLength(0),this.drawCalls++)}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("PolygonBatch is not drawing. Call PolygonBatch.begin() before calling PolygonBatch.end()");(this.verticesLength>0||this.indicesLength>0)&&this.flush(),this.shader.unbind(),this.lastTexture=null,this.isDrawing=!1,t.totalDrawCalls+=this.drawCalls;var e=this.context;e.disable(e.BLEND)}},{key:"getDrawCalls",value:function(){return this.drawCalls}},{key:"dispose",value:function(){this.mesh.dispose()}},{key:"setYDown",value:function(t){this.yDown=t}},{key:"draw",value:function(e,i,n,r,s){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,g=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:1,f=arguments.length>12&&void 0!==arguments[12]?arguments[12]:1,p=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,_=arguments.length>14&&void 0!==arguments[14]&&arguments[14],v=this.color;if(this.yDown){var y=d;d=p,p=y}i=i||0,n=n||0;var m=-a,x=(r=0===r?r:r||e.width)-a,M=r-a,w=-a,b=-o,E=-o,S=(s=0===s?s:s||e.height)-o,C=s-o;if(1!==l&&(m*=l,x*=l,M*=l,w*=l),1!==c&&(b*=c,E*=c,S*=c,C*=c),0!==u){var k=Math.cos(u),P=Math.sin(u),I=k*m-P*b,D=P*m+k*b,R=k*x-P*E,T=P*x+k*E,L=k*M-P*S,A=P*M+k*S,V=k*w-P*C,O=P*w+k*C;m=I,x=R,M=L,w=V,b=D,E=T,S=A,C=O}m+=i+a,x+=i+a,M+=i+a,w+=i+a,b+=n+o,E+=n+o,S+=n+o,C+=n+o;var F=g,N=d,j=f,B=p,z=j,G=N,W=F,H=B;_&&(this.yDown?(F=g,N=p,j=f,B=d,z=g,G=d,W=f,H=p):(F=f,N=d,j=g,B=p,z=f,G=p,W=g,H=d));var X=0;h[X++]=m,h[X++]=b,h[X++]=v.r,h[X++]=v.g,h[X++]=v.b,h[X++]=v.a,h[X++]=F,h[X++]=N,this.twoColorTint&&(h[X++]=0,h[X++]=0,h[X++]=0,h[X++]=0),h[X++]=x,h[X++]=E,h[X++]=v.r,h[X++]=v.g,h[X++]=v.b,h[X++]=v.a,h[X++]=z,h[X++]=G,this.twoColorTint&&(h[X++]=0,h[X++]=0,h[X++]=0,h[X++]=0),h[X++]=M,h[X++]=S,h[X++]=v.r,h[X++]=v.g,h[X++]=v.b,h[X++]=v.a,h[X++]=j,h[X++]=B,this.twoColorTint&&(h[X++]=0,h[X++]=0,h[X++]=0,h[X++]=0),h[X++]=w,h[X++]=C,h[X++]=v.r,h[X++]=v.g,h[X++]=v.b,h[X++]=v.a,h[X++]=W,h[X++]=H,this.twoColorTint&&(h[X++]=0,h[X++]=0,h[X++]=0,h[X]=0),this.drawVertices(e,h,t.QUAD_TRIANGLES)}}],[{key:"resetTotalDrawCalls",value:function(){t.totalDrawCalls=0}}]),t}();e.PolygonBatch=l,l.QUAD_TRIANGLES=[0,1,2,2,3,0],l.totalDrawCalls=0},6403:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Shader=void 0;var s=function(){function t(e,i,r){n(this,t),this.vertexShader=i,this.fragmentShader=r,this.vs=null,this.fs=null,this.program=null,this.tmp2x2=new Float32Array(4),this.tmp3x3=new Float32Array(9),this.tmp4x4=new Float32Array(16),this.vsSource=i,this.fsSource=r,this.context=e,this.compile()}return r(t,[{key:"getProgram",value:function(){return this.program}},{key:"getVertexShader",value:function(){return this.vertexShader}},{key:"getFragmentShader",value:function(){return this.fragmentShader}},{key:"getVertexShaderSource",value:function(){return this.vsSource}},{key:"getFragmentSource",value:function(){return this.fsSource}},{key:"compile",value:function(){var t=this.context;try{this.vs=this.compileShader(t.VERTEX_SHADER,this.vertexShader),this.fs=this.compileShader(t.FRAGMENT_SHADER,this.fragmentShader),this.program=this.compileProgram(this.vs,this.fs)}catch(e){throw this.dispose(),e}}},{key:"compileShader",value:function(t,e){var i=this.context,n=i.createShader(t);if(i.shaderSource(n,e),i.compileShader(n),!i.getShaderParameter(n,i.COMPILE_STATUS)){var r="Couldn't compile shader: "+i.getShaderInfoLog(n);if(i.deleteShader(n),!i.isContextLost())throw new Error(r)}return n}},{key:"compileProgram",value:function(t,e){var i=this.context,n=i.createProgram();if(i.attachShader(n,t),i.attachShader(n,e),i.linkProgram(n),!i.getProgramParameter(n,i.LINK_STATUS)){var r="Couldn't compile shader program: "+i.getProgramInfoLog(n);if(i.deleteProgram(n),!i.isContextLost())throw new Error(r)}return n}},{key:"restore",value:function(){this.compile()}},{key:"bind",value:function(){this.context.useProgram(this.program)}},{key:"unbind",value:function(){this.context.useProgram(null)}},{key:"setUniformi",value:function(t,e){this.context.uniform1i(this.getUniformLocation(t),e)}},{key:"setUniformf",value:function(t,e){this.context.uniform1f(this.getUniformLocation(t),e)}},{key:"setUniform2f",value:function(t,e,i){this.context.uniform2f(this.getUniformLocation(t),e,i)}},{key:"setUniform3f",value:function(t,e,i,n){this.context.uniform3f(this.getUniformLocation(t),e,i,n)}},{key:"setUniform4f",value:function(t,e,i,n,r){this.context.uniform4f(this.getUniformLocation(t),e,i,n,r)}},{key:"setUniform2x2f",value:function(t,e){var i=this.context;this.tmp2x2.set(e),i.uniformMatrix2fv(this.getUniformLocation(t),!1,this.tmp2x2)}},{key:"setUniform3x3f",value:function(t,e){var i=this.context;this.tmp3x3.set(e),i.uniformMatrix3fv(this.getUniformLocation(t),!1,this.tmp3x3)}},{key:"setUniform4x4f",value:function(t,e){var i=this.context;this.tmp4x4.set(e),i.uniformMatrix4fv(this.getUniformLocation(t),!1,this.tmp4x4)}},{key:"getUniformLocation",value:function(t){var e=this.context,i=e.getUniformLocation(this.program,t);if(!i&&!e.isContextLost())throw new Error("Couldn't find location for uniform ".concat(t));return i}},{key:"getAttributeLocation",value:function(t){var e=this.context,i=e.getAttribLocation(this.program,t);if(-1===i&&!e.isContextLost())throw new Error("Couldn't find location for attribute ".concat(t));return i}},{key:"dispose",value:function(){var t=this.context;this.vs&&(t.deleteShader(this.vs),this.vs=null),this.fs&&(t.deleteShader(this.fs),this.fs=null),this.program&&(t.deleteProgram(this.program),this.program=null)}}],[{key:"newColoredTextured",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         attribute vec2 ").concat(t.TEXCOORDS,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_color;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_color = ").concat(t.COLOR,";\n           v_texCoords = ").concat(t.TEXCOORDS,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           gl_FragColor = v_color * texture2D(u_texture, v_texCoords);\n         }\n       ")}},{key:"newTwoColoredTextured",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         attribute vec4 ").concat(t.COLOR2,";\n         attribute vec2 ").concat(t.TEXCOORDS,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_light;\n         varying vec4 v_dark;\n         varying vec2 v_texCoords;\n \n         void main () {\n           v_light = ").concat(t.COLOR,";\n           v_dark = ").concat(t.COLOR2,";\n           v_texCoords = ").concat(t.TEXCOORDS,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_light;\n         varying LOWP vec4 v_dark;\n         varying vec2 v_texCoords;\n         uniform sampler2D u_texture;\n \n         void main () {\n           vec4 texColor = texture2D(u_texture, v_texCoords);\n           gl_FragColor.a = texColor.a * v_light.a;\n           gl_FragColor.rgb = ((texColor.a - 1.0) * v_dark.a + 1.0 - texColor.rgb) * v_dark.rgb + texColor.rgb * v_light.rgb;\n         }\n       ")}},{key:"newColored",value:function(e){return new t(e,"\n         attribute vec4 ".concat(t.POSITION,";\n         attribute vec4 ").concat(t.COLOR,";\n         uniform mat4 ").concat(t.MVP_MATRIX,";\n         varying vec4 v_color;\n \n         void main () {\n           v_color = ").concat(t.COLOR,";\n           gl_Position = ").concat(t.MVP_MATRIX," * ").concat(t.POSITION,";\n         }\n       "),"\n         #ifdef GL_ES\n           #define LOWP lowp\n           precision mediump float;\n         #else\n           #define LOWP\n         #endif\n         varying LOWP vec4 v_color;\n \n         void main () {\n           gl_FragColor = v_color;\n         }\n       ")}}]),t}();e.Shader=s,s.MVP_MATRIX="u_projTrans",s.POSITION="a_position",s.COLOR="a_color",s.COLOR2="a_color2",s.TEXCOORDS="a_texCoords",s.SAMPLER="u_texture"},2438:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeRenderer=e.ShapeType=void 0;var s,a=i(4731),o=i(6403),h=i(8637),u=i(3192);!function(t){t[t.Point=0]="Point",t[t.Line=1]="Line",t[t.Filled=4]="Filled"}(s=e.ShapeType||(e.ShapeType={}));var l=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10920;if(n(this,t),this.isDrawing=!1,this.shapeType=s.Filled,this.color=new h.Color(1,1,1,1),this.vertexIndex=0,this.tmp=new u.Vector2,this.projectionValues=new Float32Array(16),i>10920)throw new Error("Can't have more than 10920 triangles per batch: "+i);this.context=e,this.mesh=new a.Mesh(e,[new a.Position2Attribute,new a.ColorAttribute],i,0);var r=this.context;this.srcColorBlend=r.SRC_ALPHA,this.srcAlphaBlend=r.ONE,this.dstBlend=r.ONE_MINUS_SRC_ALPHA,this.shader=o.Shader.newColored(r)}return r(t,[{key:"setProjection",value:function(t){this.projectionValues=t}},{key:"begin",value:function(){if(this.isDrawing)throw new Error("ShapeRenderer.begin() has already been called");this.vertexIndex=0,this.isDrawing=!0,this.shader.bind(),this.shader.setUniform4x4f(o.Shader.MVP_MATRIX,this.projectionValues);var t=this.context;t.enable(t.BLEND),t.blendFuncSeparate(this.srcColorBlend,this.dstBlend,this.srcAlphaBlend,this.dstBlend)}},{key:"setBlendMode",value:function(t,e,i){(this.srcColorBlend=t,this.srcAlphaBlend=e,this.dstBlend=i,this.isDrawing)&&(this.flush(),this.context.blendFuncSeparate(t,i,e,i))}},{key:"setColor",value:function(t){this.color.setFromColor(t)}},{key:"setColorWith",value:function(t,e,i,n){this.color.set(t,e,i,n)}},{key:"point",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;this.check(s.Point,1),null===i&&(i=this.color),this.vertex(t,e,i)}},{key:"line",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;this.check(s.Line,2),null===r&&(r=this.color),this.vertex(t,e,r),this.vertex(i,n,r)}},{key:"triangle",value:function(t,e,i,n,r,a,o){var h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(t?s.Filled:s.Line,3),null===h&&(h=this.color),null===u&&(u=this.color),null===l&&(l=this.color),t?(this.vertex(e,i,h),this.vertex(n,r,u),this.vertex(a,o,l)):(this.vertex(e,i,h),this.vertex(n,r,u),this.vertex(n,r,h),this.vertex(a,o,u),this.vertex(a,o,h),this.vertex(e,i,u))}},{key:"quad",value:function(t,e,i,n,r,a,o,h,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:null,g=arguments.length>11&&void 0!==arguments[11]?arguments[11]:null,d=arguments.length>12&&void 0!==arguments[12]?arguments[12]:null;this.check(t?s.Filled:s.Line,3),null===l&&(l=this.color),null===c&&(c=this.color),null===g&&(g=this.color),null===d&&(d=this.color),t?(this.vertex(e,i,l),this.vertex(n,r,c),this.vertex(a,o,g),this.vertex(a,o,g),this.vertex(h,u,d),this.vertex(e,i,l)):(this.vertex(e,i,l),this.vertex(n,r,c),this.vertex(n,r,c),this.vertex(a,o,g),this.vertex(a,o,g),this.vertex(h,u,d),this.vertex(h,u,d),this.vertex(e,i,l))}},{key:"rect",value:function(t,e,i,n,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.quad(t,e,i,e+n,i,e+n,i+r,e,i+r,s,s,s,s)}},{key:"rectLine",value:function(t,e,i,n,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.check(t?s.Filled:s.Line,8),null===o&&(o=this.color);var h=this.tmp.set(r-i,e-n);h.nor(),a*=.5;var u=h.x*a,l=h.y*a;t?(this.vertex(e+u,i+l,o),this.vertex(e-u,i-l,o),this.vertex(n+u,r+l,o),this.vertex(n-u,r-l,o),this.vertex(n+u,r+l,o),this.vertex(e-u,i-l,o)):(this.vertex(e+u,i+l,o),this.vertex(e-u,i-l,o),this.vertex(n+u,r+l,o),this.vertex(n-u,r-l,o),this.vertex(n+u,r+l,o),this.vertex(e+u,i+l,o),this.vertex(n-u,r-l,o),this.vertex(e-u,i-l,o))}},{key:"x",value:function(t,e,i){this.line(t-i,e-i,t+i,e+i),this.line(t-i,e+i,t+i,e-i)}},{key:"polygon",value:function(t,e,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(i<3)throw new Error("Polygon must contain at least 3 vertices");this.check(s.Line,2*i),null===n&&(n=this.color),i<<=1;for(var r=t[e<<=1],a=t[e+1],o=e+i,h=e,u=e+i-2;h<u;h+=2){var l=t[h],c=t[h+1],g=0,d=0;h+2>=o?(g=r,d=a):(g=t[h+2],d=t[h+3]),this.vertex(l,c,n),this.vertex(g,d,n)}}},{key:"circle",value:function(t,e,i,n){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(0===a&&(a=Math.max(1,6*h.MathUtils.cbrt(n)|0)),a<=0)throw new Error("segments must be > 0.");null===r&&(r=this.color);var o=2*h.MathUtils.PI/a,u=Math.cos(o),l=Math.sin(o),c=n,g=0;if(t){this.check(s.Filled,3*a+3),a--;for(var d=0;d<a;d++){this.vertex(e,i,r),this.vertex(e+c,i+g,r);var f=c;c=u*c-l*g,g=l*f+u*g,this.vertex(e+c,i+g,r)}this.vertex(e,i,r),this.vertex(e+c,i+g,r)}else{this.check(s.Line,2*a+2);for(var p=0;p<a;p++){this.vertex(e+c,i+g,r);var _=c;c=u*c-l*g,g=l*_+u*g,this.vertex(e+c,i+g,r)}this.vertex(e+c,i+g,r)}c=n,g=0,this.vertex(e+c,i+g,r)}},{key:"curve",value:function(t,e,i,n,r,a,o,h,u){var l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null;this.check(s.Line,2*u+2),null===l&&(l=this.color);for(var c=1/u,g=c*c,d=c*c*c,f=3*c,p=3*g,_=6*g,v=6*d,y=t-2*i+r,m=e-2*n+a,x=3*(i-r)-t+o,M=3*(n-a)-e+h,w=t,b=e,E=(i-t)*f+y*p+x*d,S=(n-e)*f+m*p+M*d,C=y*_+x*v,k=m*_+M*v,P=x*v,I=M*v;u-- >0;)this.vertex(w,b,l),w+=E,b+=S,E+=C,S+=k,C+=P,k+=I,this.vertex(w,b,l);this.vertex(w,b,l),this.vertex(o,h,l)}},{key:"vertex",value:function(t,e,i){var n=this.vertexIndex,r=this.mesh.getVertices();r[n++]=t,r[n++]=e,r[n++]=i.r,r[n++]=i.g,r[n++]=i.b,r[n++]=i.a,this.vertexIndex=n}},{key:"end",value:function(){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");this.flush();var t=this.context;t.disable(t.BLEND),this.isDrawing=!1}},{key:"flush",value:function(){0!==this.vertexIndex&&(this.mesh.setVerticesLength(this.vertexIndex),this.mesh.draw(this.shader,this.shapeType),this.vertexIndex=0)}},{key:"check",value:function(t,e){if(!this.isDrawing)throw new Error("ShapeRenderer.begin() has not been called");if(this.shapeType===t){if(!(this.mesh.maxVertices()-this.mesh.numVertices()<e))return;this.flush()}else this.flush(),this.shapeType=t}},{key:"dispose",value:function(){this.mesh.dispose()}}]),t}();e.ShapeRenderer=l},9805:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0;var s=i(8637),a=i(3192),o=function(){function t(e){n(this,t),this.region=e,this.dirty=!1,this.position=new a.Vector2(0,0),this.size=new a.Vector2(0,0),this.origin=new a.Vector2(0,0),this.scale=new a.Vector2(1,1),this.color=new s.Color(1,1,1,1),this.rotation=0,this.vertices=new Float32Array(48),this.bounds={x:0,y:0,width:0,height:0},this.setSize(e.width,e.height),this.setOrigin(e.width/2,e.height/2)}return r(t,[{key:"set",value:function(t){this.region=t.region,this.position.setVector(t.position),this.size.setVector(t.size),this.origin.setVector(t.origin),this.rotation=t.rotation,this.scale.setVector(t.scale),this.color.setFromColor(t.color),this.dirty=!0}},{key:"setBounds",value:function(t,e,i,n){this.setPosition(t,e),this.setSize(t,e),this.dirty=!0}},{key:"setSize",value:function(t,e){this.size.set(t,e),this.dirty=!0}},{key:"setPosition",value:function(t,e){this.position.set(t,e),this.dirty=!0}},{key:"setOriginBasedPosition",value:function(t,e){this.setPosition(t-this.origin.x,e-this.origin.y)}},{key:"setX",value:function(t){this.position.x=t,this.dirty=!0}},{key:"setY",value:function(t){this.position.y=t,this.dirty=!0}},{key:"setCenterX",value:function(t){this.setX(t-this.size.x/2)}},{key:"setCenterY",value:function(t){this.setY(t-this.size.y/2)}},{key:"setCenter",value:function(t,e){this.setPosition(t-this.size.x/2,e-this.size.y/2)}},{key:"translateX",value:function(t){this.translate(t,0)}},{key:"translateY",value:function(t){this.translate(0,t)}},{key:"translate",value:function(t,e){this.position.add(t,e),this.dirty=!0}},{key:"setColor",value:function(t){this.color.setFromColor(t),this.dirty=!0}},{key:"setAlpha",value:function(t){this.color.a=t,this.dirty=!0}},{key:"setOrigin",value:function(t,e){this.origin.set(t,e),this.dirty=!0}},{key:"setOriginCenter",value:function(){this.origin.set(this.size.x/2,this.size.y/2),this.dirty=!0}},{key:"setRotation",value:function(t){this.rotation=t,this.dirty=!0}},{key:"getRotation",value:function(){return this.rotation}},{key:"rotate",value:function(t){0!==t&&(this.rotation+=t,this.dirty=!0)}},{key:"setScale",value:function(t,e){this.scale.set(t,e),this.dirty=!0}},{key:"applyScale",value:function(t){this.scale.scale(t),this.dirty=!0}},{key:"getVertices",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.vertices,i=this.region;if(!this.dirty)return e;var n=this.position.x,r=this.position.y,s=this.size.x,a=this.size.y,o=this.origin.x,h=this.origin.y,u=this.rotation,l=this.scale.x,c=this.scale.y,g=i.u,d=i.v,f=i.u2,p=i.v2,_=this.color,v=i.rotated,y=s/i.originalWidth,m=a/i.originalHeight,x=i.width*y,M=i.height*m,w=n+i.offsetX*y;if(n=w,r=t?r+a-i.offsetY*m-M:r+i.offsetY*m,t){var b=d;d=p,p=b}var E=-o,S=(s=x)-o,C=s-o,k=-o,P=-h,I=-h,D=(a=M)-h,R=a-h;if(1!==l&&(E*=l,S*=l,C*=l,k*=l),1!==c&&(P*=c,I*=c,D*=c,R*=c),0!==u){var T=Math.cos(u),L=Math.sin(u),A=T*E-L*P,V=L*E+T*P,O=T*S-L*I,F=L*S+T*I,N=T*C-L*D,j=L*C+T*D,B=T*k-L*R,z=L*k+T*R;E=A,S=O,C=N,k=B,P=V,I=F,D=j,R=z}E+=n+o,S+=n+o,C+=n+o,k+=n+o,P+=r+h,I+=r+h,D+=r+h,R+=r+h;var G=g,W=d,H=f,X=p,Y=H,U=W,q=G,Z=X;v&&(t?(G=g,W=p,H=f,X=d,Y=g,U=d,q=f,Z=p):(G=f,W=d,H=g,X=p,Y=f,U=p,q=g,Z=d));var K=0;return e[K++]=E,e[K++]=P,e[K++]=_.r,e[K++]=_.g,e[K++]=_.b,e[K++]=_.a,e[K++]=G,e[K++]=W,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=S,e[K++]=I,e[K++]=_.r,e[K++]=_.g,e[K++]=_.b,e[K++]=_.a,e[K++]=Y,e[K++]=U,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=C,e[K++]=D,e[K++]=_.r,e[K++]=_.g,e[K++]=_.b,e[K++]=_.a,e[K++]=H,e[K++]=X,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=0,e[K++]=k,e[K++]=R,e[K++]=_.r,e[K++]=_.g,e[K++]=_.b,e[K++]=_.a,e[K++]=q,e[K++]=Z,e[K++]=0,e[K++]=0,e[K++]=0,e[K]=0,e}},{key:"getBoundingRectangle",value:function(){var t=this.vertices,e=t[0],i=t[1],n=t[0],r=t[1];return e=(e=(e=e>t[12]?t[12]:e)>t[24]?t[24]:e)>t[36]?t[36]:e,n=(n=(n=n<t[12]?t[12]:n)<t[24]?t[24]:n)<t[36]?t[36]:n,i=(i=(i=i>t[13]?t[13]:i)>t[25]?t[25]:i)>t[37]?t[37]:i,r=(r=(r=r<t[13]?t[13]:r)<t[25]?t[25]:r)<t[37]?t[37]:r,this.bounds.x=e,this.bounds.y=i,this.bounds.width=n-e,this.bounds.height=r-i,this.bounds}},{key:"draw",value:function(t){t.drawVertices(this.region.texture,this.getVertices(t.yDown))}},{key:"drawWithAlpha",value:function(t,e){var i=this.getColor().a;this.setAlpha(i*e),this.draw(t),this.setAlpha(i)}},{key:"getX",value:function(){return this.position.x}},{key:"getY",value:function(){return this.position.y}},{key:"getWidth",value:function(){return this.size.x}},{key:"getHeight",value:function(){return this.size.y}},{key:"getOriginX",value:function(){return this.origin.x}},{key:"getOriginY",value:function(){return this.origin.y}},{key:"getScaleX",value:function(){return this.scale.x}},{key:"getScaleY",value:function(){return this.scale.y}},{key:"getColor",value:function(){return this.color}}]),t}();e.Sprite=o},3432:function(t,e,i){"use strict";var n,r=i(6690).default,s=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Texture=e.TextureWrap=e.TextureFilter=void 0,function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(n=e.TextureFilter||(e.TextureFilter={})),function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(e.TextureWrap||(e.TextureWrap={}));var a=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,t),this.texture=null,this.boundUnit=0,this.useMipMaps=!1,this.width=0,this.height=0,this._image=i,this.context=e,this.useMipMaps=n,this.restore(),this.width=i.width,this.height=i.height}return s(t,[{key:"getImage",value:function(){return this._image}},{key:"getWebGLTexture",value:function(){return this.texture}},{key:"setFilters",value:function(e,i){var n=this.context;this.bind(),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,t.validateMagFilter(i))}},{key:"setWraps",value:function(t,e){var i=this.context;this.bind(),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,e)}},{key:"update",value:function(e){var i=this.context;this.texture||(this.texture=this.context.createTexture()),this.bind(),t.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL&&i.pixelStorei(i.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,this._image),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,e?i.LINEAR_MIPMAP_LINEAR:i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),e&&i.generateMipmap(i.TEXTURE_2D)}},{key:"restore",value:function(){this.texture=null,this.update(this.useMipMaps)}},{key:"bind",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=this.context;this.boundUnit=t,e.activeTexture(e.TEXTURE0+t),e.bindTexture(e.TEXTURE_2D,this.texture)}},{key:"unbind",value:function(){var t=this.context;t.activeTexture(t.TEXTURE0+this.boundUnit),t.bindTexture(t.TEXTURE_2D,null)}},{key:"dispose",value:function(){this.context.deleteTexture(this.texture)}}],[{key:"load",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r){var s=new Image;s.onload=function(){r(new t(e,s,n))},s.src=i}))}},{key:"validateMagFilter",value:function(t){switch(t){case n.MipMap:case n.MipMapLinearLinear:case n.MipMapLinearNearest:case n.MipMapNearestLinear:case n.MipMapNearestNearest:return n.Linear;default:return t}}}]),t}();e.Texture=a,a.DISABLE_UNPACK_PREMULTIPLIED_ALPHA_WEBGL=!1},8143:function(t,e,i){"use strict";var n=i(7061).default,r=i(7424).default,s=i(4704).default,a=i(6690).default,o=i(9728).default,h=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))((function(r,s){function a(t){try{h(n.next(t))}catch(e){s(e)}}function o(t){try{h(n.throw(t))}catch(e){s(e)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}h((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.TextureAtlas=void 0;var u=i(3432),l=i(8026);function c(t,e){for(var i=t.split("/"),n=e.split("/"),r=[],s=0,a=i.length;s<a;s++)if(".."===i[s])r.pop();else{if("."===i[s])continue;r.push(i[s])}for(var o=0,h=n.length;o<h;o++)if(".."===n[o])r.pop();else{if("."===n[o])continue;r.push(n[o])}return r.join("/")}var g=function(){function t(e,i){a(this,t),this.pages=e,this.regions=i}return o(t,[{key:"dispose",value:function(){var t,e=s(this.pages);try{for(e.s();!(t=e.n()).done;){t.value.dispose()}}catch(i){e.e(i)}finally{e.f()}}},{key:"getPages",value:function(){return this.pages}},{key:"getRegions",value:function(){return this.regions}},{key:"findRegion",value:function(t,e){for(var i=0;i<this.regions.length;i++){var n=this.regions[i];if(n.name===t&&(void 0===e||n.index===e))return n}return null}},{key:"findRegions",value:function(t){return this.regions.filter((function(e){return e.name===t})).sort((function(t,e){return t.index-e.index}))}}],[{key:"load",value:function(e,i,s){return h(this,void 0,void 0,n().mark((function a(){var o,h,g,d,f,p,_,v,y,m,x,M,w,b,E,S,C,k,P,I,D,R,T,L,A,V,O,F,N,j,B,z,G,W,H,X,Y,U,q,Z,K;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(i).then((function(t){return t.text()}));case 2:o=n.sent,h=[],g=[],d=[],p=o.split(/\r?\n/),_=0;case 8:if(void 0!==(y=p[_])){n.next=12;break}return n.abrupt("break",16);case 12:0===y.trim().length?f=null:null===f?(m=c(i,"../".concat(y)),_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})),x=parseInt(v[0],10),M=parseInt(v[1],10),_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})),w=v[0],_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})),b=r(v,2),E=b[0],S=b[1],_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})),C=v[0],k=u.TextureWrap.ClampToEdge,P=u.TextureWrap.ClampToEdge,"x"===C?k=u.TextureWrap.Repeat:"y"===C?P=u.TextureWrap.Repeat:"xy"===C&&(k=u.TextureWrap.Repeat,P=u.TextureWrap.Repeat),f={file:m,width:x,height:M,format:w,mipMaps:"Nearest"!==E&&"Linear"!==E,min:E,max:S,direction:C,repeatX:k,repeatY:P},h.push(f)):(I=y,_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})),D="true"===v[0],_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})),R=parseInt(v[0],10),T=parseInt(v[1],10),_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})),L=parseInt(v[0],10),A=parseInt(v[1],10),V={name:I,rotate:D,left:R,top:T,width:L,height:A,page:f},_++,y=p[_],4===(v=y.split(":")[1].split(",").map((function(t){return t.trim()}))).length&&(V.splits=v.map((function(t){return parseInt(t,10)})),_++,y=p[_],4===(v=y.split(":")[1].split(",").map((function(t){return t.trim()}))).length&&(V.pads=v.map((function(t){return parseInt(t,10)})),_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})))),V.originalWidth=parseInt(v[0],10),V.originalHeight=parseInt(v[1],10),_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})),V.offsetX=parseInt(v[0],10),V.offsetY=parseInt(v[1],10),_++,y=p[_],v=y.split(":")[1].split(",").map((function(t){return t.trim()})),V.index=parseInt(v[0],10),d.push(V)),_++,n.next=8;break;case 16:O=0,F=h;case 17:if(!(O<F.length)){n.next=27;break}return N=F[O],n.next=21,u.Texture.load(e,N.file,s);case 21:N.texture=n.sent,N.invTexWidth=1/N.texture.width,N.invTexHeight=1/N.texture.height;case 24:O++,n.next=17;break;case 27:for(j=[],B=0,z=d;B<z.length;B++)G=z[B],W=G.left,H=G.top,X=G.rotate?G.height:G.width,Y=G.rotate?G.width:G.height,U=G.page,q=U.texture,Z=U.invTexWidth,K=U.invTexHeight,j.push(new l.TextureRegion(q,W,H,X,Y,G,Z,K,G.rotate));return n.abrupt("return",new t(g,j));case 30:case"end":return n.stop()}}),a)})))}}]),t}();e.TextureAtlas=g},8026:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.TextureRegion=void 0;var s=function(){function t(e,i,r,s,a,o,h,u){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];n(this,t),this.name=null,this.index=0,this.texture=null,this.regionX=0,this.regionY=0,this.width=0,this.height=0,this.invTexWidth=0,this.invTexHeight=0,this.originalWidth=0,this.originalHeight=0,this.offsetX=0,this.offsetY=0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.rotated=!1,h&&u||(h=1/e.width,u=1/e.height);var c=i*h,g=(r+a)*u,d=(i+s)*h,f=r*u;for(var p in this.texture=e,this.regionX=i,this.regionY=r,this.width=s,this.height=a,this.originalWidth=s,this.originalHeight=a,this.offsetX=0,this.offsetY=0,this.u=c,this.v=g,this.u2=d,this.v2=f,this.rotated=l,o)this[p]=o[p]}return r(t,[{key:"draw",value:function(t,e,i,n,r){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,h=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:1,l=this.originalWidth,c=this.originalHeight,g=this.offsetX,d=this.offsetY,f=this.width,p=this.height,_=n/l,v=r/c,y=f*_,m=p*v,x=e+g*_,M=0;s-=x-e,a-=(M=t.yDown?i+r-d*v-m:i+d*v)-i,t.draw(this.texture,x,M,y,m,s,a,o,h,u,this.u,this.v,this.u2,this.v2,this.rotated)}}],[{key:"splitTexture",value:function(e,i,n){for(var r=e.width/i,s=e.height/n,a=[],o=0;o<n;o++)for(var h=0;h<i;h++)a.push(new t(e,h*r,o*s,r,s,{}));return a}}]),t}();e.TextureRegion=s},8637:function(t,e,i){"use strict";var n,r=i(1655).default,s=i(6389).default,a=i(6690).default,o=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.copyArray=e.createStage=e.pointInRect=e.resizeCanvas=e.createGameLoop=e.WindowedMean=e.TimeKeeper=e.Pools=e.Pool=e.Utils=e.PowOut=e.Pow=e.Interpolation=e.MathUtils=e.Color=e.StringSet=e.IntSet=e.Align=void 0;var h=function(){function t(){a(this,t)}return o(t,null,[{key:"isLeft",value:function(t){return 0!==(t&this.left)}},{key:"isRight",value:function(t){return 0!==(t&this.right)}},{key:"isTop",value:function(t){return 0!==(t&this.top)}},{key:"isBottom",value:function(t){return 0!==(t&this.bottom)}},{key:"isCenterVertical",value:function(t){return 0===(t&this.top)&&0===(t&this.bottom)}},{key:"isCenterHorizontal",value:function(t){return 0===(t&this.left)&&0===(t&this.right)}}]),t}();e.Align=h,n=h,h.center=1,h.top=2,h.bottom=4,h.left=8,h.right=16,h.topLeft=n.top|n.left,h.topRight=n.top|n.right,h.bottomLeft=n.bottom|n.left,h.bottomRight=n.bottom|n.right;var u=function(){function t(){a(this,t),this.array=new Array}return o(t,[{key:"add",value:function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e}},{key:"contains",value:function(t){return void 0!==this.array[0|t]}},{key:"remove",value:function(t){this.array[0|t]=void 0}},{key:"clear",value:function(){this.array.length=0}}]),t}();e.IntSet=u;var l=function(){function t(){a(this,t),this.entries={},this.size=0}return o(t,[{key:"add",value:function(t){var e=this.entries[t];return this.entries[t]=!0,!e&&(this.size++,!0)}},{key:"addAll",value:function(t){for(var e=this.size,i=0,n=t.length;i<n;i++)this.add(t[i]);return e!==this.size}},{key:"contains",value:function(t){return this.entries[t]}},{key:"clear",value:function(){this.entries={},this.size=0}}]),t}();e.StringSet=l;var c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;a(this,t),this.r=e,this.g=i,this.b=n,this.a=r}return o(t,[{key:"unsafeSet",value:function(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=n}},{key:"set",value:function(t,e,i,n){return this.r=t,this.g=e,this.b=i,this.a=n,this.clamp()}},{key:"setFromColor",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}},{key:"setFromString",value:function(t){return t="#"===t.charAt(0)?t.substring(1):t,this.r=parseInt(t.substring(0,2),16)/255,this.g=parseInt(t.substring(2,4),16)/255,this.b=parseInt(t.substring(4,6),16)/255,this.a=8!==t.length?1:parseInt(t.substring(6,8),16)/255,this}},{key:"add",value:function(t,e,i,n){return this.r+=t,this.g+=e,this.b+=i,this.a+=n,this.clamp()}},{key:"clamp",value:function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}},{key:"toIntBits",value:function(){return 255*this.a<<24|255*this.b<<16|255*this.g<<8|255*this.r}}],[{key:"rgba8888ToColor",value:function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}},{key:"rgb888ToColor",value:function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}},{key:"fromString",value:function(e){return(new t).setFromString(e)}}]),t}();e.Color=c,c.WHITE=new c(1,1,1,1),c.RED=new c(1,0,0,1),c.GREEN=new c(0,1,0,1),c.BLUE=new c(0,0,1,1),c.MAGENTA=new c(1,0,1,1);var g=function(){function t(){a(this,t)}return o(t,null,[{key:"clamp",value:function(t,e,i){return t<e?e:t>i?i:t}},{key:"cosDeg",value:function(e){return Math.cos(e*t.degRad)}},{key:"sinDeg",value:function(e){return Math.sin(e*t.degRad)}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}},{key:"toInt",value:function(t){return t>0?Math.floor(t):Math.ceil(t)}},{key:"cbrt",value:function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}},{key:"randomTriangular",value:function(e,i){return t.randomTriangularWith(e,i,.5*(e+i))}},{key:"randomTriangularWith",value:function(t,e,i){var n=Math.random(),r=e-t;return n<=(i-t)/r?t+Math.sqrt(n*r*(i-t)):e-Math.sqrt((1-n)*r*(e-i))}},{key:"isPowerOfTwo",value:function(t){return t&&0===(t&t-1)}}]),t}();e.MathUtils=g,g.PI=3.1415927,g.PI2=2*g.PI,g.radiansToDegrees=180/g.PI,g.radDeg=g.radiansToDegrees,g.degreesToRadians=g.PI/180,g.degRad=g.degreesToRadians;var d=function(){function t(){a(this,t)}return o(t,[{key:"apply",value:function(t,e,i){return t+(e-t)*this.applyInternal(i)}}]),t}();e.Interpolation=d;var f=function(t){r(i,t);var e=s(i);function i(t){var n;return a(this,i),(n=e.call(this)).power=2,n.power=t,n}return o(i,[{key:"applyInternal",value:function(t){return t<=.5?Math.pow(2*t,this.power)/2:Math.pow(2*(t-1),this.power)/(this.power%2===0?-2:2)+1}}]),i}(d);e.Pow=f;var p=function(t){r(i,t);var e=s(i);function i(){return a(this,i),e.apply(this,arguments)}return o(i,[{key:"applyInternal",value:function(t){return Math.pow(t-1,this.power)*(this.power%2===0?-1:1)+1}}]),i}(f);e.PowOut=p;var _=function(){function t(){a(this,t)}return o(t,null,[{key:"arrayCopy",value:function(t,e,i,n,r){for(var s=e,a=n;s<e+r;s++,a++)i[a]=t[s]}},{key:"arrayFill",value:function(t,e,i,n){for(var r=e;r<i;r++)t[r]=n}},{key:"setArraySize",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.length;if(n===e)return t;if(t.length=e,n<e)for(var r=n;r<e;r++)t[r]=i;return t}},{key:"ensureArrayCapacity",value:function(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.length>=i?e:t.setArraySize(e,i,n)}},{key:"newArray",value:function(t,e){for(var i=new Array(t),n=0;n<t;n++)i[n]=e;return i}},{key:"newFloatArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i}},{key:"newShortArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var i=new Array(e),n=0;n<i.length;n++)i[n]=0;return i}},{key:"toFloatArray",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}},{key:"toSinglePrecision",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}},{key:"contains",value:function(t,e){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1}},{key:"enumValue",value:function(t,e){return t[e[0].toUpperCase()+e.slice(1)]}}]),t}();e.Utils=_,_.SUPPORTS_TYPED_ARRAYS="undefined"!==typeof Float32Array;var v=function(){function t(e){a(this,t),this.items=new Array,this.instantiator=e||function(){return{}}}return o(t,[{key:"obtain",value:function(){return this.items.length>0?this.items.pop():this.instantiator()}},{key:"free",value:function(t){(null===t||void 0===t?void 0:t.reset)&&t.reset(),this.items.push(t)}},{key:"freeAll",value:function(t){for(var e=0;e<t.length;e++)this.free(t[e])}},{key:"clear",value:function(){this.items.length=0}}]),t}();e.Pool=v;var y=function(){function t(){a(this,t)}return o(t,null,[{key:"free",value:function(t,e){this.pools[t]&&this.pools[t].free(e)}},{key:"freeAll",value:function(t,e){this.pools[t]&&this.pools[t].freeAll(e)}},{key:"get",value:function(t,e){return this.pools[t]||(this.pools[t]=new v(e)),this.pools[t]}},{key:"set",value:function(t,e){this.pools[t]=e}},{key:"obtain",value:function(t,e){return this.get(t,e).obtain()}}]),t}();e.Pools=y,y.pools={};var m=function(){function t(){a(this,t),this.maxDelta=.064,this.framesPerSecond=0,this.delta=0,this.totalTime=0,this.lastTime=Date.now()/1e3,this.frameCount=0,this.frameTime=0}return o(t,[{key:"update",value:function(){var t=Date.now()/1e3;this.delta=t-this.lastTime,this.frameTime+=this.delta,this.totalTime+=this.delta,this.delta>this.maxDelta&&(this.delta=this.maxDelta),this.lastTime=t,this.frameCount++,this.frameTime>1&&(this.framesPerSecond=this.frameCount/this.frameTime,this.frameTime=0,this.frameCount=0)}}]),t}();e.TimeKeeper=m;var x=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;a(this,t),this.addedValues=0,this.lastValue=0,this.mean=0,this.dirty=!0,this.values=new Array(e)}return o(t,[{key:"hasEnoughData",value:function(){return this.addedValues>=this.values.length}},{key:"addValue",value:function(t){this.addedValues<this.values.length&&this.addedValues++,this.values[this.lastValue++]=t,this.lastValue>this.values.length-1&&(this.lastValue=0),this.dirty=!0}},{key:"getMean",value:function(){if(this.hasEnoughData()){if(this.dirty){for(var t=0,e=0;e<this.values.length;e++)t+=this.values[e];this.mean=t/this.values.length,this.dirty=!1}return this.mean}return 0}}]),t}();e.WindowedMean=x;e.createGameLoop=function(t){var e,i=Date.now(),n=0,r=!0,s=0,a=0;function o(){if(r){var h=Date.now()-i;i=Date.now(),s++,(a+=h)>=1e3&&(n=s,s=0,a-=1e3),e=requestAnimationFrame(o),t(h/1e3)}}return o(),{isRunning:function(){return r},start:function(){r||(r=!0,o())},stop:function(){e&&cancelAnimationFrame(e),r=!1},getFps:function(){return n}}};e.resizeCanvas=function(t,e){var i=e||window.devicePixelRatio||1,n=t.clientWidth*i,r=t.clientHeight*i;return t.width===n&&t.height===r||(t.width=n,t.height=r),[n,r]};e.pointInRect=function(t,e,i,n,r,s){return t>i&&t<i+r&&e>n&&e<n+s};e.createStage=function(t){t=Object.assign(Object.assign({},{hidden:!1,info:!0}),t);var e=document.createElement("div");e.setAttribute("style","position:fixed;top:0;left:0;right:0;bottom:0;"),t.wrapperClassName&&(e.className=t.wrapperClassName),t.hidden&&(e.style.display="none");var i=document.createElement("canvas");i.setAttribute("style","width:100%;height:100%;");var n=document.createElement("div");return n.setAttribute("style","position:absolute;top:1em;left:1em;color:white"),t.info||(n.style.display="none"),e.appendChild(i),e.appendChild(n),document.body.appendChild(e),{getCanvas:function(){return i},getInfo:function(){return n},show:function(){return e.style.display="block"},hide:function(){return e.style.display="none"},cleanup:function(){return document.body.removeChild(e)}}};e.copyArray=function(t,e){for(var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:e.length,s=0;s<r;s++)e[i+s]=t[n+s]}},3192:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Vector2=void 0;var s=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;n(this,t),this.x=0,this.y=0,this.x=e,this.y=i}return r(t,[{key:"getX",value:function(){return this.x}},{key:"getY",value:function(){return this.y}},{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"setVector",value:function(t){return this.set(t.x,t.y)}},{key:"add",value:function(t,e){return this.x+=t,this.y+=e,this}},{key:"addVector",value:function(t){return this.add(t.x,t.y)}},{key:"sub",value:function(t,e){return this.add(-t,-e)}},{key:"subVector",value:function(t){return this.sub(t.x,t.y)}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"distanceSqr",value:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSqr(t))}},{key:"angle",value:function(){return Math.atan2(this.y,this.x)}},{key:"len2",value:function(){return this.x*this.x+this.y*this.y}},{key:"len",value:function(){return Math.sqrt(this.len2())}},{key:"nor",value:function(){var t=this.len();return 0!==t&&(this.x/=t,this.y/=t),this}},{key:"rotateRad",value:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.x*e-this.y*i,r=this.x*i+this.y*e;return this.x=n,this.y=r,this}},{key:"rotate",value:function(t){return this.rotateRad(t*Math.PI/180)}},{key:"cpy",value:function(){return new t(this.x,this.y)}}]),t}();e.Vector2=s},2668:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.Vector3=void 0;var s=i(5474),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;n(this,t),this.x=0,this.y=0,this.z=0,this.x=e,this.y=i,this.z=r}return r(t,[{key:"setFrom",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"set",value:function(t,e,i){return this.x=t,this.y=e,this.z=i,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"scale",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"normalize",value:function(){var t=this.length();return 0===t||(t=1/t,this.x*=t,this.y*=t,this.z*=t),this}},{key:"cross",value:function(t){return this.set(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}},{key:"multiply",value:function(t){var e=t.values;return this.set(this.x*e[s.M00]+this.y*e[s.M01]+this.z*e[s.M02]+e[s.M03],this.x*e[s.M10]+this.y*e[s.M11]+this.z*e[s.M12]+e[s.M13],this.x*e[s.M20]+this.y*e[s.M21]+this.z*e[s.M22]+e[s.M23])}},{key:"project",value:function(t){var e=t.values,i=1/(this.x*e[s.M30]+this.y*e[s.M31]+this.z*e[s.M32]+e[s.M33]);return this.set((this.x*e[s.M00]+this.y*e[s.M01]+this.z*e[s.M02]+e[s.M03])*i,(this.x*e[s.M10]+this.y*e[s.M11]+this.z*e[s.M12]+e[s.M13])*i,(this.x*e[s.M20]+this.y*e[s.M21]+this.z*e[s.M22]+e[s.M23])*i)}},{key:"unproject",value:function(t,e,i,n,r,s){var a=this.x,o=this.y,h=this.z;return a-=i,o=s-o-1,o-=n,t.set(2*a/r-1,2*o/s-1,2*h-1),t.project(e),t}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"distance",value:function(t){var e=t.x-this.x,i=t.y-this.y,n=t.z-this.z;return Math.sqrt(e*e+i*i+n*n)}}]),t}();e.Vector3=a},7885:function(t,e,i){"use strict";var n=i(4704).default,r=i(7424).default;Object.defineProperty(e,"__esModule",{value:!0}),e.createViewport=void 0;var s=i(814),a=i(8637);e.createViewport=function(t,e,i,o){var h,u={autoUpdate:!0,pixelRatio:void 0,crop:!0};(o=Object.assign(Object.assign({},u),o)).disablePremultipliedAlpha&&(h={premultipliedAlpha:!1}),h=Object.assign(Object.assign({},h),o.contextOption);var l,c=t.getContext("webgl2",h),g=[],d=o,f=d.autoUpdate,p=d.pixelRatio,_=d.crop,v={pixelRatio:p=p||window.devicePixelRatio||1,x:0,y:0,width:e,height:i,worldWidth:e,worldHeight:i},y=(0,a.resizeCanvas)(t,p),m=r(y,2),x=m[0],M=m[1],w=new s.OrthoCamera(e,i,x,M);f&&(l=function(t){b.update()},window.addEventListener("resize",l));var b={getViewportInfo:function(){return v},getCamera:function(){return w},addCamera:function(t){g.push(t)},getContext:function(){return c},getCanvas:function(){return t},update:function(){var s=(0,a.resizeCanvas)(t,p),o=r(s,2),h=o[0],u=o[1],l=e/i,d=h/u;if(_){var f,y;l<d?(y=u,f=u*l):(f=h,y=h/l);var m=(h-f)/2,x=(u-y)/2;v.x=m,v.y=x,v.width=f,v.height=y,c.viewport(m,x,f,y),w.setPosition(e/2,i/2),w.resize(e,i,f,y);var M,b=n(g);try{for(b.s();!(M=b.n()).done;){var E=M.value;E.setPosition(e/2,i/2),E.resize(e,i,f,y)}}catch(T){b.e(T)}finally{b.f()}}else{var S,C,k,P;v.x=0,v.y=0,v.width=h,v.height=u,c.viewport(0,0,h,u),l<d?(k=-((S=(C=i)*d)-e)/2,P=0):(k=0,P=-((C=(S=e)/d)-i)/2),w.setPosition(k+S/2,P+C/2),w.resize(S,C,h,u);var I,D=n(g);try{for(D.s();!(I=D.n()).done;){var R=I.value;R.setPosition(k+S/2,P+C/2),R.resize(S,C,h,u)}}catch(T){D.e(T)}finally{D.f()}}},cleanUp:function(){l&&window.removeEventListener("resize",l)}};return f&&b.update(),b}},4634:function(t,e,i){"use strict";var n=i(6690).default,r=i(9728).default;Object.defineProperty(e,"__esModule",{value:!0}),e.ViewportInputHandler=void 0;var s=i(3233),a=i(3192),o=function(){function t(e){n(this,t),this.screenCoord=new a.Vector2,this.worldCoord=new a.Vector2,this.viewport=e,this.canvas=e.getCanvas(),this.inputHandler=new s.InputHandler(this.canvas)}return r(t,[{key:"isTouched",value:function(){return this.inputHandler.isTouched()}},{key:"cleanup",value:function(){this.inputHandler.cleanup()}},{key:"addEventListener",value:function(t,e){var i,n;this.inputHandler.addEventListener(t,(i=e,n=this.viewport,function(t,e){var r=n.getViewportInfo(),s=r.x,a=r.y,o=r.pixelRatio;i(t=t*o-s,e=e*o-a)}))}},{key:"getX",value:function(){var t=this.viewport.getViewportInfo(),e=t.x,i=t.pixelRatio;return this.inputHandler.getX()*i-e}},{key:"getY",value:function(){var t=this.viewport.getViewportInfo(),e=t.y,i=t.pixelRatio;return this.inputHandler.getY()*i-e}},{key:"getTouchedWorldCoord",value:function(t){return t||(t=this.viewport.getCamera()),this.screenCoord.set(this.getX(),this.getY()),t.unprojectVector2(this.worldCoord,this.screenCoord),this.worldCoord}}]),t}();e.ViewportInputHandler=o},5547:function(t,e,i){"use strict";var n=this&&this.__createBinding||(Object.create?function(t,e,i,n){void 0===n&&(n=i);var r=Object.getOwnPropertyDescriptor(e,i);r&&!("get"in r?!e.__esModule:r.writable||r.configurable)||(r={enumerable:!0,get:function(){return e[i]}}),Object.defineProperty(t,n,r)}:function(t,e,i,n){void 0===n&&(n=i),t[n]=e[i]}),r=this&&this.__exportStar||function(t,e){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(e,i)||n(e,t,i)};Object.defineProperty(e,"__esModule",{value:!0}),r(i(9054),e),r(i(7035),e),r(i(5283),e),r(i(6735),e),r(i(909),e),r(i(2691),e),r(i(814),e),r(i(2229),e),r(i(5508),e),r(i(417),e),r(i(1013),e),r(i(3233),e),r(i(5474),e),r(i(4731),e),r(i(2226),e),r(i(2991),e),r(i(6403),e),r(i(9805),e),r(i(2438),e),r(i(3432),e),r(i(8143),e),r(i(8026),e),r(i(8637),e),r(i(3192),e),r(i(2668),e),r(i(7885),e),r(i(4634),e)},9743:function(t,e,i){!function(t,e){"use strict";t.wings=t.wings||{},t.wings.jsCanvas=t.wings.jsCanvas||{},t.wings.core=t.wings.core||{},t.hxPixels=t.hxPixels||{},t.hxPixels._Pixels=t.hxPixels._Pixels||{},t.hxDaedalus=t.hxDaedalus||{},t.hxDaedalus.view=t.hxDaedalus.view||{},t.hxDaedalus.iterators=t.hxDaedalus.iterators||{},t.hxDaedalus.factories=t.hxDaedalus.factories||{},t.hxDaedalus.data=t.hxDaedalus.data||{},t.hxDaedalus.data.math=t.hxDaedalus.data.math||{},t.hxDaedalus.data.graph=t.hxDaedalus.data.graph||{},t.hxDaedalus.ai=t.hxDaedalus.ai||{},t.hxDaedalus.ai.trajectory=t.hxDaedalus.ai.trajectory||{};var i=function(){return rt.__string_rec(this,"")};var n=function(){};n.__name__=!0,n.cca=function(t,e){var i=t.charCodeAt(e);if(i==i)return i},n.substr=function(t,e,i){if(null==i)i=t.length;else if(i<0){if(0!=e)return"";i=t.length+i}return t.substr(e,i)},Math.__name__=!0;var r=function(){};r.__name__=!0,r.string=function(t){return rt.__string_rec(t,"")},r.parseInt=function(t){var e=parseInt(t,10);return 0!=e||120!=n.cca(t,1)&&88!=n.cca(t,1)||(e=parseInt(t)),isNaN(e)?null:e};var s=function(){};s.__name__=!0,s.hex=function(t,e){for(var i="";i="0123456789ABCDEF".charAt(15&t)+i,(t>>>=4)>0;);if(null!=e)for(;i.length<e;)i="0"+i;return i};var a=function(){};a.__name__=!0;var o=function(){this.h={__keys__:{}}};o.__name__=!0,o.__interfaces__=[a],o.prototype={set:function(t,e){var i=t.__id__||(t.__id__=++o.count);this.h[i]=e,this.h.__keys__[i]=t},__class__:o};var h=function(){this.h={}};h.__name__=!0,h.__interfaces__=[a],h.prototype={setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},__class__:h};var u=function(t){this.length=t.byteLength,this.b=new bt(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};u.__name__=!0,u.prototype={blit:function(t,e,i,n){if(t<0||i<0||n<0||t+n>this.length||i+n>e.length)throw new nt(l.OutsideBounds);0==i&&n==e.b.byteLength?this.b.set(e.b,t):this.b.set(e.b.subarray(i,i+n),t)},__class__:u};var l={__ename__:!0,__constructs__:["Blocked","Overflow","OutsideBounds","Custom"],Blocked:["Blocked",0]};l.Blocked.toString=i,l.Blocked.__enum__=l,l.Overflow=["Overflow",1],l.Overflow.toString=i,l.Overflow.__enum__=l,l.OutsideBounds=["OutsideBounds",2],l.OutsideBounds.toString=i,l.OutsideBounds.__enum__=l,l.Custom=function(t){var e=["Custom",3,t];return e.__enum__=l,e.toString=i,e};var c=t.hxDaedalus.ai.AStar=function(){this.iterEdge=new W};c.__name__=!0,c.prototype={dispose:function(){this._mesh=null,this.closedFaces=null,this.sortedOpenedFaces=null,this.openedFaces=null,this.entryEdges=null,this.entryX=null,this.entryY=null,this.scoreF=null,this.scoreG=null,this.scoreH=null,this.predecessor=null},get_radius:function(){return this._radius},set_radius:function(t){return this._radius=t,this.radiusSquared=this._radius*this._radius,this.diameter=2*this._radius,this.diameterSquared=this.diameter*this.diameter,t},set_mesh:function(t){return this._mesh=t,t},findPath:function(t,e,i,n,r,s){var a,h,u;switch(this.closedFaces=new o,this.sortedOpenedFaces=[],this.openedFaces=new o,this.entryEdges=new o,this.entryX=new o,this.entryY=new o,this.scoreF=new o,this.scoreG=new o,this.scoreH=new o,this.predecessor=new o,(a=R.locatePosition(t,e,this._mesh))[1]){case 0:return void(u=a[2]);case 1:if((h=a[2]).get_isConstrained())return;this.fromFace=h.get_leftFace();break;case 2:var l=a[2];this.fromFace=l}switch((a=R.locatePosition(i,n,this._mesh))[1]){case 0:u=a[2],this.toFace=u.get_edge().get_leftFace();break;case 1:h=a[2],this.toFace=h.get_leftFace();break;case 2:var c=a[2];this.toFace=c}this.sortedOpenedFaces.push(this.fromFace),this.entryEdges.set(this.fromFace,null),this.entryX.set(this.fromFace,t),this.entryY.set(this.fromFace,e),this.scoreG.set(this.fromFace,0);var g,d,f,p,_,v=Math.sqrt((i-t)*(i-t)+(n-e)*(n-e));this.scoreH.set(this.fromFace,v),this.scoreF.set(this.fromFace,v);for(var y,m=new D,x=new D,M=new D;;){if(0==this.sortedOpenedFaces.length){this.curFace=null;break}if(this.curFace=this.sortedOpenedFaces.pop(),this.curFace==this.toFace)break;for(this.iterEdge.set_fromFace(this.curFace);null!=(g=this.iterEdge.next());)if(!g.get_isConstrained()&&(d=g.get_rightFace(),!this.closedFaces.h[d.__id__])){if(this.curFace!=this.fromFace&&this._radius>0&&!this.isWalkableByRadius(this.entryEdges.h[this.curFace.__id__],this.curFace,g))continue;if(m.x=this.entryX.h[this.curFace.__id__],m.y=this.entryY.h[this.curFace.__id__],x.x=(g.get_originVertex().get_pos().x+g.get_destinationVertex().get_pos().x)/2,x.y=(g.get_originVertex().get_pos().y+g.get_destinationVertex().get_pos().y)/2,M.x=x.x-i,M.y=x.y-n,_=M.get_length(),M.x=m.x-x.x,M.y=m.y-x.y,f=_+(p=this.scoreG.h[this.curFace.__id__]+M.get_length()),y=!1,null!=this.openedFaces.h[d.__id__]&&this.openedFaces.h[d.__id__]?this.scoreF.h[d.__id__]>f&&(y=!0):(this.sortedOpenedFaces.push(d),this.openedFaces.set(d,!0),y=!0),y){this.entryEdges.set(d,g);var w=x.x;this.entryX.set(d,w);var b=x.y;this.entryY.set(d,b),this.scoreF.set(d,f),this.scoreG.set(d,p),this.scoreH.set(d,_);var E=this.curFace;this.predecessor.set(d,E)}}this.openedFaces.set(this.curFace,!1),this.closedFaces.set(this.curFace,!0),this.sortedOpenedFaces.sort(ft(this,this.sortingFaces))}if(null!=this.curFace)for(r.push(this.curFace);this.curFace!=this.fromFace;)s.unshift(this.entryEdges.h[this.curFace.__id__]),this.curFace=this.predecessor.h[this.curFace.__id__],r.unshift(this.curFace)},sortingFaces:function(t,e){return this.scoreF.h[t.__id__]==this.scoreF.h[e.__id__]?0:this.scoreF.h[t.__id__]<this.scoreF.h[e.__id__]?1:-1},isWalkableByRadius:function(t,e,i){var n,r=null,s=null,a=null;if(t.get_originVertex()==i.get_originVertex()?(r=t.get_destinationVertex(),s=i.get_destinationVertex(),a=t.get_originVertex()):t.get_destinationVertex()==i.get_destinationVertex()?(r=t.get_originVertex(),s=i.get_originVertex(),a=t.get_destinationVertex()):t.get_originVertex()==i.get_destinationVertex()?(r=t.get_destinationVertex(),s=i.get_originVertex(),a=t.get_originVertex()):t.get_destinationVertex()==i.get_originVertex()&&(r=t.get_originVertex(),s=i.get_destinationVertex(),a=t.get_destinationVertex()),(a.get_pos().x-r.get_pos().x)*(s.get_pos().x-r.get_pos().x)+(a.get_pos().y-r.get_pos().y)*(s.get_pos().y-r.get_pos().y)<=0)return(a.get_pos().x-r.get_pos().x)*(a.get_pos().x-r.get_pos().x)+(a.get_pos().y-r.get_pos().y)*(a.get_pos().y-r.get_pos().y)>=this.diameterSquared;if((a.get_pos().x-s.get_pos().x)*(r.get_pos().x-s.get_pos().x)+(a.get_pos().y-s.get_pos().y)*(r.get_pos().y-s.get_pos().y)<=0)return(a.get_pos().x-s.get_pos().x)*(a.get_pos().x-s.get_pos().x)+(a.get_pos().y-s.get_pos().y)*(a.get_pos().y-s.get_pos().y)>=this.diameterSquared;if((n=e.get_edge()!=t&&e.get_edge().get_oppositeEdge()!=t&&e.get_edge()!=i&&e.get_edge().get_oppositeEdge()!=i?e.get_edge():e.get_edge().get_nextLeftEdge()!=t&&e.get_edge().get_nextLeftEdge().get_oppositeEdge()!=t&&e.get_edge().get_nextLeftEdge()!=i&&e.get_edge().get_nextLeftEdge().get_oppositeEdge()!=i?e.get_edge().get_nextLeftEdge():e.get_edge().get_prevLeftEdge()).get_isConstrained()){var h=new D(a.get_pos().x,a.get_pos().y);return R.projectOrthogonaly(h,n),(h.x-a.get_pos().x)*(h.x-a.get_pos().x)+(h.y-a.get_pos().y)*(h.y-a.get_pos().y)>=this.diameterSquared}var u=(a.get_pos().x-r.get_pos().x)*(a.get_pos().x-r.get_pos().x)+(a.get_pos().y-r.get_pos().y)*(a.get_pos().y-r.get_pos().y),l=(a.get_pos().x-s.get_pos().x)*(a.get_pos().x-s.get_pos().x)+(a.get_pos().y-s.get_pos().y)*(a.get_pos().y-s.get_pos().y);if(u<this.diameterSquared||l<this.diameterSquared)return!1;var c,g,d,f,p,_,v=[],y=[],m=new o;for(y.push(n),n.get_leftFace()==e?(v.push(n.get_rightFace()),m.set(n.get_rightFace(),!0)):(v.push(n.get_leftFace()),m.set(n.get_leftFace(),!0));v.length>0;){if(c=v.shift(),g=y.shift(),c.get_edge()==g||c.get_edge()==g.get_oppositeEdge()?(d=c.get_edge().get_nextLeftEdge(),p=c.get_edge().get_nextLeftEdge().get_nextLeftEdge()):c.get_edge().get_nextLeftEdge()==g||c.get_edge().get_nextLeftEdge()==g.get_oppositeEdge()?(d=c.get_edge(),p=c.get_edge().get_nextLeftEdge().get_nextLeftEdge()):(d=c.get_edge(),p=c.get_edge().get_nextLeftEdge()),f=d.get_leftFace()==c?d.get_rightFace():d.get_leftFace(),_=p.get_leftFace()==c?p.get_rightFace():p.get_leftFace(),!m.h[f.__id__]&&R.distanceSquaredVertexToEdge(a,d)<this.diameterSquared){if(d.get_isConstrained())return!1;v.push(f),y.push(d),m.set(f,!0)}if(!m.h[_.__id__]&&R.distanceSquaredVertexToEdge(a,p)<this.diameterSquared){if(p.get_isConstrained())return!1;v.push(_),y.push(p),m.set(_,!0)}}return!0},__class__:c};var g=t.hxDaedalus.ai.EntityAI=function(){this._radius=10,this.x=this.y=0,this.dirNormX=1,this.dirNormY=0};g.__name__=!0,g.prototype={buildApproximation:function(){this._approximateObject=new b,this._approximateObject.get_matrix().translate(this.x,this.y);var t=[];if(this._approximateObject.set_coordinates(t),0!=this._radius)for(var e=0;e<6;){var i=e++;t.push(this._radius*Math.cos(2*Math.PI*i/6)),t.push(this._radius*Math.sin(2*Math.PI*i/6)),t.push(this._radius*Math.cos(2*Math.PI*(i+1)/6)),t.push(this._radius*Math.sin(2*Math.PI*(i+1)/6))}},get_approximateObject:function(){return this._approximateObject.get_matrix().identity(),this._approximateObject.get_matrix().translate(this.x,this.y),this._approximateObject},get_radius:function(){return this._radius},get_radiusSquared:function(){return this._radiusSquared},set_radius:function(t){return this._radius=t,this._radiusSquared=this._radius*this._radius,t},__class__:g};var d=t.hxDaedalus.ai.Funnel=function(){this._currPoolPointsIndex=0,this._poolPointsSize=3e3,this._numSamplesCircle=16,this._radiusSquared=0,this._radius=0,this._poolPoints=[];for(var t=0,e=this._poolPointsSize;t<e;){t++;this._poolPoints.push(new D)}};d.__name__=!0,d.prototype={dispose:function(){this._sampleCircle=null},getPoint:function(t,e){return null==e&&(e=0),null==t&&(t=0),this.__point=this._poolPoints[this._currPoolPointsIndex],this.__point.setXY(t,e),this._currPoolPointsIndex++,this._currPoolPointsIndex==this._poolPointsSize&&(this._poolPoints.push(new D),this._poolPointsSize++),this.__point},getCopyPoint:function(t){return this.getPoint(t.x,t.y)},get_radius:function(){return this._radius},set_radius:function(t){if(this._radius=Math.max(0,t),this._radiusSquared=this._radius*this._radius,this._sampleCircle=[],0==this.get_radius())return 0;for(var e=0,i=this._numSamplesCircle;e<i;){var n=e++;this._sampleCircle.push(new D(this._radius*Math.cos(-2*Math.PI*n/this._numSamplesCircle),this._radius*Math.sin(-2*Math.PI*n/this._numSamplesCircle)))}return this._sampleCircleDistanceSquared=(this._sampleCircle[0].x-this._sampleCircle[1].x)*(this._sampleCircle[0].x-this._sampleCircle[1].x)+(this._sampleCircle[0].y-this._sampleCircle[1].y)*(this._sampleCircle[0].y-this._sampleCircle[1].y),this._radius},findPath:function(t,e,i,n,r,s,a){if(this._currPoolPointsIndex=0,this._radius>0){var h,u,l,c,g,d=r[0];l=d.get_edge().get_originVertex().get_pos(),c=d.get_edge().get_destinationVertex().get_pos(),g=d.get_edge().get_nextLeftEdge().get_destinationVertex().get_pos(),(h=(l.x-t)*(l.x-t)+(l.y-e)*(l.y-e))<=this._radiusSquared?(u=Math.sqrt(h),t=1.01*this._radius*((t-l.x)/u)+l.x,e=1.01*this._radius*((e-l.y)/u)+l.y):(h=(c.x-t)*(c.x-t)+(c.y-e)*(c.y-e))<=this._radiusSquared?(u=Math.sqrt(h),t=1.01*this._radius*((t-c.x)/u)+c.x,e=1.01*this._radius*((e-c.y)/u)+c.y):(h=(g.x-t)*(g.x-t)+(g.y-e)*(g.y-e))<=this._radiusSquared&&(u=Math.sqrt(h),t=1.01*this._radius*((t-g.x)/u)+g.x,e=1.01*this._radius*((e-g.y)/u)+g.y),l=(d=r[r.length-1]).get_edge().get_originVertex().get_pos(),c=d.get_edge().get_destinationVertex().get_pos(),g=d.get_edge().get_nextLeftEdge().get_destinationVertex().get_pos(),(h=(l.x-i)*(l.x-i)+(l.y-n)*(l.y-n))<=this._radiusSquared?(u=Math.sqrt(h),i=1.01*this._radius*((i-l.x)/u)+l.x,n=1.01*this._radius*((n-l.y)/u)+l.y):(h=(c.x-i)*(c.x-i)+(c.y-n)*(c.y-n))<=this._radiusSquared?(u=Math.sqrt(h),i=1.01*this._radius*((i-c.x)/u)+c.x,n=1.01*this._radius*((n-c.y)/u)+c.y):(h=(g.x-i)*(g.x-i)+(g.y-n)*(g.y-n))<=this._radiusSquared&&(u=Math.sqrt(h),i=1.01*this._radius*((i-g.x)/u)+g.x,n=1.01*this._radius*((n-g.y)/u)+g.y)}var f,p,_,v;if(f=new D(t,e),p=new D(i,n),1==r.length)return a.push(f.x),a.push(f.y),a.push(p.x),void a.push(p.y);var y,m=null,x=null,M=R.isInFace(t,e,r[0]);if(1==M[1]){var w=M[2];s[0]==w&&(s.shift(),r.shift())}var b=[],E=[];b.push(f),E.push(f);var S=new o,C=[],k=new o,P=new o;k.set(f,0),m=s[0];var I,T,L,A=R.getRelativePosition2(t,e,m);T=this.getCopyPoint(m.get_destinationVertex().get_pos()),L=this.getCopyPoint(m.get_originVertex().get_pos()),C.push(T),C.push(L),P.set(f,T),P.set(T,L),I=L,1==A?(k.set(T,1),k.set(L,-1),S.set(m.get_destinationVertex(),1),S.set(m.get_originVertex(),-1)):-1==A&&(k.set(T,-1),k.set(L,1),S.set(m.get_destinationVertex(),-1),S.set(m.get_originVertex(),1));for(var V=s[0].get_originVertex(),O=s[0].get_destinationVertex(),F=1,N=s.length;F<N;){(m=s[F++]).get_originVertex()==V?x=m.get_destinationVertex():m.get_destinationVertex()==V?x=m.get_originVertex():m.get_originVertex()==O?(x=m.get_destinationVertex(),V=O):m.get_destinationVertex()==O&&(x=m.get_originVertex(),V=O),T=this.getCopyPoint(x.get_pos()),C.push(T),y=-S.h[V.__id__],k.set(T,y),P.set(I,T),S.set(x,y),I=T,O=V,V=x}P.set(I,p),k.set(p,0);var j,B=[],z=new o;B.push(f),z.set(f,0);for(var G=0,W=C.length;G<W;){if(j=C[G++],-1==k.h[j.__id__]){for(v=b.length-2;v>=0;){if(-1!=(y=R.getDirection(b[v].x,b[v].y,b[v+1].x,b[v+1].y,j.x,j.y))){b.shift();for(var H=0,X=v;H<X;){H++;B.push(b[0]),z.set(b[0],1),b.shift()}B.push(b[0]),z.set(b[0],1),E.splice(0,E.length),E.push(b[0]),E.push(j);break}--v}for(E.push(j),v=E.length-3;v>=0&&-1!=(y=R.getDirection(E[v].x,E[v].y,E[v+1].x,E[v+1].y,j.x,j.y));)E.splice(v+1,1),--v}else{for(v=E.length-2;v>=0;){if(1!=(y=R.getDirection(E[v].x,E[v].y,E[v+1].x,E[v+1].y,j.x,j.y))){E.shift();for(var Y=0,U=v;Y<U;){Y++;B.push(E[0]),z.set(E[0],-1),E.shift()}B.push(E[0]),z.set(E[0],-1),b.splice(0,b.length),b.push(E[0]),b.push(j);break}--v}for(b.push(j),v=b.length-3;v>=0&&1!=(y=R.getDirection(b[v].x,b[v].y,b[v+1].x,b[v+1].y,j.x,j.y));)b.splice(v+1,1),--v}}var q=!1;for(v=E.length-2;v>=0;){if(1!=(y=R.getDirection(E[v].x,E[v].y,E[v+1].x,E[v+1].y,i,n))){E.shift();for(var Z=0,K=v+1;Z<K;){Z++;B.push(E[0]),z.set(E[0],-1),E.shift()}B.push(p),z.set(p,0),q=!0;break}--v}if(!q)for(v=b.length-2;v>=0;){if(-1!=(y=R.getDirection(b[v].x,b[v].y,b[v+1].x,b[v+1].y,i,n))){b.shift();for(var J=0,Q=v+1;J<Q;){J++;B.push(b[0]),z.set(b[0],1),b.shift()}B.push(p),z.set(p,0),q=!0;break}--v}q||(B.push(p),z.set(p,0),q=!0);var $=[];if(this.get_radius()>0){var tt=[];if(2==B.length)this.adjustWithTangents(B[0],!1,B[1],!1,k,P,tt,$);else if(B.length>2){if(this.adjustWithTangents(B[0],!1,B[1],!0,k,P,tt,$),B.length>3)for(var et=1,it=B.length-3+1;et<it;){var nt=et++;this.adjustWithTangents(B[nt],!0,B[nt+1],!0,k,P,tt,$)}var rt=B.length;this.adjustWithTangents(B[rt-2],!0,B[rt-1],!1,k,P,tt,$)}tt.push(p),this.checkAdjustedPath(tt,$,k);var st=[];for(_=tt.length-2;_>=1;){for(this.smoothAngle($[2*_-1],tt[_],$[2*_],k.h[tt[_].__id__],st);0!=st.length;){var at=2*_;$.splice(at,0);var ot=st.pop();$.splice(at,0,ot)}--_}}else $=B;for(var ht=0,ut=$.length;ht<ut;){var lt=ht++;a.push($[lt].x),a.push($[lt].y)}},adjustWithTangents:function(t,e,i,n,r,s,a,o){var h=[],u=r.h[t.__id__],l=r.h[i.__id__],c=null,g=null;if(e||n)if(e)if(n)if(1==u&&1==l)R.tangentsParalCircleToCircle(this._radius,t.x,t.y,i.x,i.y,h),c=this.getPoint(h[2],h[3]),g=this.getPoint(h[4],h[5]);else if(-1==u&&-1==l)R.tangentsParalCircleToCircle(this._radius,t.x,t.y,i.x,i.y,h),c=this.getPoint(h[0],h[1]),g=this.getPoint(h[6],h[7]);else if(1==u&&-1==l){if(!R.tangentsCrossCircleToCircle(this._radius,t.x,t.y,i.x,i.y,h))return;c=this.getPoint(h[2],h[3]),g=this.getPoint(h[6],h[7])}else{if(!R.tangentsCrossCircleToCircle(this._radius,t.x,t.y,i.x,i.y,h))return;c=this.getPoint(h[0],h[1]),g=this.getPoint(h[4],h[5])}else{if(!R.tangentsPointToCircle(i.x,i.y,t.x,t.y,this._radius,h))return;h.length>0&&(1==u?(c=this.getPoint(h[0],h[1]),g=i):(c=this.getPoint(h[2],h[3]),g=i))}else{if(!R.tangentsPointToCircle(t.x,t.y,i.x,i.y,this._radius,h))return;1==l?(c=t,g=this.getPoint(h[2],h[3])):(c=t,g=this.getPoint(h[0],h[1]))}else c=t,g=i;for(var d=s.h[t.__id__];d!=i;){if(R.distanceSquaredPointToSegment(d.x,d.y,c.x,c.y,g.x,g.y)<this._radiusSquared)return this.adjustWithTangents(t,e,d,!0,r,s,a,o),void this.adjustWithTangents(d,!0,i,n,r,s,a,o);d=s.h[d.__id__]}o.push(c),o.push(g),a.push(t)},checkAdjustedPath:function(t,e,i){for(var n,r,s,a,o,h,u,l,c,g=!0,d=[],f=null,p=null;g;){g=!1;for(var _=2;_<t.length;){if(o=t[_],h=i.h[o.__id__],s=t[_-1],a=i.h[s.__id__],n=t[_-2],r=i.h[n.__id__],a==h&&(u=e[2*(_-2)],l=e[2*(_-1)-1],c=e[2*(_-1)],(u.x-l.x)*(c.x-l.x)+(u.y-l.y)*(c.y-l.y)>0)){2==_?(R.tangentsPointToCircle(n.x,n.y,o.x,o.y,this._radius,d),1==h?(f=n,p=this.getPoint(d[2],d[3])):(f=n,p=this.getPoint(d[0],d[1]))):_==t.length-1?(R.tangentsPointToCircle(o.x,o.y,n.x,n.y,this._radius,d),1==r?(f=this.getPoint(d[0],d[1]),p=o):(f=this.getPoint(d[2],d[3]),p=o)):1==r&&-1==h?(R.tangentsCrossCircleToCircle(this._radius,n.x,n.y,o.x,o.y,d),f=this.getPoint(d[2],d[3]),p=this.getPoint(d[6],d[7])):-1==r&&1==h?(R.tangentsCrossCircleToCircle(this._radius,n.x,n.y,o.x,o.y,d),f=this.getPoint(d[0],d[1]),p=this.getPoint(d[4],d[5])):1==r&&1==h?(R.tangentsParalCircleToCircle(this._radius,n.x,n.y,o.x,o.y,d),f=this.getPoint(d[2],d[3]),p=this.getPoint(d[4],d[5])):-1==r&&-1==h&&(R.tangentsParalCircleToCircle(this._radius,n.x,n.y,o.x,o.y,d),f=this.getPoint(d[0],d[1]),p=this.getPoint(d[6],d[7]));var v=2*(_-2);e.splice(v,1),e.splice(v,0,f),v=2*_-1,e.splice(v,1),e.splice(v,0,p),t.splice(_-1,1),e.splice(2*(_-1)-1,2),d.splice(0,d.length),--_}++_}}},smoothAngle:function(t,e,i,n,r){var s=R.getDirection(t.x,t.y,e.x,e.y,i.x,i.y);if(!((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)<=this._sampleCircleDistanceSquared)){for(var a,o,h,u,l,c=0,g=0,d=this._numSamplesCircle;g<d;){var f=g++;if(h=!1,u=e.x+this._sampleCircle[f].x,l=e.y+this._sampleCircle[f].y,a=R.getDirection(t.x,t.y,e.x,e.y,u,l),o=R.getDirection(e.x,e.y,i.x,i.y,u,l),1==n?-1==s?-1==a&&-1==o&&(h=!0):-1!=a&&-1!=o||(h=!0):1==s?1==a&&1==o&&(h=!0):1!=a&&1!=o||(h=!0),h){r.splice(c,0);var p=new D(u,l);r.splice(c,0,p),++c}else c=0}-1==n&&r.reverse()}},__class__:d};var f=t.hxDaedalus.ai.PathFinder=function(){this.astar=new c,this.funnel=new d,this.listFaces=[],this.listEdges=[]};f.__name__=!0,f.prototype={dispose:function(){this._mesh=null,this.astar.dispose(),this.astar=null,this.funnel.dispose(),this.funnel=null,this.listEdges=null,this.listFaces=null},get_mesh:function(){return this._mesh},set_mesh:function(t){return this._mesh=t,this.astar.set_mesh(this._mesh),t},findPath:function(t,e,i){i.splice(0,i.length);this._mesh,this.entity;R.isCircleIntersectingAnyConstraint(t,e,this.entity.get_radius(),this._mesh)||(this.astar.set_radius(this.entity.get_radius()),this.funnel.set_radius(this.entity.get_radius()),this.listFaces.splice(0,this.listFaces.length),this.listEdges.splice(0,this.listEdges.length),this.astar.findPath(this.entity.x,this.entity.y,t,e,this.listFaces,this.listEdges),0!=this.listFaces.length&&this.funnel.findPath(this.entity.x,this.entity.y,t,e,this.listFaces,this.listEdges,i))},__class__:f};var p=t.hxDaedalus.ai.trajectory.LinearPathSampler=function(){this._samplingDistanceSquared=1,this._samplingDistance=1,this._preCompX=[],this._preCompY=[]};p.__name__=!0,p.pythag=function(t,e){return Math.sqrt(t*t+e*e)},p.prototype={dispose:function(){this.entity=null,this._path=null,this._preCompX=null,this._preCompY=null},get_x:function(){return this._currentX},get_y:function(){return this._currentY},get_hasPrev:function(){return this._hasPrev},get_hasNext:function(){return this._hasNext},get_count:function(){return this._count},set_count:function(t){return this._count=t,this._count<0&&(this._count=0),this._count>this.get_countMax()-1&&(this._count=this.get_countMax()-1),this._hasPrev=0!=this._count,this._hasNext=this._count!=this.get_countMax()-1,this._currentX=this._preCompX[this._count],this._currentY=this._preCompY[this._count],this.updateEntity(),this._count},get_countMax:function(){return this._preCompX.length-1},get_samplingDistance:function(){return this._samplingDistance},set_samplingDistance:function(t){return this._samplingDistance=t,this._samplingDistanceSquared=this._samplingDistance*this._samplingDistance,t},set_path:function(t){return this._path=t,this._preComputed=!1,this.reset(),t},reset:function(){if(this._path.length>0){this._path.length;this._currentX=this._path[0],this._currentY=this._path[1],this._iPrev=0,this._iNext=2,this._hasPrev=!1,this._hasNext=!0,this._count=0,this.updateEntity()}else this._hasPrev=!1,this._hasNext=!1,this._count=0},preCompute:function(){for(this._preCompX.splice(0,this._preCompX.length),this._preCompY.splice(0,this._preCompY.length),this._count=0,this._preCompX.push(this._currentX),this._preCompY.push(this._currentY),this._preComputed=!1;this.next();)this._preCompX.push(this._currentX),this._preCompY.push(this._currentY);this.reset(),this._preComputed=!0},prev:function(){if(!this._hasPrev)return!1;if(this._hasNext=!0,this._preComputed)return this._count--,0==this._count&&(this._hasPrev=!1),this._currentX=this._preCompX[this._count],this._currentY=this._preCompY[this._count],this.updateEntity(),!0;for(var t=this._samplingDistance,e=0;;){var i=this._path[this._iPrev],n=this._path[this._iPrev+1],r=this._currentX-i,s=this._currentY-n;if(!((e=Math.sqrt(r*r+s*s))<t))break;if(t-=e,this._iPrev-=2,this._iNext-=2,0==this._iNext)break}return 0==this._iNext?(this._currentX=this._path[0],this._currentY=this._path[1],this._hasPrev=!1,this._iNext=2,this._iPrev=0,this.updateEntity(),!0):(this._currentX+=(this._path[this._iPrev]-this._currentX)*t/e,this._currentY+=(this._path[this._iPrev+1]-this._currentY)*t/e,this.updateEntity(),!0)},next:function(){if(!this._hasNext)return!1;if(this._hasPrev=!0,this._preComputed)return this._count++,this._count==this._preCompX.length-1&&(this._hasNext=!1),this._currentX=this._preCompX[this._count],this._currentY=this._preCompY[this._count],this.updateEntity(),!0;for(var t=this._samplingDistance,e=0;;){var i=this._path[this._iNext],n=this._path[this._iNext+1],r=this._currentX-i,s=this._currentY-n;if(!((e=Math.sqrt(r*r+s*s))<t))break;if(t-=e,this._currentX=this._path[this._iNext],this._currentY=this._path[this._iNext+1],this._iPrev+=2,this._iNext+=2,this._iNext==this._path.length)break}return this._iNext==this._path.length?(this._currentX=this._path[this._iPrev],this._currentY=this._path[this._iPrev+1],this._hasNext=!1,this._iNext=this._path.length-2,this._iPrev=this._iNext-2,this.updateEntity(),!0):(this._currentX+=(this._path[this._iNext]-this._currentX)*t/e,this._currentY+=(this._path[this._iNext+1]-this._currentY)*t/e,this.updateEntity(),!0)},updateEntity:function(){if(null!=this.entity){isNaN(this._currentX)&&isNaN(this._currentY);this.entity.x=this._currentX,this.entity.y=this._currentY}},__class__:p};var _=t.hxDaedalus.ai.trajectory.PathIterator=function(){};_.__name__=!0,_.prototype={get_entity:function(){return this._entity},set_entity:function(t){return this._entity=t,t},get_x:function(){return this._currentX},get_y:function(){return this._currentY},get_hasPrev:function(){return this._hasPrev},get_hasNext:function(){return this._hasNext},get_count:function(){return this._count},get_countMax:function(){return this._countMax},set_path:function(t){return this._path=t,this._countMax=this._path.length/2|0,this.reset(),t},reset:function(){this._count=0,this._currentX=this._path[this._count],this._currentY=this._path[this._count+1],this.updateEntity(),this._hasPrev=!1,this._hasNext=this._path.length>2},prev:function(){return!!this._hasPrev&&(this._hasNext=!0,this._count--,this._currentX=this._path[2*this._count],this._currentY=this._path[2*this._count+1],this.updateEntity(),0==this._count&&(this._hasPrev=!1),!0)},next:function(){return!!this._hasNext&&(this._hasPrev=!0,this._count++,this._currentX=this._path[2*this._count],this._currentY=this._path[2*this._count+1],this.updateEntity(),2*(this._count+1)==this._path.length&&(this._hasNext=!1),!0)},updateEntity:function(){null!=this._entity&&(this._entity.x=this._currentX,this._entity.y=this._currentY)},__class__:_};var v=t.hxDaedalus.data.Constants=function(){};v.__name__=!0;var y=t.hxDaedalus.data.ConstraintSegment=function(){this._id=y.INC,y.INC++,this._edges=[]};y.__name__=!0,y.prototype={get_id:function(){return this._id},addEdge:function(t){-1==this._edges.indexOf(t)&&-1==this._edges.indexOf(t.get_oppositeEdge())&&this._edges.push(t)},removeEdge:function(t){var e=this._edges.indexOf(t);-1==e&&(e=this._edges.indexOf(t.get_oppositeEdge())),-1!=e&&this._edges.splice(e,1)},get_edges:function(){return this._edges},dispose:function(){this._edges=null,this.fromShape=null},toString:function(){return"seg_id "+this._id},__class__:y};var m=t.hxDaedalus.data.ConstraintShape=function(){this._id=m.INC,m.INC++,this.segments=[]};m.__name__=!0,m.prototype={get_id:function(){return this._id},dispose:function(){for(;this.segments.length>0;)this.segments.pop().dispose();this.segments=null},__class__:m};var x=t.hxDaedalus.data.Edge=function(){this.colorDebug=-1,this._id=x.INC,x.INC++,this.fromConstraintSegments=[]};x.__name__=!0,x.prototype={get_id:function(){return this._id},get_isReal:function(){return this._isReal},get_isConstrained:function(){return this._isConstrained},setDatas:function(t,e,i,n,r,s){null==s&&(s=!1),null==r&&(r=!0),this._isConstrained=s,this._isReal=r,this._originVertex=t,this._oppositeEdge=e,this._nextLeftEdge=i,this._leftFace=n},addFromConstraintSegment:function(t){-1==this.fromConstraintSegments.indexOf(t)&&this.fromConstraintSegments.push(t)},removeFromConstraintSegment:function(t){var e=this.fromConstraintSegments.indexOf(t);-1!=e&&this.fromConstraintSegments.splice(e,1)},set_originVertex:function(t){return this._originVertex=t,t},set_nextLeftEdge:function(t){return this._nextLeftEdge=t,t},set_leftFace:function(t){return this._leftFace=t,t},set_isConstrained:function(t){return this._isConstrained=t,t},dispose:function(){this._originVertex=null,this._oppositeEdge=null,this._nextLeftEdge=null,this._leftFace=null,this.fromConstraintSegments=null},get_originVertex:function(){return this._originVertex},get_destinationVertex:function(){return this.get_oppositeEdge().get_originVertex()},get_oppositeEdge:function(){return this._oppositeEdge},get_nextLeftEdge:function(){return this._nextLeftEdge},get_prevLeftEdge:function(){return this._nextLeftEdge.get_nextLeftEdge()},get_nextRightEdge:function(){return this._oppositeEdge.get_nextLeftEdge().get_nextLeftEdge().get_oppositeEdge()},get_prevRightEdge:function(){return this._oppositeEdge.get_nextLeftEdge().get_oppositeEdge()},get_rotLeftEdge:function(){return this._nextLeftEdge.get_nextLeftEdge().get_oppositeEdge()},get_rotRightEdge:function(){return this._oppositeEdge.get_nextLeftEdge()},get_leftFace:function(){return this._leftFace},get_rightFace:function(){return this._oppositeEdge.get_leftFace()},toString:function(){return"edge "+this.get_originVertex().get_id()+" - "+this.get_destinationVertex().get_id()},__class__:x};var M=t.hxDaedalus.data.Face=function(){this.colorDebug=-1,this._id=M.INC,M.INC++};M.__name__=!0,M.prototype={get_id:function(){return this._id},get_isReal:function(){return this._isReal},set_datas:function(t){this._isReal=!0,this._edge=t},setDatas:function(t,e){null==e&&(e=!0),this._isReal=e,this._edge=t},dispose:function(){this._edge=null},get_edge:function(){return this._edge},__class__:M};var w=t.hxDaedalus.data.Mesh=function(t,e){this.__objectsUpdateInProgress=!1,this.__edgesToCheck=null,this.__centerVertex=null,this._objects=null,this._constraintShapes=null,this._faces=null,this._edges=null,this._vertices=null,this._clipping=!1,this._height=0,this._width=0,this._id=w.INC,w.INC++,this._width=t,this._height=e,this._clipping=!0,this._vertices=[],this._edges=[],this._faces=[],this._constraintShapes=[],this._objects=[],this.__edgesToCheck=[]};w.__name__=!0,w.prototype={get_height:function(){return this._height},get_width:function(){return this._width},get_clipping:function(){return this._clipping},set_clipping:function(t){return this._clipping=t,t},get_id:function(){return this._id},dispose:function(){for(;this._vertices.length>0;)this._vertices.pop().dispose();for(this._vertices=null;this._edges.length>0;)this._edges.pop().dispose();for(this._edges=null;this._faces.length>0;)this._faces.pop().dispose();for(this._faces=null;this._constraintShapes.length>0;)this._constraintShapes.pop().dispose();for(this._constraintShapes=null;this._objects.length>0;)this._objects.pop().dispose();this._objects=null,this.__edgesToCheck=null,this.__centerVertex=null},get___constraintShapes:function(){return this._constraintShapes},buildFromRecord:function(t){for(var e=t.split(";"),i=0;i<e.length;)this.insertConstraintSegment(parseFloat(e[i]),parseFloat(e[i+1]),parseFloat(e[i+2]),parseFloat(e[i+3])),i+=4},insertObject:function(t){null!=t.get_constraintShape()&&this.deleteObject(t);var e,i,n,r,s,a,o,h,u,l=new m,c=t.get_coordinates(),g=t.get_matrix();t.updateMatrixFromValues();for(var d=0;d<c.length;)i=c[d],n=c[d+1],r=c[d+2],s=c[d+3],a=g.transformX(i,n),o=g.transformY(i,n),h=g.transformX(r,s),u=g.transformY(r,s),null!=(e=this.insertConstraintSegment(a,o,h,u))&&(e.fromShape=l,l.segments.push(e)),d+=4;this._constraintShapes.push(l),t.set_constraintShape(l),this.__objectsUpdateInProgress||this._objects.push(t)},deleteObject:function(t){if(null!=t.get_constraintShape()&&(this.deleteConstraintShape(t.get_constraintShape()),t.set_constraintShape(null),!this.__objectsUpdateInProgress)){var e=this._objects.indexOf(t);this._objects.splice(e,1)}},updateObjects:function(){this.__objectsUpdateInProgress=!0;for(var t=0,e=this._objects.length;t<e;){var i=t++;this._objects[i].get_hasChanged()&&(this.deleteObject(this._objects[i]),this.insertObject(this._objects[i]),this._objects[i].set_hasChanged(!1))}this.__objectsUpdateInProgress=!1},insertConstraintShape:function(t){for(var e=new m,i=null,n=0;n<t.length;)null!=(i=this.insertConstraintSegment(t[n],t[n+1],t[n+2],t[n+3]))&&(i.fromShape=e,e.segments.push(i)),n+=4;return this._constraintShapes.push(e),e},deleteConstraintShape:function(t){for(var e=0,i=t.segments.length;e<i;){var n=e++;this.deleteConstraintSegment(t.segments[n])}t.dispose(),this._constraintShapes.splice(this._constraintShapes.indexOf(t),1)},insertConstraintSegment:function(t,e,i,n){var r=this.findPositionFromBounds(t,e),s=this.findPositionFromBounds(i,n),a=t,o=e,h=i,u=n;if(this._clipping&&(0!=r||0!=s)){var l=new D;if(0!=r&&0!=s){if(t<=0&&i<=0||t>=this._width&&i>=this._width||e<=0&&n<=0||e>=this._height&&n>=this._height)return null;if(8==r&&4==s||4==r&&8==s)R.intersections2segments(t,e,i,n,0,0,0,this._height,l),a=l.x,o=l.y,R.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l),h=l.x,u=l.y;else if(2==r&&6==s||6==r&&2==s)R.intersections2segments(t,e,i,n,0,0,this._width,0,l),a=l.x,o=l.y,R.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l),h=l.x,u=l.y;else if(2==r&&8==s||8==r&&2==s){if(!R.intersections2segments(t,e,i,n,0,0,this._width,0,l))return null;a=l.x,o=l.y,R.intersections2segments(t,e,i,n,0,0,0,this._height,l),h=l.x,u=l.y}else if(2==r&&4==s||4==r&&2==s){if(!R.intersections2segments(t,e,i,n,0,0,this._width,0,l))return null;a=l.x,o=l.y,R.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l),h=l.x,u=l.y}else if(6==r&&4==s||4==r&&6==s){if(!R.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l))return null;a=l.x,o=l.y,R.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l),h=l.x,u=l.y}else if(8==r&&6==s||6==r&&8==s){if(!R.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l))return null;a=l.x,o=l.y,R.intersections2segments(t,e,i,n,0,0,0,this._height,l),h=l.x,u=l.y}else{var c=!1,g=!1;if(R.intersections2segments(t,e,i,n,0,0,this._width,0,l)&&(a=l.x,o=l.y,c=!0),R.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l)&&(c?(h=l.x,u=l.y,g=!0):(a=l.x,o=l.y,c=!0)),!g&&R.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l)&&(c?(h=l.x,u=l.y,g=!0):(a=l.x,o=l.y,c=!0)),!g&&R.intersections2segments(t,e,i,n,0,0,0,this._height,l)&&(h=l.x,u=l.y),!c)return null}}else 2==r||2==s?R.intersections2segments(t,e,i,n,0,0,this._width,0,l):4==r||4==s?R.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l):6==r||6==s?R.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l):8==r||8==s?R.intersections2segments(t,e,i,n,0,0,0,this._height,l):R.intersections2segments(t,e,i,n,0,0,this._width,0,l)||R.intersections2segments(t,e,i,n,this._width,0,this._width,this._height,l)||R.intersections2segments(t,e,i,n,0,this._height,this._width,this._height,l)||R.intersections2segments(t,e,i,n,0,0,0,this._height,l),0==r?(a=t,o=e):(a=i,o=n),h=l.x,u=l.y}var d=this.insertVertex(a,o);if(null==d)return null;var f=this.insertVertex(h,u);if(null==f)return null;if(d==f)return null;var p,_,v=new J,m=new y,M=new x,w=new x;M.setDatas(d,w,null,null,!0,!0),w.setDatas(f,M,null,null,!0,!0);var b,E,S,C,k,P=[],T=[],L=[],A=new D;for(p=d,b=I.EVertex(p);;)switch(k=!1,b[1]){case 0:for(p=b[2],v.set_fromVertex(p);null!=(_=v.next());){if(_.get_destinationVertex()==f)return _.get_isConstrained()||(_.set_isConstrained(!0),_.get_oppositeEdge().set_isConstrained(!0)),_.addFromConstraintSegment(m),_.get_oppositeEdge().fromConstraintSegments=_.fromConstraintSegments,d.addFromConstraintSegment(m),f.addFromConstraintSegment(m),m.addEdge(_),m;if(R.distanceSquaredVertexToEdge(_.get_destinationVertex(),M)<=1e-4){_.get_isConstrained()||(_.set_isConstrained(!0),_.get_oppositeEdge().set_isConstrained(!0)),_.addFromConstraintSegment(m),_.get_oppositeEdge().fromConstraintSegments=_.fromConstraintSegments,d.addFromConstraintSegment(m),m.addEdge(_),d=_.get_destinationVertex(),M.set_originVertex(d),b=I.EVertex(d),k=!0;break}}if(k)continue;for(v.set_fromVertex(p);null!=(_=v.next());)if(_=_.get_nextLeftEdge(),R.intersections2edges(_,M,A)){if(_.get_isConstrained()){for(d=this.splitEdge(_,A.x,A.y),v.set_fromVertex(p);null!=(_=v.next());)if(_.get_destinationVertex()==d){_.set_isConstrained(!0),_.get_oppositeEdge().set_isConstrained(!0),_.addFromConstraintSegment(m),_.get_oppositeEdge().fromConstraintSegments=_.fromConstraintSegments,m.addEdge(_);break}p.addFromConstraintSegment(m),M.set_originVertex(d),b=I.EVertex(d)}else P.push(_),T.unshift(_.get_nextLeftEdge()),L.push(_.get_prevLeftEdge()),_=_.get_oppositeEdge(),b=I.EEdge(_);break}break;case 1:if((E=(_=b[2]).get_nextLeftEdge()).get_destinationVertex()==f)return T.unshift(E.get_nextLeftEdge()),L.push(E),S=new x,C=new x,S.setDatas(d,C,null,null,!0,!0),C.setDatas(f,S,null,null,!0,!0),T.push(S),L.push(C),this.insertNewConstrainedEdge(m,S,P,T,L),m;if(R.distanceSquaredVertexToEdge(E.get_destinationVertex(),M)<=1e-4)T.unshift(E.get_nextLeftEdge()),L.push(E),S=new x,C=new x,S.setDatas(d,C,null,null,!0,!0),C.setDatas(E.get_destinationVertex(),S,null,null,!0,!0),T.push(S),L.push(C),this.insertNewConstrainedEdge(m,S,P,T,L),P.splice(0,P.length),T.splice(0,T.length),L.splice(0,L.length),d=E.get_destinationVertex(),M.set_originVertex(d),b=I.EVertex(d);else if(R.intersections2edges(E,M,A))if(E.get_isConstrained()){for(p=this.splitEdge(E,A.x,A.y),v.set_fromVertex(p);null!=(_=v.next());)_.get_destinationVertex()==T[0].get_originVertex()&&T.unshift(_),_.get_destinationVertex()==L[L.length-1].get_destinationVertex()&&L.push(_.get_oppositeEdge());S=new x,C=new x,S.setDatas(d,C,null,null,!0,!0),C.setDatas(p,S,null,null,!0,!0),T.push(S),L.push(C),this.insertNewConstrainedEdge(m,S,P,T,L),P.splice(0,P.length),T.splice(0,T.length),L.splice(0,L.length),d=p,M.set_originVertex(d),b=I.EVertex(d)}else P.push(E),T.unshift(E.get_nextLeftEdge()),_=E.get_oppositeEdge(),b=I.EEdge(_);else if(E=E.get_nextLeftEdge(),R.intersections2edges(E,M,A),E.get_isConstrained()){for(p=this.splitEdge(E,A.x,A.y),v.set_fromVertex(p);null!=(_=v.next());)_.get_destinationVertex()==T[0].get_originVertex()&&T.unshift(_),_.get_destinationVertex()==L[L.length-1].get_destinationVertex()&&L.push(_.get_oppositeEdge());S=new x,C=new x,S.setDatas(d,C,null,null,!0,!0),C.setDatas(p,S,null,null,!0,!0),T.push(S),L.push(C),this.insertNewConstrainedEdge(m,S,P,T,L),P.splice(0,P.length),T.splice(0,T.length),L.splice(0,L.length),d=p,M.set_originVertex(d),b=I.EVertex(d)}else P.push(E),L.push(E.get_prevLeftEdge()),_=E.get_oppositeEdge(),b=I.EEdge(_);break;case 2:b[2]}},insertNewConstrainedEdge:function(t,e,i,n,r){this._edges.push(e),this._edges.push(e.get_oppositeEdge()),e.addFromConstraintSegment(t),e.get_oppositeEdge().fromConstraintSegments=e.fromConstraintSegments,t.addEdge(e),e.get_originVertex().addFromConstraintSegment(t),e.get_destinationVertex().addFromConstraintSegment(t),this.untriangulate(i),this.triangulate(n,!0),this.triangulate(r,!0)},deleteConstraintSegment:function(t){for(var e,i=[],n=null,r=0,s=t.get_edges().length;r<s;){var a=r++;(n=t.get_edges()[a]).removeFromConstraintSegment(t),0==n.fromConstraintSegments.length&&(n.set_isConstrained(!1),n.get_oppositeEdge().set_isConstrained(!1)),(e=n.get_originVertex()).removeFromConstraintSegment(t),i.push(e)}(e=n.get_destinationVertex()).removeFromConstraintSegment(t),i.push(e);for(var o=0,h=i.length;o<h;){var u=o++;this.deleteVertex(i[u])}t.dispose()},check:function(){for(var t=0,e=this._edges.length;t<e;){var i=t++;if(null==this._edges[i].get_nextLeftEdge())return}},insertVertex:function(t,e){if(t<0||e<0||t>this._width||e>this._height)return null;this.__edgesToCheck.splice(0,this.__edgesToCheck.length);var i=R.locatePosition(t,e,this),n=null;switch(i[1]){case 0:n=i[2];break;case 1:var r=i[2];n=this.splitEdge(r,t,e);break;case 2:var s=i[2];n=this.splitFace(s,t,e)}return this.restoreAsDelaunay(),n},flipEdge:function(t){var e=t,i=t.get_oppositeEdge(),n=new x,r=new x,s=e.get_nextLeftEdge(),a=s.get_nextLeftEdge(),o=i.get_nextLeftEdge(),h=o.get_nextLeftEdge(),u=e.get_originVertex(),l=i.get_originVertex(),c=a.get_originVertex(),g=h.get_originVertex(),d=e.get_leftFace(),f=i.get_leftFace(),p=new M,_=new M;return this._edges.push(n),this._edges.push(r),this._faces.push(_),this._faces.push(p),n.setDatas(c,r,h,_,t.get_isReal(),t.get_isConstrained()),r.setDatas(g,n,a,p,t.get_isReal(),t.get_isConstrained()),_.setDatas(n),p.setDatas(r),l.get_edge()==i&&l.setDatas(s),u.get_edge()==e&&u.setDatas(o),s.set_nextLeftEdge(n),s.set_leftFace(_),a.set_nextLeftEdge(o),a.set_leftFace(p),o.set_nextLeftEdge(r),o.set_leftFace(p),h.set_nextLeftEdge(s),h.set_leftFace(_),e.dispose(),i.dispose(),this._edges.splice(this._edges.indexOf(e),1),this._edges.splice(this._edges.indexOf(i),1),d.dispose(),f.dispose(),this._faces.splice(this._faces.indexOf(d),1),this._faces.splice(this._faces.indexOf(f),1),r},splitEdge:function(t,e,i){this.__edgesToCheck.splice(0,this.__edgesToCheck.length);var n=t,r=n.get_oppositeEdge(),s=n.get_nextLeftEdge(),a=s.get_nextLeftEdge(),o=r.get_nextLeftEdge(),h=o.get_nextLeftEdge(),u=a.get_originVertex(),l=n.get_originVertex(),c=h.get_originVertex(),g=r.get_originVertex(),d=n.get_leftFace(),f=r.get_leftFace();if((l.get_pos().x-e)*(l.get_pos().x-e)+(l.get_pos().y-i)*(l.get_pos().y-i)<=1e-4)return l;if((g.get_pos().x-e)*(g.get_pos().x-e)+(g.get_pos().y-i)*(g.get_pos().y-i)<=1e-4)return g;var p=new E,_=new x,v=new x,y=new x,m=new x,w=new x,b=new x,S=new x,C=new x,k=new M,P=new M,I=new M,D=new M;if(this._vertices.push(p),this._edges.push(v),this._edges.push(_),this._edges.push(b),this._edges.push(w),this._edges.push(m),this._edges.push(y),this._edges.push(C),this._edges.push(S),this._faces.push(D),this._faces.push(I),this._faces.push(P),this._faces.push(k),p.setDatas(d.get_isReal()?v:m),p.get_pos().x=e,p.get_pos().y=i,R.projectOrthogonaly(p.get_pos(),n),v.setDatas(p,_,a,k,d.get_isReal()),_.setDatas(u,v,C,D,d.get_isReal()),b.setDatas(p,w,o,P,t.get_isReal(),t.get_isConstrained()),w.setDatas(l,b,v,k,t.get_isReal(),t.get_isConstrained()),m.setDatas(p,y,h,I,f.get_isReal()),y.setDatas(c,m,b,P,f.get_isReal()),C.setDatas(p,S,s,D,t.get_isReal(),t.get_isConstrained()),S.setDatas(g,C,m,I,t.get_isReal(),t.get_isConstrained()),k.setDatas(v,d.get_isReal()),P.setDatas(b,f.get_isReal()),I.setDatas(m,f.get_isReal()),D.setDatas(C,d.get_isReal()),l.get_edge()==n&&l.setDatas(w),g.get_edge()==r&&g.setDatas(S),a.set_nextLeftEdge(w),a.set_leftFace(k),o.set_nextLeftEdge(y),o.set_leftFace(P),h.set_nextLeftEdge(S),h.set_leftFace(I),s.set_nextLeftEdge(_),s.set_leftFace(D),n.get_isConstrained()){var T,L,A=n.fromConstraintSegments;w.fromConstraintSegments=A.slice(0),b.fromConstraintSegments=w.fromConstraintSegments,C.fromConstraintSegments=A.slice(0),S.fromConstraintSegments=C.fromConstraintSegments;for(var V=0,O=n.fromConstraintSegments.length;V<O;){var F=V++;-1!=(L=(T=n.fromConstraintSegments[F].get_edges()).indexOf(n))?(T.splice(L,1),T.splice(L,0,w),T.splice(L+1,0,C)):(L=T.indexOf(r),T.splice(L,1),T.splice(L,0,S),T.splice(L+1,0,b))}p.set_fromConstraintSegments(A.slice(0))}return n.dispose(),r.dispose(),this._edges.splice(this._edges.indexOf(n),1),this._edges.splice(this._edges.indexOf(r),1),d.dispose(),f.dispose(),this._faces.splice(this._faces.indexOf(d),1),this._faces.splice(this._faces.indexOf(f),1),this.__centerVertex=p,this.__edgesToCheck.push(a),this.__edgesToCheck.push(o),this.__edgesToCheck.push(h),this.__edgesToCheck.push(s),p},splitFace:function(t,e,i){this.__edgesToCheck.splice(0,this.__edgesToCheck.length);var n=t.get_edge(),r=n.get_nextLeftEdge(),s=r.get_nextLeftEdge(),a=n.get_originVertex(),o=r.get_originVertex(),h=s.get_originVertex(),u=new E,l=new x,c=new x,g=new x,d=new x,f=new x,p=new x,_=new M,v=new M,y=new M;return this._vertices.push(u),this._edges.push(l),this._edges.push(c),this._edges.push(g),this._edges.push(d),this._edges.push(f),this._edges.push(p),this._faces.push(_),this._faces.push(v),this._faces.push(y),u.setDatas(c),u.get_pos().x=e,u.get_pos().y=i,l.setDatas(a,c,p,y),c.setDatas(u,l,n,_),g.setDatas(o,d,c,_),d.setDatas(u,g,r,v),f.setDatas(h,p,d,v),p.setDatas(u,f,s,y),_.setDatas(c),v.setDatas(d),y.setDatas(p),n.set_nextLeftEdge(g),n.set_leftFace(_),r.set_nextLeftEdge(f),r.set_leftFace(v),s.set_nextLeftEdge(l),s.set_leftFace(y),t.dispose(),this._faces.splice(this._faces.indexOf(t),1),this.__centerVertex=u,this.__edgesToCheck.push(n),this.__edgesToCheck.push(r),this.__edgesToCheck.push(s),u},restoreAsDelaunay:function(){for(var t;this.__edgesToCheck.length>0;)!(t=this.__edgesToCheck.shift()).get_isReal()||t.get_isConstrained()||R.isDelaunay(t)||(t.get_nextLeftEdge().get_destinationVertex()==this.__centerVertex?(this.__edgesToCheck.push(t.get_nextRightEdge()),this.__edgesToCheck.push(t.get_prevRightEdge())):(this.__edgesToCheck.push(t.get_nextLeftEdge()),this.__edgesToCheck.push(t.get_prevLeftEdge())),this.flipEdge(t))},deleteVertex:function(t){var e,i,n=new J;n.set_fromVertex(t),n.realEdgesOnly=!1;var r,s=[],a=[],o=!1,h=!1,u=[],l=[];if(e=0==t.get_fromConstraintSegments().length)for(;null!=(i=n.next());)s.push(i),a.push(i.get_nextLeftEdge());else{for(var c,g=0,d=t.get_fromConstraintSegments().length;g<d;){var f=g++;if((c=t.get_fromConstraintSegments()[f].get_edges())[0].get_originVertex()==t||c[c.length-1].get_destinationVertex()==t)return!1}for(var p=0;null!=(i=n.next());)if(s.push(i),i.get_isConstrained()&&++p>2)return!1;u=[],l=[];var _=null,v=null,y=new x,m=new x;this._edges.push(y),this._edges.push(m);for(var M,w=0,b=s.length;w<b;){(i=s[w++]).get_isConstrained()?null==_?(m.setDatas(i.get_destinationVertex(),y,null,null,!0,!0),u.push(y),u.push(i.get_nextLeftEdge()),l.push(m),_=i):null==v&&(y.setDatas(i.get_destinationVertex(),m,null,null,!0,!0),l.push(i.get_nextLeftEdge()),v=i):null==_?l.push(i.get_nextLeftEdge()):null==v?u.push(i.get_nextLeftEdge()):l.push(i.get_nextLeftEdge())}o=_.get_leftFace().get_isReal(),h=v.get_leftFace().get_isReal(),y.fromConstraintSegments=_.fromConstraintSegments.slice(0),m.fromConstraintSegments=y.fromConstraintSegments;for(var E=0,S=t.get_fromConstraintSegments().length;E<S;){var C=E++;if(-1!=(M=(c=t.get_fromConstraintSegments()[C].get_edges()).indexOf(_)))c.splice(M-1,2),c.splice(M-1,0,y);else{var k=c.indexOf(v)-1;c.splice(k,2),c.splice(k,0,m)}}}for(var P=0,I=s.length;P<I;){r=(i=s[P++]).get_leftFace(),this._faces.splice(this._faces.indexOf(r),1),r.dispose(),i.get_destinationVertex().set_edge(i.get_nextLeftEdge()),this._edges.splice(this._edges.indexOf(i.get_oppositeEdge()),1),i.get_oppositeEdge().dispose(),this._edges.splice(this._edges.indexOf(i),1),i.dispose()}return this._vertices.splice(this._vertices.indexOf(t),1),t.dispose(),e?this.triangulate(a,!0):(this.triangulate(u,o),this.triangulate(l,h)),!0},untriangulate:function(t){for(var e,i=new o,n=0,r=t.length;n<r;){var s=n++,a=(e=t[s]).get_originVertex();null==i.h[a.__id__]&&(e.get_originVertex().set_edge(e.get_prevLeftEdge().get_oppositeEdge()),i.set(e.get_originVertex(),!0));var h=e.get_destinationVertex();null==i.h[h.__id__]&&(e.get_destinationVertex().set_edge(e.get_nextLeftEdge()),i.set(e.get_destinationVertex(),!0)),this._faces.splice(this._faces.indexOf(e.get_leftFace()),1),e.get_leftFace().dispose(),s==t.length-1&&(this._faces.splice(this._faces.indexOf(e.get_rightFace()),1),e.get_rightFace().dispose())}for(var u=0,l=t.length;u<l;){e=t[u++],this._edges.splice(this._edges.indexOf(e.get_oppositeEdge()),1),this._edges.splice(this._edges.indexOf(e),1),e.get_oppositeEdge().dispose(),e.dispose()}},triangulate:function(t,e){if(!(t.length<2))if(2!=t.length)if(3==t.length){var i=new M;i.setDatas(t[0],e),this._faces.push(i),t[0].set_leftFace(i),t[1].set_leftFace(i),t[2].set_leftFace(i),t[0].set_nextLeftEdge(t[1]),t[1].set_nextLeftEdge(t[2]),t[2].set_nextLeftEdge(t[0])}else{for(var n,r,s,a=t[0],o=a.get_originVertex(),h=a.get_destinationVertex(),u=new D,l=!1,c=0,g=2,d=t.length;g<d;){var f=g++;if(n=t[f].get_originVertex(),1==R.getRelativePosition2(n.get_pos().x,n.get_pos().y,a)){c=f,l=!0,R.getCircumcenter(o.get_pos().x,o.get_pos().y,h.get_pos().x,h.get_pos().y,n.get_pos().x,n.get_pos().y,u),s=(o.get_pos().x-u.x)*(o.get_pos().x-u.x)+(o.get_pos().y-u.y)*(o.get_pos().y-u.y),s-=1e-4;for(var p=2,_=t.length;p<_;){var v=p++;if(v!=f&&((r=t[v].get_originVertex()).get_pos().x-u.x)*(r.get_pos().x-u.x)+(r.get_pos().y-u.y)*(r.get_pos().y-u.y)<s){l=!1;break}}if(l)break}}if(!l){for(var y=0,m=t.length;y<m;){var w=y++;t[w].get_originVertex().get_pos().x+" , ",t[w].get_originVertex().get_pos().y+" , ",t[w].get_destinationVertex().get_pos().x+" , ",t[w].get_destinationVertex().get_pos().y+" , "}c=2}var b,E,S,C,k=null,P=null,I=null;c<t.length-1&&(k=new x,P=new x,this._edges.push(k),this._edges.push(P),k.setDatas(o,P,null,null,e,!1),P.setDatas(t[c].get_originVertex(),k,null,null,e,!1),(E=t.slice(c)).push(k),this.triangulate(E,e)),c>2&&(I=new x,b=new x,this._edges.push(I),this._edges.push(b),I.setDatas(t[1].get_originVertex(),b,null,null,e,!1),b.setDatas(t[c].get_originVertex(),I,null,null,e,!1),(C=t.slice(1,c)).push(b),this.triangulate(C,e)),S=2==c?[a,t[1],P]:c==t.length-1?[a,I,t[c]]:[a,I,P],this.triangulate(S,e)}else t[0].get_originVertex().get_id(),t[0].get_destinationVertex().get_id(),t[1].get_originVertex().get_id(),t[1].get_destinationVertex().get_id()},findPositionFromBounds:function(t,e){return t<=0?e<=0?1:e>=this._height?7:8:t>=this._width?e<=0?3:e>=this._height?5:4:e<=0?2:e>=this._height?6:0},debug:function(){for(var t=0,e=this._vertices.length;t<e;){var i=t++;this._vertices[i].get_id(),this._vertices[i].get_edge().get_id(),r.string(this._vertices[i].get_edge()),r.string(this._vertices[i].get_edge().get_isReal())}for(var n=0,s=this._edges.length;n<s;){var a=n++;r.string(this._edges[a]),this._edges[a].get_id(),r.string(this._edges[a].get_isReal()),r.string(this._edges[a].get_nextLeftEdge()),r.string(this._edges[a].get_oppositeEdge())}},getVerticesAndEdges:function(){var t,e,i={vertices:[],edges:[]},n=new U;n.set_fromMesh(this);for(var r=new Z,s=new o;null!=(t=n.next());)if(s.set(t,!0),!(t.get_pos().x<0||t.get_pos().x>this.get_width()||t.get_pos().y<0||t.get_pos().y>this.get_height()))for(i.vertices.push(t),r.set_fromVertex(t);null!=(e=r.next());){var a=e.get_originVertex();s.h[a.__id__]||i.edges.push(e)}return i},vertexIsInsideAABB:function(t,e){return!(t.get_pos().x<0||t.get_pos().x>e.get_width()||t.get_pos().y<0||t.get_pos().y>e.get_height())},__class__:w};var b=t.hxDaedalus.data.Object=function(){this._id=b.INC,b.INC++,this._pivotX=0,this._pivotY=0,this._matrix=new T,this._scaleX=1,this._scaleY=1,this._rotation=0,this._x=0,this._y=0,this._coordinates=[],this._hasChanged=!1};b.__name__=!0,b.prototype={get_id:function(){return this._id},dispose:function(){this._matrix=null,this._coordinates=null,this._constraintShape=null},updateValuesFromMatrix:function(){},updateMatrixFromValues:function(){this._matrix.identity(),this._matrix.translate(-this._pivotX,-this._pivotY),this._matrix.scale(this._scaleX,this._scaleY),this._matrix.rotate(this._rotation),this._matrix.translate(this._x,this._y)},get_pivotX:function(){return this._pivotX},set_pivotX:function(t){return this._pivotX=t,this._hasChanged=!0,t},get_pivotY:function(){return this._pivotY},set_pivotY:function(t){return this._pivotY=t,this._hasChanged=!0,t},get_scaleX:function(){return this._scaleX},set_scaleX:function(t){return this._scaleX!=t&&(this._scaleX=t,this._hasChanged=!0),t},get_scaleY:function(){return this._scaleY},set_scaleY:function(t){return this._scaleY!=t&&(this._scaleY=t,this._hasChanged=!0),t},get_rotation:function(){return this._rotation},set_rotation:function(t){return this._rotation!=t&&(this._rotation=t,this._hasChanged=!0),t},get_x:function(){return this._x},set_x:function(t){return this._x!=t&&(this._x=t,this._hasChanged=!0),t},get_y:function(){return this._y},set_y:function(t){return this._y!=t&&(this._y=t,this._hasChanged=!0),t},get_matrix:function(){return this._matrix},set_matrix:function(t){return this._matrix=t,this._hasChanged=!0,t},get_coordinates:function(){return this._coordinates},set_coordinates:function(t){return this._coordinates=t,this._hasChanged=!0,t},get_constraintShape:function(){return this._constraintShape},set_constraintShape:function(t){return this._constraintShape=t,this._hasChanged=!0,t},get_hasChanged:function(){return this._hasChanged},set_hasChanged:function(t){return this._hasChanged=t,t},get_edges:function(){for(var t=[],e=this._constraintShape.segments,i=0,n=e.length;i<n;)for(var r=i++,s=0,a=e[r].get_edges().length;s<a;){var o=s++;t.push(e[r].get_edges()[o])}return t},__class__:b};var E=t.hxDaedalus.data.Vertex=function(){this.colorDebug=-1,this._id=E.INC,E.INC++,this._pos=new D,this._fromConstraintSegments=[]};E.__name__=!0,E.prototype={get_id:function(){return this._id},get_isReal:function(){return this._isReal},get_pos:function(){return this._pos},get_fromConstraintSegments:function(){return this._fromConstraintSegments},set_fromConstraintSegments:function(t){return this._fromConstraintSegments=t},setDatas:function(t,e){null==e&&(e=!0),this._isReal=e,this._edge=t},addFromConstraintSegment:function(t){-1==this._fromConstraintSegments.indexOf(t)&&this._fromConstraintSegments.push(t)},removeFromConstraintSegment:function(t){var e=this._fromConstraintSegments.indexOf(t);-1!=e&&this._fromConstraintSegments.splice(e,1)},dispose:function(){this._pos=null,this._edge=null,this._fromConstraintSegments=null},get_edge:function(){return this._edge},set_edge:function(t){return this._edge=t},toString:function(){return"ver_id "+this._id},__class__:E};var S=t.hxDaedalus.data.graph.Graph=function(){this._id=S.INC,S.INC++};S.__name__=!0,S.prototype={get_id:function(){return this._id},get_edge:function(){return this._edge},get_node:function(){return this._node},dispose:function(){for(;null!=this._node;)this.deleteNode(this._node)},insertNode:function(){var t=new k;return null!=this._node&&(t.set_next(this._node),this._node.set_prev(t)),this._node=t,t},deleteNode:function(t){for(;null!=t.get_outgoingEdge();)null!=t.get_outgoingEdge().get_oppositeEdge()&&this.deleteEdge(t.get_outgoingEdge().get_oppositeEdge()),this.deleteEdge(t.get_outgoingEdge());for(var e,i=this._node;null!=i;)null!=(e=i.get_successorNodes().h[t.__id__])&&this.deleteEdge(e),i=i.get_next();this._node==t?null!=t.get_next()?(t.get_next().set_prev(null),this._node=t.get_next()):this._node=null:null!=t.get_next()?(t.get_prev().set_next(t.get_next()),t.get_next().set_prev(t.get_prev())):t.get_prev().set_next(null),t.dispose()},insertEdge:function(t,e){if(null!=t.get_successorNodes().h[e.__id__])return null;var i=new C;null!=this._edge&&(this._edge.set_prev(i),i.set_next(this._edge)),this._edge=i,i.set_sourceNode(t),i.set_destinationNode(e),t.get_successorNodes().set(e,i),null!=t.get_outgoingEdge()?(t.get_outgoingEdge().set_rotPrevEdge(i),i.set_rotNextEdge(t.get_outgoingEdge()),t.set_outgoingEdge(i)):t.set_outgoingEdge(i);var n=e.get_successorNodes().h[t.__id__];return null!=n&&(i.set_oppositeEdge(n),n.set_oppositeEdge(i)),i},deleteEdge:function(t){this._edge==t?null!=t.get_next()?(t.get_next().set_prev(null),this._edge=t.get_next()):this._edge=null:null!=t.get_next()?(t.get_prev().set_next(t.get_next()),t.get_next().set_prev(t.get_prev())):t.get_prev().set_next(null),t.get_sourceNode().get_outgoingEdge()==t?null!=t.get_rotNextEdge()?(t.get_rotNextEdge().set_rotPrevEdge(null),t.get_sourceNode().set_outgoingEdge(t.get_rotNextEdge())):t.get_sourceNode().set_outgoingEdge(null):null!=t.get_rotNextEdge()?(t.get_rotPrevEdge().set_rotNextEdge(t.get_rotNextEdge()),t.get_rotNextEdge().set_rotPrevEdge(t.get_rotPrevEdge())):t.get_rotPrevEdge().set_rotNextEdge(null),t.dispose()},__class__:S};var C=t.hxDaedalus.data.graph.GraphEdge=function(){this._id=C.INC,C.INC++};C.__name__=!0,C.prototype={get_id:function(){return this._id},dispose:function(){},get_prev:function(){return this._prev},set_prev:function(t){return this._prev=t,t},get_next:function(){return this._next},set_next:function(t){return this._next=t,t},get_rotPrevEdge:function(){return this._rotPrevEdge},set_rotPrevEdge:function(t){return this._rotPrevEdge=t,t},get_rotNextEdge:function(){return this._rotNextEdge},set_rotNextEdge:function(t){return this._rotNextEdge=t,t},get_oppositeEdge:function(){return this._oppositeEdge},set_oppositeEdge:function(t){return this._oppositeEdge=t,t},get_sourceNode:function(){return this._sourceNode},set_sourceNode:function(t){return this._sourceNode=t,t},get_destinationNode:function(){return this._destinationNode},set_destinationNode:function(t){return this._destinationNode=t,t},get_data:function(){return this._data},set_data:function(t){return this._data=t,t},__class__:C};var k=t.hxDaedalus.data.graph.GraphNode=function(){this._id=k.INC,k.INC++,this._successorNodes=new o};k.__name__=!0,k.prototype={get_id:function(){return this._id},dispose:function(){this._prev=null,this._next=null,this._outgoingEdge=null,this._successorNodes=null,this._data=null},get_prev:function(){return this._prev},set_prev:function(t){return this._prev=t,t},get_next:function(){return this._next},set_next:function(t){return this._next=t,t},get_outgoingEdge:function(){return this._outgoingEdge},set_outgoingEdge:function(t){return this._outgoingEdge=t,t},get_successorNodes:function(){return this._successorNodes},set_successorNodes:function(t){return this._successorNodes=t,t},get_data:function(){return this._data},set_data:function(t){return this._data=t,t},__class__:k};var P=t.hxDaedalus.data.math.EdgeData=function(){};P.__name__=!0,P.prototype={__class__:P};var I={__ename__:!0,__constructs__:["EVertex","EEdge","EFace","ENull"],EVertex:function(t){var e=["EVertex",0,t];return e.__enum__=I,e.toString=i,e},EEdge:function(t){var e=["EEdge",1,t];return e.__enum__=I,e.toString=i,e},EFace:function(t){var e=["EFace",2,t];return e.__enum__=I,e.toString=i,e},ENull:["ENull",3]};I.ENull.toString=i,I.ENull.__enum__=I;var D=t.hxDaedalus.data.math.Point2D=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};D.__name__=!0,D.prototype={transform:function(t){t.tranform(this)},setXY:function(t,e){this.x=t,this.y=e},clone:function(){return new D(this.x,this.y)},substract:function(t){this.x-=t.x,this.y-=t.y},get_length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){var t=this.get_length();this.x/=t,this.y/=t},scale:function(t){this.x*=t,this.y*=t},distanceTo:function(t){var e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)},__class__:D};var R=t.hxDaedalus.data.math.Geom2D=function(){};R.__name__=!0,R.locatePosition=function(t,e,i){null==R._randGen&&(R._randGen=new V),R._randGen.set_seed(10*t+4*e|0),R.__samples.splice(0,R.__samples.length);var n=0|Math.pow(i._vertices.length,.3333333333333333);R._randGen.rangeMin=0,R._randGen.rangeMax=i._vertices.length-1;for(var r,s,a,h=0,u=n;h<u;){h++;var l=R._randGen.next();l<0||i._vertices.length,i._vertices,i._vertices.length;R.__samples.push(i._vertices[l])}for(var c,g=1/0,d=null,f=0,p=n;f<p;){var _=f++;(a=((s=(r=R.__samples[_]).get_pos()).x-t)*(s.x-t)+(s.y-e)*(s.y-e))<g&&(g=a,d=r)}var v=new q;v.set_fromVertex(d),c=v.next();for(var y,m,x=new o,M=new W,w=I.ENull,b=0;;){var E;if(x.h[c.__id__])E=!0;else E=3==(w=R.isInFace(t,e,c))[1];if(!E)break;++b;for(M.set_fromFace(c);;){if(null==(y=M.next()))return I.ENull;if(1!=(m=R.getRelativePosition(t,e,y))&&0!=m)break}c=y.get_rightFace()}return w},R.isCircleIntersectingAnyConstraint=function(t,e,i,n){if(t<=0||t>=n.get_width()||e<=0||e>=n.get_height())return!0;var r,s=R.locatePosition(t,e,n);switch(s[1]){case 0:r=s[2].get_edge().get_leftFace();break;case 1:r=s[2].get_leftFace();break;case 2:r=s[2];break;case 3:r=null}var a,h=i*i;if(((a=r.get_edge().get_originVertex().get_pos()).x-t)*(a.x-t)+(a.y-e)*(a.y-e)<=h)return!0;if(((a=r.get_edge().get_nextLeftEdge().get_originVertex().get_pos()).x-t)*(a.x-t)+(a.y-e)*(a.y-e)<=h)return!0;if(((a=r.get_edge().get_nextLeftEdge().get_nextLeftEdge().get_originVertex().get_pos()).x-t)*(a.x-t)+(a.y-e)*(a.y-e)<=h)return!0;var u,l,c,g=[];g.push(r.get_edge()),g.push(r.get_edge().get_nextLeftEdge()),g.push(r.get_edge().get_nextLeftEdge().get_nextLeftEdge());for(var d=new o;g.length>0;)if(u=g.pop(),d.set(u,!0),l=u.get_originVertex().get_pos(),c=u.get_destinationVertex().get_pos(),R.intersectionsSegmentCircle(l.x,l.y,c.x,c.y,t,e,i)){if(u.get_isConstrained())return!0;var f,p;if(u=u.get_oppositeEdge().get_nextLeftEdge(),d.h[u.__id__])f=!1;else{var _=u.get_oppositeEdge();f=!d.h[_.__id__]}if(!!(!!f&&-1==g.indexOf(u))&&-1==g.indexOf(u.get_oppositeEdge())&&g.push(u),u=u.get_nextLeftEdge(),d.h[u.__id__])p=!1;else{var v=u.get_oppositeEdge();p=!d.h[v.__id__]}!!(!!p&&-1==g.indexOf(u))&&-1==g.indexOf(u.get_oppositeEdge())&&g.push(u)}return!1},R.getDirection=function(t,e,i,n,r,s){var a=(r-t)*(n-e)+(s-e)*(-i+t);return 0==a?0:a>0?1:-1},R.getDirection2=function(t,e,i,n,r,s){var a=(r-t)*(n-e)+(s-e)*(-i+t);return 0==a?0:a>0?R.distanceSquaredPointToLine(r,s,t,e,i,n)<=1e-4?0:1:R.distanceSquaredPointToLine(r,s,t,e,i,n)<=1e-4?0:-1},R.getRelativePosition=function(t,e,i){return R.getDirection(i.get_originVertex().get_pos().x,i.get_originVertex().get_pos().y,i.get_destinationVertex().get_pos().x,i.get_destinationVertex().get_pos().y,t,e)},R.getRelativePosition2=function(t,e,i){return R.getDirection2(i.get_originVertex().get_pos().x,i.get_originVertex().get_pos().y,i.get_destinationVertex().get_pos().x,i.get_destinationVertex().get_pos().y,t,e)},R.isInFace=function(t,e,i){var n=I.ENull,r=i.get_edge(),s=r.get_nextLeftEdge(),a=s.get_nextLeftEdge();if(R.getRelativePosition(t,e,r)>=0&&R.getRelativePosition(t,e,s)>=0&&R.getRelativePosition(t,e,a)>=0){var o=r.get_originVertex(),h=s.get_originVertex(),u=a.get_originVertex(),l=o.get_pos().x,c=o.get_pos().y,g=h.get_pos().x,d=h.get_pos().y,f=u.get_pos().x,p=u.get_pos().y,_=(t-l)*(g-l)+(e-c)*(d-c),v=(t-g)*(f-g)+(e-d)*(p-d),y=(t-f)*(l-f)+(e-p)*(c-p),m=(g-t)*(g-t)+(d-e)*(d-e)-v*v/((f-g)*(f-g)+(p-d)*(p-d))<=1e-4,x=(f-t)*(f-t)+(p-e)*(p-e)-y*y/((l-f)*(l-f)+(c-p)*(c-p))<=1e-4;n=(l-t)*(l-t)+(c-e)*(c-e)-_*_/((g-l)*(g-l)+(d-c)*(d-c))<=1e-4?x?I.EVertex(o):m?I.EVertex(h):I.EEdge(r):m?x?I.EVertex(u):I.EEdge(s):x?I.EEdge(a):I.EFace(i)}return n},R.clipSegmentByTriangle=function(t,e,i,n,r,s,a,o,h,u,l,c){var g,d,f,p,_,v;if(g=R.getDirection(r,s,a,o,t,e),d=R.getDirection(r,s,a,o,i,n),g<=0&&d<=0)return!1;if(f=R.getDirection(a,o,h,u,t,e),p=R.getDirection(a,o,h,u,i,n),f<=0&&p<=0)return!1;if(_=R.getDirection(h,u,r,s,t,e),v=R.getDirection(h,u,r,s,i,n),_<=0&&v<=0)return!1;if(g>=0&&f>=0&&_>=0&&d>=0&&p>=0&&v>=0)return l.x=t,l.y=e,c.x=i,c.y=n,!0;var y=0;return R.intersections2segments(t,e,i,n,r,s,a,o,l,null)&&++y,0==y?R.intersections2segments(t,e,i,n,a,o,h,u,l,null)&&++y:R.intersections2segments(t,e,i,n,a,o,h,u,c,null)&&(-.01>l.x-c.x||l.x-c.x>.01||-.01>l.y-c.y||l.y-c.y>.01)&&++y,0==y?R.intersections2segments(t,e,i,n,h,u,r,s,l,null)&&++y:1==y&&R.intersections2segments(t,e,i,n,h,u,r,s,c,null)&&(-.01>l.x-c.x||l.x-c.x>.01||-.01>l.y-c.y||l.y-c.y>.01)&&++y,1==y&&(g>=0&&f>=0&&_>=0?(c.x=t,c.y=e):d>=0&&p>=0&&v>=0?(c.x=i,c.y=n):y=0),y>0},R.isSegmentIntersectingTriangle=function(t,e,i,n,r,s,a,o,h,u){var l,c,g,d,f,p,_,v;return l=R.getDirection(r,s,a,o,t,e),c=R.getDirection(r,s,a,o,i,n),!(l<=0&&c<=0)&&(g=R.getDirection(a,o,h,u,t,e),d=R.getDirection(a,o,h,u,i,n),!(g<=0&&d<=0)&&(f=R.getDirection(h,u,r,s,t,e),p=R.getDirection(h,u,r,s,i,n),!(f<=0&&p<=0)&&(1==l&&1==g&&1==f||(1==l&&1==g&&1==f||((1==l&&c<=0||l<=0&&1==c)&&(_=R.getDirection(t,e,i,n,r,s),v=R.getDirection(t,e,i,n,a,o),1==_&&v<=0||_<=0&&1==v)||((1==g&&d<=0||g<=0&&1==d)&&(_=R.getDirection(t,e,i,n,a,o),v=R.getDirection(t,e,i,n,h,u),1==_&&v<=0||_<=0&&1==v)||(1==f&&p<=0||f<=0&&1==p)&&(_=R.getDirection(t,e,i,n,h,u),v=R.getDirection(t,e,i,n,r,s),1==_&&v<=0||_<=0&&1==v)))))))},R.isDelaunay=function(t){var e=t.get_originVertex(),i=t.get_destinationVertex(),n=t.get_nextLeftEdge().get_destinationVertex(),r=t.get_nextRightEdge().get_destinationVertex();R.getCircumcenter(n.get_pos().x,n.get_pos().y,e.get_pos().x,e.get_pos().y,i.get_pos().x,i.get_pos().y,R.__circumcenter);var s=(n.get_pos().x-R.__circumcenter.x)*(n.get_pos().x-R.__circumcenter.x)+(n.get_pos().y-R.__circumcenter.y)*(n.get_pos().y-R.__circumcenter.y);return(r.get_pos().x-R.__circumcenter.x)*(r.get_pos().x-R.__circumcenter.x)+(r.get_pos().y-R.__circumcenter.y)*(r.get_pos().y-R.__circumcenter.y)>=s},R.getCircumcenter=function(t,e,i,n,r,s,a){null==a&&(a=new D);var o=(t+i)/2,h=(e+n)/2,u=(o*(t-r)+(h-(e+s)/2)*(e-s)+(t+r)/2*(r-t))/(t*(s-n)+i*(e-s)+r*(n-e));return a.x=o+u*(n-e),a.y=h-u*(i-t),a},R.intersections2segments=function(t,e,i,n,r,s,a,o,h,u,l){null==l&&(l=!1);var c,g=0,d=0,f=(t-i)*(s-o)+(n-e)*(r-a);return 0==f?c=!1:(c=!0,l&&null==h&&null==u||(g=(t*(s-o)+e*(a-r)+r*o-s*a)/f,d=(t*(s-n)+e*(i-r)-i*s+n*r)/f,l||0<=g&&g<=1&&0<=d&&d<=1||(c=!1))),c&&(null!=h&&(h.x=t+g*(i-t),h.y=e+g*(n-e)),null!=u&&(u.push(g),u.push(d))),c},R.intersections2edges=function(t,e,i,n,r){return null==r&&(r=!1),R.intersections2segments(t.get_originVertex().get_pos().x,t.get_originVertex().get_pos().y,t.get_destinationVertex().get_pos().x,t.get_destinationVertex().get_pos().y,e.get_originVertex().get_pos().x,e.get_originVertex().get_pos().y,e.get_destinationVertex().get_pos().x,e.get_destinationVertex().get_pos().y,i,n,r)},R.isConvex=function(t){var e,i,n=!0;return e=t.get_nextLeftEdge().get_oppositeEdge(),i=t.get_nextRightEdge().get_destinationVertex(),-1!=R.getRelativePosition(i.get_pos().x,i.get_pos().y,e)?n=!1:(e=t.get_prevRightEdge(),i=t.get_prevLeftEdge().get_originVertex(),-1!=R.getRelativePosition(i.get_pos().x,i.get_pos().y,e)&&(n=!1)),n},R.projectOrthogonaly=function(t,e){var i=e.get_originVertex().get_pos().x,n=e.get_originVertex().get_pos().y,r=e.get_destinationVertex().get_pos().x,s=e.get_destinationVertex().get_pos().y,a=t.x,o=t.y,h=(i*i-i*r-i*a+n*n-n*s-n*o+r*a+s*o)/(i*i-2*i*r+n*n-2*n*s+r*r+s*s);t.x=i+h*(r-i),t.y=n+h*(s-n)},R.intersections2Circles=function(t,e,i,n,r,s,a){var o=(n-t)*(n-t)+(r-e)*(r-e);if((t!=n||e!=r)&&o<=(i+s)*(i+s)&&o>=(i-s)*(i-s)){var h=Math.sqrt(((i+s)*(i+s)-o)*(o-(s-i)*(s-i))),u=(t+n)/2+(n-t)*(i*i-s*s)/(2*o),l=(e+r)/2+(r-e)*(i*i-s*s)/(2*o),c=(r-e)/(2*o),g=(n-t)/(2*o);if(null!=a)for(var d=0,f=[u+c*h,l-g*h,u-c*h,l+g*h];d<f.length;){var p=f[d];++d,a.push(p)}return!0}return!1},R.intersectionsSegmentCircle=function(t,e,i,n,r,s,a,o){var h,u,l,c=t*t,g=e*e,d=n*n-2*n*e+g+i*i-2*i*t+c,f=2*e*s-2*c+2*n*e-2*g+2*i*t-2*i*r+2*t*r-2*n*s,p=f*f-4*d*(g+s*s+r*r-2*e*s-2*t*r+c-a*a);if(p<0)return!1;if(0==p){if((u=-f/(2*d))<0||u>1)return!1;if(null!=o)for(var _=0,v=[t+u*(i-t),e+u*(n-e),u];_<v.length;){var y=v[_];++_,o.push(y)}return!0}l=(-f-(h=Math.sqrt(p)))/(2*d);var m=!1;if(0<=(u=(-f+h)/(2*d))&&u<=1){if(null!=o)for(var x=0,M=[t+u*(i-t),e+u*(n-e),u];x<M.length;){var w=M[x];++x,o.push(w)}m=!0}if(0<=l&&l<=1){if(null!=o)for(var b=0,E=[t+l*(i-t),e+l*(n-e),l];b<E.length;){var S=E[b];++b,o.push(S)}m=!0}return m},R.intersectionsLineCircle=function(t,e,i,n,r,s,a,o){var h,u,l,c=t*t,g=e*e,d=n*n-2*n*e+g+i*i-2*i*t+c,f=2*e*s-2*c+2*n*e-2*g+2*i*t-2*i*r+2*t*r-2*n*s,p=f*f-4*d*(g+s*s+r*r-2*e*s-2*t*r+c-a*a);if(p<0)return!1;if(0==p)for(var _=0,v=[t+(u=-f/(2*d))*(i-t),e+u*(n-e),u];_<v.length;){var y=v[_];++_,o.push(y)}else if(p>0)for(var m=0,x=[t+(u=(-f+(h=Math.sqrt(p)))/(2*d))*(i-t),e+u*(n-e),u,t+(l=(-f-h)/(2*d))*(i-t),e+l*(n-e),l];m<x.length;){var M=x[m];++m,o.push(M)}return!0},R.tangentsPointToCircle=function(t,e,i,n,r,s){var a=(t+i)/2,o=(e+n)/2,h=.5*Math.sqrt((t-i)*(t-i)+(e-n)*(e-n));return R.intersections2Circles(a,o,h,i,n,r,s)},R.tangentsCrossCircleToCircle=function(t,e,i,n,r,s){var a=Math.sqrt((e-n)*(e-n)+(i-r)*(i-r)),o=a/4,h=e+(n-e)/4,u=i+(r-i)/4;if(R.intersections2Circles(e,i,t,h,u,o,s)){for(var l=s[0],c=s[1],g=(e+n)/2,d=(i+r)/2,f=((l-g)*(r-i)+(c-d)*(-n+e))/(a*a),p=2*(g+f*(r-i))-l,_=2*(d-f*(n-e))-c,v=0,y=[p+s[2]-l,s[3]+_-c,p,_];v<y.length;){var m=y[v];++v,s.push(m)}return!0}return!1},R.tangentsParalCircleToCircle=function(t,e,i,n,r,s){for(var a=Math.sqrt((e-n)*(e-n)+(i-r)*(i-r)),o=e+t*(r-i)/a,h=i+t*(-n+e)/a,u=2*e-o,l=2*i-h,c=0,g=[o,h,u,l,u+n-e,l+r-i,o+n-e,h+r-i];c<g.length;){var d=g[c];++c,s.push(d)}},R.distanceSquaredPointToLine=function(t,e,i,n,r,s){var a=(t-i)*(r-i)+(e-n)*(s-n);return(i-t)*(i-t)+(n-e)*(n-e)-a*a/((r-i)*(r-i)+(s-n)*(s-n))},R.distanceSquaredPointToSegment=function(t,e,i,n,r,s){var a=(r-i)*(r-i)+(s-n)*(s-n),o=((t-i)*(r-i)+(e-n)*(s-n))/a;return o<0?(t-i)*(t-i)+(e-n)*(e-n):o<=1?(i-t)*(i-t)+(n-e)*(n-e)-o*o*a:(t-r)*(t-r)+(e-s)*(e-s)},R.distanceSquaredVertexToEdge=function(t,e){return R.distanceSquaredPointToSegment(t.get_pos().x,t.get_pos().y,e.get_originVertex().get_pos().x,e.get_originVertex().get_pos().y,e.get_destinationVertex().get_pos().x,e.get_destinationVertex().get_pos().y)},R.pathLength=function(t){for(var e,i,n,r,s=0,a=t[0],o=t[1],h=2;h<t.length;)n=(e=t[h])-a,r=(i=t[h+1])-o,s+=Math.sqrt(n*n+r*r),a=e,o=i,h+=2;return s},R.prototype={__class__:R};var T=t.hxDaedalus.data.math.Matrix2D=function(t,e,i,n,r,s){null==s&&(s=0),null==r&&(r=0),null==n&&(n=1),null==i&&(i=0),null==e&&(e=0),null==t&&(t=1),this.a=t,this.b=e,this.c=i,this.d=n,this.e=r,this.f=s};T.__name__=!0,T.prototype={identity:function(){this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0},translate:function(t,e){this.e+=t,this.f+=e},scale:function(t,e){this.a*=t,this.b*=e,this.c*=t,this.d*=e,this.e*=t,this.f*=e},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.a*e+this.b*-i,r=this.a*i+this.b*e,s=this.c*e+this.d*-i,a=this.c*i+this.d*e,o=this.e*e+this.f*-i,h=this.e*i+this.f*e;this.a=n,this.b=r,this.c=s,this.d=a,this.e=o,this.f=h},clone:function(){return new T(this.a,this.b,this.c,this.d,this.e,this.f)},tranform:function(t){var e=this.a*t.x+this.c*t.y+this.e,i=this.b*t.x+this.d*t.y+this.f;t.x=e,t.y=i},transformX:function(t,e){return this.a*t+this.c*e+this.e},transformY:function(t,e){return this.b*t+this.d*e+this.f},concat:function(t){var e=this.a*t.a+this.b*t.c,i=this.a*t.b+this.b*t.d,n=this.c*t.a+this.d*t.c,r=this.c*t.b+this.d*t.d,s=this.e*t.a+this.f*t.c+t.e,a=this.e*t.b+this.f*t.d+t.f;this.a=e,this.b=i,this.c=n,this.d=r,this.e=s,this.f=a},__class__:T};var L=t.hxDaedalus.data.math.NodeData=function(){};L.__name__=!0,L.prototype={__class__:L};var A=t.hxDaedalus.data.math.Potrace=function(){};A.__name__=!0,A.buildShapes=function(t,e,i){for(var n=[],r=new h,s=1,a=t.height-1;s<a;)for(var o=s++,u=0,l=t.width-1;u<l;){var c=u++;if(16777215==$.getPixel(t,c,o)&&$.getPixel(t,c+1,o)<16777215){var g=c+1+"_"+o;(null!=Mt[g]?r.getReserved(g):r.h[g])||n.push(A.buildShape(t,o,c+1,r,e,i))}}return n},A.buildShape=function(t,e,i,n,r,s){var a=i,o=e,h=[a,o],u=a+"_"+o;null!=Mt[u]?n.setReserved(u,!0):n.h[u]=!0;for(var l,c,g=new D(0,1),d=new D,f=-1;null!=r&&$.setPixel32(r,i,e,-65536),l=e+g.x+g.y|0,c=i+g.x-g.y|0,$.getPixel(t,c,l)<16777215?(d.x=-g.y,d.y=g.x):(l=e+g.y|0,c=i+g.x|0,$.getPixel(t,c,l)<16777215?(d.x=g.x,d.y=g.y):(l=e,c=i,d.x=g.y,d.y=-g.x)),a+=g.x,o+=g.y,a!=h[0]||o!=h[1];){h.push(a),h.push(o);var p=a+"_"+o;if(null!=Mt[p]?n.setReserved(p,!0):n.h[p]=!0,e=l,i=c,g.x=d.x,g.y=d.y,0==--f)break}if(null!=s){s.graphics.lineStyle(.5,65280,1),s.graphics.moveTo(h[0],h[1]);for(var _=2;_<h.length;)s.graphics.lineTo(h[_],h[_+1]),_+=2;s.graphics.lineTo(h[0],h[1])}return h},A.buildGraph=function(t){var e,i,n,r,s,a,o,h,u,l,c,g=new S;for(e=0;e<t.length;){(i=g.insertNode()).set_data(new L),i.get_data().index=e;var d=t[e],f=t[e+1];i.get_data().point=new D(d,f),e+=2}for(n=g.get_node();null!=n;){for(r=null!=n.get_next()?n.get_next():g.get_node();r!=n;){for(u=!0,s=null!=n.get_next()?n.get_next():g.get_node(),h=2,o=0;s!=r;){if((a=R.distanceSquaredPointToSegment(s.get_data().point.x,s.get_data().point.y,n.get_data().point.x,n.get_data().point.y,r.get_data().point.x,r.get_data().point.y))<0&&(a=0),a>=A.maxDistance){u=!1;break}++h,o+=a,s=null!=s.get_next()?s.get_next():g.get_node()}if(!u)break;l=g.insertEdge(n,r),(c=new P).sumDistancesSquared=o,c.length=n.get_data().point.distanceTo(r.get_data().point),c.nodesCount=h,l.set_data(c),r=null!=r.get_next()?r.get_next():g.get_node()}n=n.get_next()}return g},A.buildPolygon=function(t,e){var i,n,r,s,a=[],o=2147483647,h=null;for(i=t.get_node();i.get_data().index<o;){for(o=i.get_data().index,a.push(i.get_data().point.x),a.push(i.get_data().point.y),s=0,n=i.get_outgoingEdge();null!=n;)(r=n.get_data().nodesCount-n.get_data().length*Math.sqrt(n.get_data().sumDistancesSquared/n.get_data().nodesCount))>s&&(s=r,h=n),n=n.get_rotNextEdge();i=h.get_destinationNode()}if(0==R.getDirection(a[a.length-2],a[a.length-1],a[0],a[1],a[2],a[3])&&(a.shift(),a.shift()),null!=e){e.graphics.lineStyle(.5,255),e.graphics.moveTo(a[0],a[1]);for(var u=2;u<a.length;)e.graphics.lineTo(a[u],a[u+1]),u+=2;e.graphics.lineTo(a[0],a[1])}return a},A.prototype={__class__:A};var V=t.hxDaedalus.data.math.RandGenerator=function(t,e,i){null==i&&(i=1),null==e&&(e=0),null==t&&(t=1234),this._originalSeed=this._currSeed=t,this.rangeMin=e,this.rangeMax=i,this._numIter=0};V.__name__=!0,V.prototype={set_seed:function(t){return this._originalSeed=this._currSeed=t,t},get_seed:function(){return this._originalSeed},reset:function(){this._currSeed=this._originalSeed,this._numIter=0},next:function(){var t=1*this._currSeed;for(this._tempString=r.string(t*t);this._tempString.length<8;)this._tempString="0"+this._tempString;this._currSeed=r.parseInt(n.substr(this._tempString,1,5));var e=Math.round(this.rangeMin+this._currSeed/99999*(this.rangeMax-this.rangeMin));return 0==this._currSeed&&(this._currSeed=this._originalSeed+this._numIter),this._numIter++,200==this._numIter&&this.reset(),e},nextInRange:function(t,e){return this.rangeMin=t,this.rangeMax=e,this.next()},shuffle:function(t){for(var e=t.length;e>0;){var i=this.nextInRange(0,e-1),n=t[--e];t[e]=t[i],t[i]=n}},__class__:V};var O=t.hxDaedalus.data.math.ShapeSimplifier=function(){};O.__name__=!0,O.simplify=function(t,e){null==e&&(e=1);var i=t.length;if(i<=4||e<1)return[].concat(t);for(var n=t[0],r=t[1],s=t[i-2],a=t[i-1],o=-1,h=0,u=1,l=i>>1;u<l;){var c=u++,g=R.distanceSquaredPointToSegment(t[c<<1],t[1+(c<<1)],n,r,s,a);g>h&&(h=g,o=c)}if(h>e*e){var d=t.slice(0,2+(o<<1)),f=t.slice(o<<1),p=O.simplify(d,e),_=O.simplify(f,e);return p.slice(0,p.length-2).concat(_)}return[n,r,s,a]};var F=t.hxDaedalus.data.math.Tools=function(){};F.__name__=!0,F.extractMeshFromBitmap=function(t,e,i){var n=A.buildShapes(t);return F.extractMeshFromShapes(n,t.width,t.height,e,i)},F.extractMeshFromShapes=function(t,e,i,n,r,s){null==s&&(s=!1);for(var a=[],h=0,u=t.length;h<u;){var l=h++;a.push(A.buildGraph(t[l]))}for(var c=[],g=0,d=a.length;g<d;){var f=g++;c.push(A.buildPolygon(a[f]))}for(var p,_=z.buildRectangle(e,i),v=[],y=0,m=c.length;y<m;){for(var x=y++,M=0;M<c[x].length-2;)p=_.insertConstraintSegment(c[x][M],c[x][M+1],c[x][M+2],c[x][M+3]),0==M&&(p.get_edges()[0].get_originVertex().get_pos().x==c[x][M]&&p.get_edges()[0].get_originVertex().get_pos().y==c[x][M+1]?s?v.push(p.get_edges()[0].get_oppositeEdge()):v.push(p.get_edges()[0]):s?v.push(p.get_edges()[0]):v.push(p.get_edges()[0].get_oppositeEdge())),M+=2;_.insertConstraintSegment(c[x][0],c[x][1],c[x][M],c[x][M+1])}for(var w,b,E=new o,S=0,C=_._vertices.length;S<C;){var k=S++;if((w=_._vertices[k]).get_isReal()&&w.get_pos().x>0&&w.get_pos().x<e&&w.get_pos().y>0&&w.get_pos().y<i){b=new D(w.get_pos().x,w.get_pos().y),n.push(b);var P=n.length-1;E.set(w,P)}}for(var I,R=new o,T=[],L=0,V=v.length;L<V;){var O=L++;T.push(v[O].get_rightFace())}for(;T.length>0;)if(I=T.pop(),!R.h[I.__id__]){var F=I.get_edge().get_originVertex();r.push(E.h[F.__id__]);var N=I.get_edge().get_nextLeftEdge().get_originVertex();r.push(E.h[N.__id__]);var j=I.get_edge().get_nextLeftEdge().get_destinationVertex();r.push(E.h[j.__id__]),I.get_edge().get_isConstrained()||T.push(I.get_edge().get_rightFace()),I.get_edge().get_nextLeftEdge().get_isConstrained()||T.push(I.get_edge().get_nextLeftEdge().get_rightFace()),I.get_edge().get_prevLeftEdge().get_isConstrained()||T.push(I.get_edge().get_prevLeftEdge().get_rightFace()),R.set(I,!0)}return _};var N=function(){};N.__name__=!0,N.assertTrue=function(t,e,i){},N.assertFalse=function(t,e,i){},N.assertEquals=function(t,e,i,n){},N.trace=function(t,e){};var j=t.hxDaedalus.factories.BitmapMesh=function(){};j.__name__=!0,j.buildFromBmpData=function(t,e,i){for(var n,r=A.buildShapes(t,e,i),s=[],a=0,o=r.length;a<o;){var h=a++;s.push(A.buildGraph(r[h]))}for(var u=[],l=0,c=s.length;l<c;){var g=l++;u.push(A.buildPolygon(s[g],i))}for(var d=z.buildRectangle(t.width,t.height),f=0,p=u.length;f<p;){var _=f++;for(n=0;n<u[_].length-2;)d.insertConstraintSegment(u[_][n],u[_][n+1],u[_][n+2],u[_][n+3]),n+=2;d.insertConstraintSegment(u[_][0],u[_][1],u[_][n],u[_][n+1])}return d},j.prototype={__class__:j};var B=t.hxDaedalus.factories.BitmapObject=function(){};B.__name__=!0,B.buildFromBmpData=function(t,e,i,n){var r;null==e&&(e=1);t.width>0&&t.height,t.width,t.height;var s=A.buildShapes(t,i,n);if(e>=1)for(var a=0,o=s.length;a<o;){var h=a++;s[h]=O.simplify(s[h],e)}for(var u=[],l=0,c=s.length;l<c;){var g=l++;u.push(A.buildGraph(s[g]))}for(var d=[],f=0,p=u.length;f<p;){var _=f++;d.push(A.buildPolygon(u[_],n))}for(var v=new b,y=0,m=d.length;y<m;){var x=y++;for(r=0;r<d[x].length-2;)v.get_coordinates().push(d[x][r]),v.get_coordinates().push(d[x][r+1]),v.get_coordinates().push(d[x][r+2]),v.get_coordinates().push(d[x][r+3]),r+=2;v.get_coordinates().push(d[x][0]),v.get_coordinates().push(d[x][1]),v.get_coordinates().push(d[x][r]),v.get_coordinates().push(d[x][r+1])}return v},B.prototype={__class__:B};var z=t.hxDaedalus.factories.RectMesh=function(){};z.__name__=!0,z.buildRectangle=function(t,e){var i=new E,n=new E,r=new E,s=new E,a=new x,o=new x,h=new x,u=new x,l=new x,c=new x,g=new x,d=new x,f=new x,p=new x,_=new x,v=new x,b=new M,S=new M,C=new M,k=new M,P=new m,I=new y,D=new y,R=new y,T=new y,L=new w(t,e),A=10;i.get_pos().setXY(-10,-10),n.get_pos().setXY(t+A,-10),r.get_pos().setXY(t+A,e+A),s.get_pos().setXY(-10,e+A),i.setDatas(a),n.setDatas(h),r.setDatas(l),s.setDatas(g),a.setDatas(i,o,h,k,!0,!0),o.setDatas(n,a,d,b,!0,!0),h.setDatas(n,u,v,k,!0,!0),u.setDatas(r,h,f,S,!0,!0),l.setDatas(r,c,g,C,!0,!0),c.setDatas(s,l,u,S,!0,!0),g.setDatas(s,d,_,C,!0,!0),d.setDatas(i,g,p,b,!0,!0),f.setDatas(n,p,c,S,!0,!1),p.setDatas(s,f,o,b,!0,!1),_.setDatas(i,v,l,C,!1,!1),v.setDatas(r,_,a,k,!1,!1),b.setDatas(p),S.setDatas(f),C.setDatas(l,!1),k.setDatas(h,!1),i.set_fromConstraintSegments([I,T]),n.set_fromConstraintSegments([I,D]),r.set_fromConstraintSegments([D,R]),s.set_fromConstraintSegments([R,T]),a.fromConstraintSegments.push(I),o.fromConstraintSegments.push(I),h.fromConstraintSegments.push(D),u.fromConstraintSegments.push(D),l.fromConstraintSegments.push(R),c.fromConstraintSegments.push(R),g.fromConstraintSegments.push(T),d.fromConstraintSegments.push(T),I.get_edges().push(a),D.get_edges().push(h),R.get_edges().push(l),T.get_edges().push(g),I.fromShape=P,D.fromShape=P,R.fromShape=P,T.fromShape=P;for(var V=0,O=[I,D,R,T];V<O.length;){var F=O[V];++V,P.segments.push(F)}for(var N=0,j=[i,n,r,s];N<j.length;){var B=j[N];++N,L._vertices.push(B)}for(var z=0,G=[a,o,h,u,l,c,g,d,f,p,_,v];z<G.length;){var W=G[z];++z,L._edges.push(W)}for(var H=0,X=[b,S,C,k];H<X.length;){var Y=X[H];++H,L._faces.push(Y)}L.get___constraintShapes().push(P);for(var U=[],q=0,Z=[0,0,t,0];q<Z.length;){var K=Z[q];++q,U.push(K)}for(var J=0,Q=[t,0,t,e];J<Q.length;){var $=Q[J];++J,U.push($)}for(var tt=0,et=[t,e,0,e];tt<et.length;){var it=et[tt];++tt,U.push(it)}for(var nt=0,rt=[0,e,0,0];nt<rt.length;){var st=rt[nt];++nt,U.push(st)}return L.set_clipping(!1),L.insertConstraintShape(U),L.set_clipping(!0),L},z.prototype={__class__:z};var G=t.hxDaedalus.iterators.FromEdgeToRotatedEdges=function(){};G.__name__=!0,G.prototype={__class__:G};var W=t.hxDaedalus.iterators.FromFaceToInnerEdges=function(){};W.__name__=!0,W.prototype={set_fromFace:function(t){return this._fromFace=t,this._nextEdge=this._fromFace.get_edge(),t},next:function(){return null!=this._nextEdge?(this._resultEdge=this._nextEdge,this._nextEdge=this._nextEdge.get_nextLeftEdge(),this._nextEdge==this._fromFace.get_edge()&&(this._nextEdge=null)):this._resultEdge=null,this._resultEdge},__class__:W};var H=t.hxDaedalus.iterators.FromFaceToInnerVertices=function(){};H.__name__=!0,H.prototype={set_fromFace:function(t){return this._fromFace=t,this._nextEdge=this._fromFace.get_edge(),t},next:function(){return null!=this._nextEdge?(this._resultVertex=this._nextEdge.get_originVertex(),this._nextEdge=this._nextEdge.get_nextLeftEdge(),this._nextEdge==this._fromFace.get_edge()&&(this._nextEdge=null)):this._resultVertex=null,this._resultVertex},__class__:H};var X=t.hxDaedalus.iterators.FromFaceToNeighbourFaces=function(){};X.__name__=!0,X.prototype={set_fromFace:function(t){return this._fromFace=t,this._nextEdge=this._fromFace.get_edge(),t},next:function(){if(null!=this._nextEdge)for(;;){if(this._resultFace=this._nextEdge.get_rightFace(),this._nextEdge=this._nextEdge.get_nextLeftEdge(),this._nextEdge==this._fromFace.get_edge()){this._nextEdge=null,this._resultFace.get_isReal()||(this._resultFace=null);break}if(this._resultFace.get_isReal())break}else this._resultFace=null;return this._resultFace},__class__:X};var Y=t.hxDaedalus.iterators.FromMeshToFaces=function(){};Y.__name__=!0,Y.prototype={set_fromMesh:function(t){return this._fromMesh=t,this._currIndex=0,t},next:function(){for(;;){if(!(this._currIndex<this._fromMesh._faces.length)){this._resultFace=null;break}if(this._resultFace=this._fromMesh._faces[this._currIndex],this._currIndex++,this._resultFace.get_isReal())break}return this._resultFace},__class__:Y};var U=t.hxDaedalus.iterators.FromMeshToVertices=function(){};U.__name__=!0,U.prototype={set_fromMesh:function(t){return this._fromMesh=t,this._currIndex=0,t},next:function(){for(;;){if(!(this._currIndex<this._fromMesh._vertices.length)){this._resultVertex=null;break}if(this._resultVertex=this._fromMesh._vertices[this._currIndex],this._currIndex++,this._resultVertex.get_isReal())break}return this._resultVertex},__class__:U};var q=t.hxDaedalus.iterators.FromVertexToHoldingFaces=function(){};q.__name__=!0,q.prototype={set_fromVertex:function(t){return this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge(),t},next:function(){if(null!=this._nextEdge)for(;;){if(this._resultFace=this._nextEdge.get_leftFace(),this._nextEdge=this._nextEdge.get_rotLeftEdge(),this._nextEdge==this._fromVertex.get_edge()){this._nextEdge=null,this._resultFace.get_isReal()||(this._resultFace=null);break}if(this._resultFace.get_isReal())break}else this._resultFace=null;return this._resultFace},__class__:q};var Z=t.hxDaedalus.iterators.FromVertexToIncomingEdges=function(){};Z.__name__=!0,Z.prototype={set_fromVertex:function(t){for(this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge();!this._nextEdge.get_isReal();)this._nextEdge=this._nextEdge.get_rotLeftEdge();return t},next:function(){if(null!=this._nextEdge)for(this._resultEdge=this._nextEdge.get_oppositeEdge();;){if(this._nextEdge=this._nextEdge.get_rotLeftEdge(),this._nextEdge==this._fromVertex.get_edge()){this._nextEdge=null;break}if(this._nextEdge.get_isReal())break}else this._resultEdge=null;return this._resultEdge},__class__:Z};var K=t.hxDaedalus.iterators.FromVertexToNeighbourVertices=function(){};K.__name__=!0,K.prototype={set_fromVertex:function(t){return this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge(),t},next:function(){if(null!=this._nextEdge){for(this._resultVertex=this._nextEdge.get_oppositeEdge().get_originVertex();this._nextEdge=this._nextEdge.get_rotLeftEdge(),!this._nextEdge.get_isReal(););this._nextEdge==this._fromVertex.get_edge()&&(this._nextEdge=null)}else this._resultVertex=null;return this._resultVertex},__class__:K};var J=t.hxDaedalus.iterators.FromVertexToOutgoingEdges=function(){this.realEdgesOnly=!0};J.__name__=!0,J.prototype={set_fromVertex:function(t){for(this._fromVertex=t,this._nextEdge=this._fromVertex.get_edge();this.realEdgesOnly&&!this._nextEdge.get_isReal();)this._nextEdge=this._nextEdge.get_rotLeftEdge();return t},next:function(){if(null!=this._nextEdge)for(this._resultEdge=this._nextEdge;;){if(this._nextEdge=this._nextEdge.get_rotLeftEdge(),this._nextEdge==this._fromVertex.get_edge()){this._nextEdge=null;break}if(!this.realEdgesOnly||this._nextEdge.get_isReal())break}else this._resultEdge=null;return this._resultEdge},__class__:J};var Q=t.hxDaedalus.view.SimpleView=function(t){this.faceToEdgeIter=new W,this.faceAlpha=.5,this.faceWidth=1,this.faceColor=16711935,this.entitiesAlpha=.75,this.entitiesWidth=1,this.entitiesColor=65280,this.pathsAlpha=.75,this.pathsWidth=1.5,this.pathsColor=16760848,this.verticesAlpha=.25,this.verticesRadius=.5,this.verticesColor=255,this.constraintsAlpha=1,this.constraintsWidth=2,this.constraintsColor=16711680,this.edgesAlpha=.25,this.edgesWidth=1,this.edgesColor=10066329,this.graphics=new gt(t)};Q.__name__=!0,Q.prototype={drawVertex:function(t){this.graphics.graphics.lineStyle(this.verticesRadius,this.verticesColor,this.verticesAlpha),this.graphics.graphics.beginFill(this.verticesColor,this.verticesAlpha);var e=this.graphics,i=t.get_pos().x,n=t.get_pos().y;e.graphics.drawCircle(i,n,this.verticesRadius),this.graphics.graphics.endFill()},drawFace:function(t){this.faceToEdgeIter.set_fromFace(t),this.graphics.graphics.beginFill(this.faceColor,this.faceAlpha),this.graphics.graphics.lineStyle(this.faceWidth,this.faceColor,this.faceAlpha);for(var e,i=0;null!=(e=this.faceToEdgeIter.next());){if(0==i){var n=this.graphics,r=e.get_originVertex().get_pos().x,s=e.get_originVertex().get_pos().y;n.graphics.moveTo(r,s)}var a=this.graphics,o=e.get_destinationVertex().get_pos().x,h=e.get_destinationVertex().get_pos().y;a.graphics.lineTo(o,h),++i}this.graphics.graphics.endFill()},drawEdge:function(t){if(t.get_isConstrained()){this.graphics.graphics.lineStyle(this.constraintsWidth,this.constraintsColor,this.constraintsAlpha);var e=this.graphics,i=t.get_originVertex().get_pos().x,n=t.get_originVertex().get_pos().y;e.graphics.moveTo(i,n);var r=this.graphics,s=t.get_destinationVertex().get_pos().x,a=t.get_destinationVertex().get_pos().y;r.graphics.lineTo(s,a)}else{this.graphics.graphics.lineStyle(this.edgesWidth,this.edgesColor,this.edgesAlpha);var o=this.graphics,h=t.get_originVertex().get_pos().x,u=t.get_originVertex().get_pos().y;o.graphics.moveTo(h,u);var l=this.graphics,c=t.get_destinationVertex().get_pos().x,g=t.get_destinationVertex().get_pos().y;l.graphics.lineTo(c,g)}},drawMesh:function(t,e){null==e&&(e=!1),e&&this.graphics.graphics.clear();for(var i=t.getVerticesAndEdges(),n=0,r=i.vertices;n<r.length;){var s=r[n];++n,this.drawVertex(s)}for(var a=0,o=i.edges;a<o.length;){var h=o[a];++a,this.drawEdge(h)}},drawEntity:function(t,e){null==e&&(e=!1),e&&this.graphics.graphics.clear(),this.graphics.graphics.lineStyle(this.entitiesWidth,this.entitiesColor,this.entitiesAlpha),this.graphics.graphics.beginFill(this.entitiesColor,this.entitiesAlpha);var i=this.graphics,n=t.x,r=t.y,s=t.get_radius();i.graphics.drawCircle(n,r,s),this.graphics.graphics.endFill()},drawEntities:function(t,e){null==e&&(e=!1),e&&this.graphics.graphics.clear();for(var i=0,n=t.length;i<n;){var r=i++;this.drawEntity(t[r],!1)}},drawPath:function(t,e){if(null==e&&(e=!1),e&&this.graphics.graphics.clear(),0!=t.length){this.graphics.graphics.lineStyle(this.pathsWidth,this.pathsColor,this.pathsAlpha),this.graphics.graphics.moveTo(t[0],t[1]);for(var i=2;i<t.length;)this.graphics.graphics.lineTo(t[i],t[i+1]),this.graphics.graphics.moveTo(t[i],t[i+1]),i+=2}},__class__:Q};var $=t.hxPixels._Pixels.Pixels_Impl_={};$.__name__=!0,$._new=function(t,e,i){return null==i&&(i=!0),new tt(t,e,i)},$.getByte=function(t,e){return t.bytes.b[(-4&e)+t.format.channelMap[3&e]]},$.getPixel=function(t,e,i){var n=i*t.width+e<<2;return t.bytes.b[n+t.format.ch1]<<16|t.bytes.b[n+t.format.ch2]<<8|t.bytes.b[n+t.format.ch3]},$.getPixel32=function(t,e,i){var n=i*t.width+e<<2;return t.bytes.b[n+t.format.ch0]<<24|t.bytes.b[n+t.format.ch1]<<16|t.bytes.b[n+t.format.ch2]<<8|t.bytes.b[n+t.format.ch3]},$.setByte=function(t,e,i){t.bytes.b[(-4&e)+t.format.channelMap[3&e]]=255&i},$.setPixel=function(t,e,i,n){var r=i*t.width+e<<2,s=n>>16&255,a=n>>8&255,o=255&n;t.bytes.b[r+t.format.ch1]=255&s,t.bytes.b[r+t.format.ch2]=255&a,t.bytes.b[r+t.format.ch3]=255&o},$.setPixel32=function(t,e,i,n){var r=i*t.width+e<<2,s=n>>24&255,a=n>>16&255,o=n>>8&255,h=255&n;t.bytes.b[r+t.format.ch0]=255&s,t.bytes.b[r+t.format.ch1]=255&a,t.bytes.b[r+t.format.ch2]=255&o,t.bytes.b[r+t.format.ch3]=255&h},$.fillRect=function(t,e,i,n,r,s){var a=i*t.width+e<<2,o=new tt(n,1,!0);o.format=t.format;for(var h=n<<2,u=0,l=n;u<l;){var c=u++;$.setPixel32(o,c,0,s)}for(var g=0,d=r;g<d;){g++;t.bytes.blit(a,o.bytes,0,h),a+=t.width<<2}},$.clone=function(t){var e=new tt(t.width,t.height,!0);return e.bytes.blit(0,t.bytes,0,t.bytes.length),e.format=t.format,e},$.fromBytes=function(t,e,i,n){var r=new tt(e,i,!1);return null==n&&(n=et.ARGB),r.bytes=t,r},$.convertTo=function(t,e){return $.convert(t,e,!0)},$.convert=function(t,e,i){null==i&&(i=!1);var n=i?t:$.clone(t);if(e==t.format)return n;var r=0,s=0;if(t.format==et.BGRA&&e==et.RGBA||t.format==et.RGBA&&e==et.BGRA)for(;r<t.count;){var a=s+1,o=t.bytes.b[(-4&a)+t.format.channelMap[3&a]],h=s+3,u=t.bytes.b[(-4&h)+t.format.channelMap[3&h]];n.bytes.b[s+e.ch1]=255&o,n.bytes.b[s+e.ch3]=255&u,++r,s+=4}else for(;r<t.count;){var l=t.bytes.b[(-4&s)+t.format.channelMap[3&s]],c=s+1,g=t.bytes.b[(-4&c)+t.format.channelMap[3&c]],d=s+2,f=t.bytes.b[(-4&d)+t.format.channelMap[3&d]],p=s+3,_=t.bytes.b[(-4&p)+t.format.channelMap[3&p]];n.bytes.b[s+e.ch0]=255&l,n.bytes.b[s+e.ch1]=255&g,n.bytes.b[s+e.ch2]=255&f,n.bytes.b[s+e.ch3]=255&_,++r,s+=4}return n.format=e,n},$.fromImageData=function(t){var e=new tt(t.width,t.height,!0);e.format=et.ARGB;for(var i=t.data,n=0,r=i.byteLength;n<r;){var s=n++;e.bytes.b[s]=255&i[s]}return e};var tt=function(t,e,i,n){null==i&&(i=!0),this.count=t*e,i&&(this.bytes=new u(new wt(this.count<<2))),this.width=t,this.height=e,this.format=null!=n?n:et.ARGB};tt.__name__=!0,tt.prototype={__class__:tt};var et=t.hxPixels.PixelFormat=function(t,e,i,n,r){null==r&&(r="PixelFormat"),this.channelMap=[t,e,i,n],this.ch0=t,this.ch1=e,this.ch2=i,this.ch3=n,this.name=r};et.__name__=!0,et.prototype={get_A:function(){return this.ch0},get_R:function(){return this.ch1},get_G:function(){return this.ch2},get_B:function(){return this.ch3},toString:function(){return this.name},__class__:et};var it=t.hxPixels._Pixels.Pixel_Impl_={};it.__name__=!0,it.get_A=function(t){return t>>24&255},it.set_A=function(t,e){return t=16777215&t|(e&=255)<<24,e},it.get_R=function(t){return t>>16&255},it.set_R=function(t,e){return t=-16711681&t|(e&=255)<<16,e},it.get_G=function(t){return t>>8&255},it.set_G=function(t,e){return t=-65281&t|(e&=255)<<8,e},it.get_B=function(t){return 255&t},it.set_B=function(t,e){return t=-256&t|(e&=255),e};var nt=function t(e){Error.call(this),this.val=e,this.message=String(e),Error.captureStackTrace&&Error.captureStackTrace(this,t)};nt.__name__=!0,nt.wrap=function(t){return t instanceof Error?t:new nt(t)},nt.__super__=Error,nt.prototype=function(t,e){function i(){}i.prototype=t;var n=new i;for(var r in e)n[r]=e[r];return e.toString!==Object.prototype.toString&&(n.toString=e.toString),n}(Error.prototype,{__class__:nt});var rt=function(){};rt.__name__=!0,rt.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var i=rt.__nativeClassName(t);return null!=i?rt.__resolveNativeClass(i):null},rt.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var i=typeof t;switch("function"==i&&(t.__name__||t.__ename__)&&(i="object"),i){case"function":return"<function>";case"object":if(t instanceof Array){if(t.__enum__){if(2==t.length)return t[0];var n=t[0]+"(";e+="\t";for(var r=2,s=t.length;r<s;){var a=r++;n+=2!=a?","+rt.__string_rec(t[a],e):rt.__string_rec(t[a],e)}return n+")"}var o="[";e+="\t";for(var h=0,u=t.length;h<u;){var l=h++;o+=(l>0?",":"")+rt.__string_rec(t[l],e)}return o+="]"}var c;try{c=t.toString}catch(_){return"???"}if(null!=c&&c!=Object.toString&&"function"==typeof c){var g=t.toString();if("[object Object]"!=g)return g}var d=null,f="{\n";e+="\t";var p=null!=t.hasOwnProperty;for(var d in t)p&&!t.hasOwnProperty(d)||"prototype"!=d&&"__class__"!=d&&"__super__"!=d&&"__interfaces__"!=d&&"__properties__"!=d&&(2!=f.length&&(f+=", \n"),f+=e+d+" : "+rt.__string_rec(t[d],e));return f+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},rt.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var i=t.__interfaces__;if(null!=i)for(var n=0,r=i.length;n<r;){var s=i[n++];if(s==e||rt.__interfLoop(s,e))return!0}return rt.__interfLoop(t.__super__,e)},rt.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case yt:return"boolean"==typeof t;case _t:return!0;case vt:return"number"==typeof t;case pt:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(rt.__interfLoop(rt.getClass(t),e))return!0}else if("object"==typeof e&&rt.__isNativeObj(e)&&t instanceof e)return!0;return e==mt&&null!=t.__name__||(e==xt&&null!=t.__ename__||t.__enum__==e)}},rt.__nativeClassName=function(t){var e=rt.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},rt.__isNativeObj=function(t){return null!=rt.__nativeClassName(t)},rt.__resolveNativeClass=function(t){return e[t]};var st=function(t){if(t instanceof Array&&null==t.__enum__)this.a=t,this.byteLength=t.length;else{var e=t;this.a=[];for(var i=0,n=e;i<n;){var r=i++;this.a[r]=0}this.byteLength=e}};st.__name__=!0,st.sliceImpl=function(t,e){var i=new bt(this,t,null==e?null:e-t),n=new wt(i.byteLength);return new bt(n).set(i),n},st.prototype={slice:function(t,e){return new st(this.a.slice(t,e))},__class__:st};var at=function(){};at.__name__=!0,at._new=function(t,e,i){var n;if("number"==typeof t){n=[];for(var s=0,a=t;s<a;){n[s++]=0}n.byteLength=n.length,n.byteOffset=0,n.buffer=new st(n)}else if(rt.__instanceof(t,st)){var o=t;null==e&&(e=0),null==i&&(i=o.byteLength-e),(n=0==e?o.a:o.a.slice(e,e+i)).byteLength=n.length,n.byteOffset=e,n.buffer=o}else{if(!(t instanceof Array&&null==t.__enum__))throw new nt("TODO "+r.string(t));(n=t.slice()).byteLength=n.length,n.byteOffset=0,n.buffer=new st(n)}return n.subarray=at._subarray,n.set=at._set,n},at._set=function(t,e){if(rt.__instanceof(t.buffer,st)){var i=t;if(t.byteLength+e>this.byteLength)throw new nt("set() outside of range");for(var n=0,r=t.byteLength;n<r;){var s=n++;this[s+e]=i[s]}}else{if(!(t instanceof Array&&null==t.__enum__))throw new nt("TODO");var a=t;if(a.length+e>this.byteLength)throw new nt("set() outside of range");for(var o=0,h=a.length;o<h;){var u=o++;this[u+e]=a[u]}}},at._subarray=function(t,e){var i=at._new(this.slice(t,e));return i.byteOffset=t,i};var ot=t.wings.core.ISimpleDrawingContext=function(){};ot.__name__=!0,ot.prototype={__class__:ot};var ht=t.wings.jsCanvas.BasicCanvas=function(){this.canvas=window.document.createElement("canvas"),this.dom=this.canvas,this.body=window.document.body,this.surface=this.canvas.getContext("2d",null),this.style=this.dom.style,this.header=new ut,this.canvas.width=this.header.width,this.canvas.height=this.header.height,this.style.paddingLeft="0px",this.style.paddingTop="0px",this.style.left=r.string("0px"),this.style.top=r.string("0px"),this.style.position="absolute",this.style.backgroundColor=this.header.bgColor,this.surface.fillStyle=this.header.bgColor,this.image=this.dom;var t=window.document.createElement("style");t.innerHTML="@keyframes spin { from { transform:rotate( 0deg ); } to { transform:rotate( 360deg ); } }",window.document.getElementsByTagName("head")[0].appendChild(t),t.animation="spin 1s linear infinite",this.loop(this.header.frameRate),window.document.body.appendChild(this.dom)};ht.__name__=!0,ht.prototype={loop:function(t){return window.requestAnimationFrame(ft(this,this.loop)),null!=this.onEnterFrame&&this.onEnterFrame(),!0},clear:function(){this.surface.clearRect(0,0,this.header.width,this.header.height)},drawCircle:function(t,e,i){this.surface.beginPath(),this.surface.arc(t,e,i,0,2*Math.PI,!1),this.surface.stroke(),this.surface.closePath()},drawRect:function(t,e,i,n){this.surface.beginPath(),this.surface.moveTo(t,e),this.surface.lineTo(t+i,e),this.surface.lineTo(t+i,e+n),this.surface.lineTo(t,e+n),this.surface.stroke(),this.surface.closePath()},drawTri:function(t){this.surface.beginPath();for(var e=0;e<t.length;)0==e?this.surface.moveTo(t[e],t[e+1]):this.surface.lineTo(t[e],t[e+1]),e+=2;this.surface.stroke(),this.surface.closePath()},lineStyle:function(t,e,i){if(this.surface.lineWidth=t,null!=i&&1!=i){var n=e>>16&255,r=e>>8&255,a=255&e;this.surface.strokeStyle="rgba("+n+","+r+","+a+","+i+")"}else{var o=s.hex(e,6);this.surface.strokeStyle="#"+o}},moveTo:function(t,e){this.surface.beginPath(),this.surface.moveTo(t,e)},lineTo:function(t,e){this.surface.lineTo(t,e),this.surface.closePath(),this.surface.stroke()},quadTo:function(t,e,i,n){this.surface.quadraticCurveTo(t,e,i,n),this.surface.stroke()},beginFill:function(t,e){if(null!=e&&1!=e){var i=t>>16&255,n=t>>8&255,r=255&t;this.surface.fillStyle="rgba("+i+","+n+","+r+","+e+")"}else{var a=s.hex(t,6);this.surface.fillStyle="#"+a}this.surface.beginPath()},endFill:function(){this.surface.stroke(),this.surface.closePath(),this.surface.fill()},__class__:ht};var ut=function(){var t=null.split(":");this.width=r.parseInt(t[0]),this.height=r.parseInt(t[1]),this.frameRate=r.parseInt(t[2]),this.bgColor="#"+t[3]};ut.__name__=!0,ut.prototype={parseInt:function(t){return r.parseInt(t)},toHashColor:function(t){return"#"+t},__class__:ut};var lt=t.wings.jsCanvas.CanvasPixelMatrix=function(t,e,i){this.data=t,this.width=e,this.height=i,this.lookup=[];for(var n=0,r=0,s=this.height;r<s;){var a=r++;this.lookup[a]=[];for(var o=0,h=this.width;o<h;){var u=o++;this.lookup[a][u]=4*n|0,++n}}};lt.__name__=!0,lt.createCanvasPixelMatrixFromContext=function(t,e,i){var n=t.getImageData(0,0,e,i).data;return new lt(n,e,i)},lt.prototype={getPixel32:function(t,e){var i=this.lookup[e][t];return this.data[i+3]<<24|this.data[i]<<16|this.data[i+1]<<8|this.data[i+2]},setPixel32:function(t,e,i){var n=this.lookup[e][t];this.data[n+3]=i>>24&255,this.data[n]=i>>16&255,this.data[n+1]=i>>8&255,this.data[n+2]=255&i},setPixel:function(t,e,i){var n=this.lookup[e][t];this.data[n]=i>>16&255,this.data[n+1]=i>>8&255,this.data[n+2]=255&i},getPixel:function(t,e){var i=this.lookup[e][t];return this.data[i]<<16|this.data[i+1]<<8|this.data[i+2]},__class__:lt};var ct=t.wings.jsCanvas.ImageLoader=function(t,e){this.images=new h,this.loaded=e,this.count=t.length;for(var i=0;i<t.length;){var n=t[i];++i,this.load(n)}};ct.__name__=!0,ct.prototype={load:function(t){var e=window.document.createElement("img"),i=e.style;i.left="0px",i.top="0px",i.paddingLeft="0px",i.paddingTop="0px";var n=ft(this,this.store),r=e,s=t.split("/").pop();e.onload=function(t){n(r,s,t)},i.position="absolute",e.src=t},store:function(t,e,i){this.count--;var n=this.images;null!=Mt[e]?n.setReserved(e,t):n.h[e]=t,0==this.count&&this.loaded()},__class__:ct};var gt=t.wings.jsCanvas.SimpleDrawingContext=function(t){this.graphics=t};gt.__name__=!0,gt.__interfaces__=[ot],gt.prototype={clear:function(){this.graphics.clear()},lineStyle:function(t,e,i){null==i&&(i=1),this.graphics.lineStyle(t,e,i)},beginFill:function(t,e){null==e&&(e=1),this.graphics.beginFill(t,e)},endFill:function(){this.graphics.endFill()},moveTo:function(t,e){this.graphics.moveTo(t,e)},lineTo:function(t,e){this.graphics.lineTo(t,e)},quadTo:function(t,e,i,n){this.graphics.quadTo(t,e,i,n)},drawCircle:function(t,e,i){this.graphics.drawCircle(t,e,i)},drawRect:function(t,e,i,n){this.graphics.drawRect(t,e,i,n)},drawEquilaterialTri:function(t,e,i,n){for(var r,s,a=2*Math.PI/3,o=[],h=0;h<3;){var u=h++;r=t+i*Math.cos(n+u*a),s=e+i*Math.sin(n+u*a),o.push(r),o.push(s)}this.graphics.drawTri(o)},drawTri:function(t){this.graphics.drawTri(t)},__class__:gt};var dt=0;function ft(t,e){return null==e?null:(null==e.__id__&&(e.__id__=dt++),null==t.hx__closures__?t.hx__closures__={}:i=t.hx__closures__[e.__id__],null==i&&(i=function(){return i.method.apply(i.scope,arguments)},i.scope=t,i.method=e,t.hx__closures__[e.__id__]=i),i);var i}String.prototype.__class__=String,String.__name__=!0,Array.__name__=!0;var pt={__name__:["Int"]},_t={__name__:["Dynamic"]},vt=Number;vt.__name__=["Float"];var yt=Boolean;yt.__ename__=["Bool"];var mt={__name__:["Class"]},xt={},Mt={};et.ARGB=new et(0,1,2,3,"ARGB"),et.RGBA=new et(3,0,1,2,"RGBA"),et.BGRA=new et(3,2,1,0,"BGRA");var wt=e.ArrayBuffer||st;null==wt.prototype.slice&&(wt.prototype.slice=st.sliceImpl);var bt=e.Uint8Array||at._new;o.count=0,g.NUM_SEGMENTS=6,v.EPSILON=.01,v.EPSILON_SQUARED=1e-4,y.INC=0,m.INC=0,x.INC=0,M.INC=0,w.INC=0,b.INC=0,E.INC=0,S.INC=0,C.INC=0,k.INC=0,R.__samples=[],R.__circumcenter=new D,A.MAX_INT=2147483647,A.maxDistance=1,$.CHANNEL_MASK=3,tt.BYTES_PER_PIXEL=4,rt.__toStr={}.toString,at.BYTES_PER_ELEMENT=1,ut.__meta__={fields:{parseInt:{static:null},toHashColor:{static:null}}}}(e,"undefined"!=typeof window?window:"undefined"!=typeof i.g?i.g:"undefined"!=typeof self?self:this)},5777:function(t,e,i){var n=i(9743).hxDaedalus,r=n.factories.RectMesh,s=n.ai.EntityAI,a=n.ai.PathFinder,o=n.data.Object;function h(t,e){var i=r.buildRectangle(t,e),n=new s,o=new a;o.entity=n,o.set_mesh(i),this.mesh=i,this.entity=n,this.pathFinder=o,this.path=[]}h.prototype.addRect=function(t,e,i,n){var r=new o;return r.set_coordinates([0,0,0,e,0,e,t,e,t,e,t,0,t,0,0,0]),r.set_x(i),r.set_y(n),this.mesh.insertObject(r),r},h.prototype.addPolygon=function(t,e,i){if(!(t.length<6)){for(var n=new o,r=[],s=t[t.length-2],a=t[t.length-1],h=0;h<t.length;h+=2){var u=t[h],l=t[h+1];r.push(s,a,u,l),s=u,a=l}return n.set_coordinates(r),n.set_x(e||0),n.set_y(i||0),this.mesh.insertObject(n),n}console.log("Polygons must contain at least 3 points!")},h.prototype.addPolyline=function(t,e,i){if(!(t.length<4)){for(var n=new o,r=[],s=0,a=0,h=0;h<t.length;h+=2){var u=t[h],l=t[h+1];h>0&&r.push(s,a,u,l),s=u,a=l}return n.set_coordinates(r),n.set_x(e||0),n.set_y(i||0),this.mesh.insertObject(n),n}console.log("Polylines must contain at least 2 points!")},h.prototype.deleteObstacle=function(t){this.mesh.deleteObject(t)},h.prototype.findPath=function(t,e,i,n,r,s){return void 0===s&&(s=this.path),this.entity.set_radius(r),this.entity.x=t,this.entity.y=e,this.pathFinder.findPath(i,n,s),s},t.exports=h},3897:function(t){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n},t.exports.__esModule=!0,t.exports.default=t.exports},5372:function(t){t.exports=function(t){if(Array.isArray(t))return t},t.exports.__esModule=!0,t.exports.default=t.exports},3405:function(t,e,i){var n=i(3897);t.exports=function(t){if(Array.isArray(t))return n(t)},t.exports.__esModule=!0,t.exports.default=t.exports},6115:function(t){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t},t.exports.__esModule=!0,t.exports.default=t.exports},6690:function(t){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.__esModule=!0,t.exports.default=t.exports},9728:function(t){function e(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}t.exports=function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t},t.exports.__esModule=!0,t.exports.default=t.exports},4704:function(t,e,i){var n=i(6116);t.exports=function(t,e){var i="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=n(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var r=0,s=function(){};return{s:s,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,h=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return o=t.done,t},e:function(t){h=!0,a=t},f:function(){try{o||null==i.return||i.return()}finally{if(h)throw a}}}},t.exports.__esModule=!0,t.exports.default=t.exports},6389:function(t,e,i){var n=i(3808),r=i(9617),s=i(4993);t.exports=function(t){var e=r();return function(){var i,r=n(t);if(e){var a=n(this).constructor;i=Reflect.construct(r,arguments,a)}else i=r.apply(this,arguments);return s(this,i)}},t.exports.__esModule=!0,t.exports.default=t.exports},1588:function(t,e,i){var n=i(1753);function r(){return"undefined"!==typeof Reflect&&Reflect.get?(t.exports=r=Reflect.get.bind(),t.exports.__esModule=!0,t.exports.default=t.exports):(t.exports=r=function(t,e,i){var r=n(t,e);if(r){var s=Object.getOwnPropertyDescriptor(r,e);return s.get?s.get.call(arguments.length<3?t:i):s.value}},t.exports.__esModule=!0,t.exports.default=t.exports),r.apply(this,arguments)}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},3808:function(t){function e(i){return t.exports=e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},1655:function(t,e,i){var n=i(6015);t.exports=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&n(t,e)},t.exports.__esModule=!0,t.exports.default=t.exports},9617:function(t){t.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}},t.exports.__esModule=!0,t.exports.default=t.exports},9498:function(t){t.exports=function(t){if("undefined"!==typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)},t.exports.__esModule=!0,t.exports.default=t.exports},8872:function(t){t.exports=function(t,e){var i=null==t?null:"undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var n,r,s=[],a=!0,o=!1;try{for(i=i.call(t);!(a=(n=i.next()).done)&&(s.push(n.value),!e||s.length!==e);a=!0);}catch(h){o=!0,r=h}finally{try{a||null==i.return||i.return()}finally{if(o)throw r}}return s}},t.exports.__esModule=!0,t.exports.default=t.exports},2218:function(t){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},2281:function(t){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.__esModule=!0,t.exports.default=t.exports},4993:function(t,e,i){var n=i(8698).default,r=i(6115);t.exports=function(t,e){if(e&&("object"===n(e)||"function"===typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return r(t)},t.exports.__esModule=!0,t.exports.default=t.exports},7061:function(t,e,i){var n=i(8698).default;function r(){"use strict";t.exports=r=function(){return e},t.exports.__esModule=!0,t.exports.default=t.exports;var e={},i=Object.prototype,s=i.hasOwnProperty,a="function"==typeof Symbol?Symbol:{},o=a.iterator||"@@iterator",h=a.asyncIterator||"@@asyncIterator",u=a.toStringTag||"@@toStringTag";function l(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{l({},"")}catch(I){l=function(t,e,i){return t[e]=i}}function c(t,e,i,n){var r=e&&e.prototype instanceof f?e:f,s=Object.create(r.prototype),a=new C(n||[]);return s._invoke=function(t,e,i){var n="suspendedStart";return function(r,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw s;return P()}for(i.method=r,i.arg=s;;){var a=i.delegate;if(a){var o=b(a,i);if(o){if(o===d)continue;return o}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var h=g(t,e,i);if("normal"===h.type){if(n=i.done?"completed":"suspendedYield",h.arg===d)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(n="completed",i.method="throw",i.arg=h.arg)}}}(t,i,a),s}function g(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(I){return{type:"throw",arg:I}}}e.wrap=c;var d={};function f(){}function p(){}function _(){}var v={};l(v,o,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(k([])));m&&m!==i&&s.call(m,o)&&(v=m);var x=_.prototype=f.prototype=Object.create(v);function M(t){["next","throw","return"].forEach((function(e){l(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function i(r,a,o,h){var u=g(t[r],t,a);if("throw"!==u.type){var l=u.arg,c=l.value;return c&&"object"==n(c)&&s.call(c,"__await")?e.resolve(c.__await).then((function(t){i("next",t,o,h)}),(function(t){i("throw",t,o,h)})):e.resolve(c).then((function(t){l.value=t,o(l)}),(function(t){return i("throw",t,o,h)}))}h(u.arg)}var r;this._invoke=function(t,n){function s(){return new e((function(e,r){i(t,n,e,r)}))}return r=r?r.then(s,s):s()}}function b(t,e){var i=t.iterator[e.method];if(void 0===i){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return d;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=g(i,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,d;var r=n.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,d):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,d)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function S(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function k(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(s.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return p.prototype=_,l(x,"constructor",_),l(_,"constructor",p),p.displayName=l(_,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,l(t,u,"GeneratorFunction")),t.prototype=Object.create(x),t},e.awrap=function(t){return{__await:t}},M(w.prototype),l(w.prototype,h,(function(){return this})),e.AsyncIterator=w,e.async=function(t,i,n,r,s){void 0===s&&(s=Promise);var a=new w(c(t,i,n,r),s);return e.isGeneratorFunction(i)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},M(x),l(x,u,"Generator"),l(x,o,(function(){return this})),l(x,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},e.values=k,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!t)for(var e in this)"t"===e.charAt(0)&&s.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,n){return a.type="throw",a.arg=t,e.next=i,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n],a=r.completion;if("root"===r.tryLoc)return i("end");if(r.tryLoc<=this.prev){var o=s.call(r,"catchLoc"),h=s.call(r,"finallyLoc");if(o&&h){if(this.prev<r.catchLoc)return i(r.catchLoc,!0);if(this.prev<r.finallyLoc)return i(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return i(r.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return i(r.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&s.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=t,a.arg=e,r?(this.method="next",this.next=r.finallyLoc,d):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),d},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),S(i),d}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;S(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:k(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=void 0),d}},e}t.exports=r,t.exports.__esModule=!0,t.exports.default=t.exports},6015:function(t){function e(i,n){return t.exports=e=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i,n)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},7424:function(t,e,i){var n=i(5372),r=i(8872),s=i(6116),a=i(2218);t.exports=function(t,e){return n(t)||r(t,e)||s(t,e)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},1753:function(t,e,i){var n=i(3808);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=n(t)););return t},t.exports.__esModule=!0,t.exports.default=t.exports},861:function(t,e,i){var n=i(3405),r=i(9498),s=i(6116),a=i(2281);t.exports=function(t){return n(t)||r(t)||s(t)||a()},t.exports.__esModule=!0,t.exports.default=t.exports},8698:function(t){function e(i){return t.exports=e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t.exports.__esModule=!0,t.exports.default=t.exports,e(i)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports},6116:function(t,e,i){var n=i(3897);t.exports=function(t,e){if(t){if("string"===typeof t)return n(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?n(t,e):void 0}},t.exports.__esModule=!0,t.exports.default=t.exports}},e={};function i(n){var r=e[n];if(void 0!==r)return r.exports;var s=e[n]={exports:{}};return t[n].call(s.exports,s,s.exports,i),s.exports}i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,{a:e}),e},i.d=function(t,e){for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}(),i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(){e=function(){return i};var i={},n=Object.prototype,r=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",h=s.toStringTag||"@@toStringTag";function u(t,e,i){return Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(P){u=function(t,e,i){return t[e]=i}}function l(t,e,i,n){var r=e&&e.prototype instanceof d?e:d,s=Object.create(r.prototype),a=new S(n||[]);return s._invoke=function(t,e,i){var n="suspendedStart";return function(r,s){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw s;return k()}for(i.method=r,i.arg=s;;){var a=i.delegate;if(a){var o=w(a,i);if(o){if(o===g)continue;return o}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===n)throw n="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n="executing";var h=c(t,e,i);if("normal"===h.type){if(n=i.done?"completed":"suspendedYield",h.arg===g)continue;return{value:h.arg,done:i.done}}"throw"===h.type&&(n="completed",i.method="throw",i.arg=h.arg)}}}(t,i,a),s}function c(t,e,i){try{return{type:"normal",arg:t.call(e,i)}}catch(P){return{type:"throw",arg:P}}}i.wrap=l;var g={};function d(){}function f(){}function p(){}var _={};u(_,a,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(C([])));y&&y!==n&&r.call(y,a)&&(_=y);var m=p.prototype=d.prototype=Object.create(_);function x(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function M(e,i){function n(s,a,o,h){var u=c(e[s],e,a);if("throw"!==u.type){var l=u.arg,g=l.value;return g&&"object"==t(g)&&r.call(g,"__await")?i.resolve(g.__await).then((function(t){n("next",t,o,h)}),(function(t){n("throw",t,o,h)})):i.resolve(g).then((function(t){l.value=t,o(l)}),(function(t){return n("throw",t,o,h)}))}h(u.arg)}var s;this._invoke=function(t,e){function r(){return new i((function(i,r){n(t,e,i,r)}))}return s=s?s.then(r,r):r()}}function w(t,e){var i=t.iterator[e.method];if(void 0===i){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return g;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var n=c(i,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,g;var r=n.arg;return r?r.done?(e[t.resultName]=r.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,g):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,g)}function b(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(b,this),this.reset(!0)}function C(t){if(t){var e=t[a];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,n=function e(){for(;++i<t.length;)if(r.call(t,i))return e.value=t[i],e.done=!1,e;return e.value=void 0,e.done=!0,e};return n.next=n}}return{next:k}}function k(){return{value:void 0,done:!0}}return f.prototype=p,u(m,"constructor",p),u(p,"constructor",f),f.displayName=u(p,h,"GeneratorFunction"),i.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===f||"GeneratorFunction"===(e.displayName||e.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,u(t,h,"GeneratorFunction")),t.prototype=Object.create(m),t},i.awrap=function(t){return{__await:t}},x(M.prototype),u(M.prototype,o,(function(){return this})),i.AsyncIterator=M,i.async=function(t,e,n,r,s){void 0===s&&(s=Promise);var a=new M(l(t,e,n,r),s);return i.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},x(m),u(m,h,"Generator"),u(m,a,(function(){return this})),u(m,"toString",(function(){return"[object Generator]"})),i.keys=function(t){var e=[];for(var i in t)e.push(i);return e.reverse(),function i(){for(;e.length;){var n=e.pop();if(n in t)return i.value=n,i.done=!1,i}return i.done=!0,i}},i.values=C,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function i(i,n){return a.type="throw",a.arg=t,e.next=i,n&&(e.method="next",e.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var o=r.call(s,"catchLoc"),h=r.call(s,"finallyLoc");if(o&&h){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(o){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!h)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var i=this.tryEntries.length-1;i>=0;--i){var n=this.tryEntries[i];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var s=n;break}}s&&("break"===t||"continue"===t)&&s.tryLoc<=e&&e<=s.finallyLoc&&(s=null);var a=s?s.completion:{};return a.type=t,a.arg=e,s?(this.method="next",this.next=s.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.finallyLoc===t)return this.complete(i.completion,i.afterLoc),E(i),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var i=this.tryEntries[e];if(i.tryLoc===t){var n=i.completion;if("throw"===n.type){var r=n.arg;E(i)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,i){return this.delegate={iterator:C(t),resultName:e,nextLoc:i},"next"===this.method&&(this.arg=void 0),g}},i}function n(t,e,i,n,r,s,a){try{var o=t[s](a),h=o.value}catch(u){return void i(u)}o.done?e(h):Promise.resolve(h).then(n,r)}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function s(t,e){var i="undefined"!==typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(i)return(i=i.call(t)).next.bind(i);if(Array.isArray(t)||(i=function(t,e){if(t){if("string"===typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(t,e):void 0}}(t))||e&&t&&"number"===typeof t.length){i&&(t=i);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function a(t,e){if(isNaN(t)||t<=0)throw new Error('"'+e+'" must be a positive integer, but was '+t+" ("+typeof t+")")}var o=1e-10;function h(t,e,i){return Math.abs(e-t)<Math.abs(i-t)?e:i}function u(t,e,i,n,r,s){return{x:h(r,t,t+i),y:h(s,e,e+n)}}function l(t,e,i,n,r,s,a,o,h,u){for(var l,c,g,d,f,p=isNaN(h)?0:h,_=isNaN(u)?1:u,v=a-r,y=o-s,m=0,x=0,M=0,w=0,b=0,E=[1,2,3,4];b<E.length;b++){var S=E[b];if(1===S?(l=-1,c=0,g=-v,d=r-t):2===S?(l=1,c=0,g=v,d=t+i-r):3===S?(l=0,c=-1,g=-y,d=s-e):(l=0,c=1,g=y,d=e+n-s),0===g){if(d<=0)return[void 0,void 0,void 0,void 0,void 0,void 0]}else if(f=d/g,g<0){if(f>_)return[void 0,void 0,void 0,void 0,void 0,void 0];f>p&&(p=f,m=l,x=c)}else{if(f<p)return[void 0,void 0,void 0,void 0,void 0,void 0];f<_&&(_=f,M=l,w=c)}}return[p,_,m,x,M,w]}function c(t,e,i,n,r,s,a,o){return{x:r-t-i,y:s-e-n,w:i+a,h:n+o}}function g(t,e,i,n,r,s){return r-t>o&&s-e>o&&t+i-r>o&&e+n-s>o}function d(t,e,i,n,r,s,a,o){return t<r+a&&r<t+i&&e<s+o&&s<e+n}function f(t,e,i,n,r,s,a,o){var h=t-r+(i-a)/2,u=e-s+(n-o)/2;return h*h+u*u}function p(t,e,i,n,r,s,a,h,d,f){var p,_,v,y,m=(isNaN(d)?t:d)-t,x=(isNaN(f)?e:f)-e,M=c(t,e,i,n,r,s,a,h),w=M.x,b=M.y,E=M.w,S=M.h;if(g(w,b,E,S,0,0)){var C=u(w,b,E,S,0,0),k=C.x,P=C.y;y=-Math.min(i,Math.abs(k))*Math.min(n,Math.abs(P)),p=!0}else{var I=l(w,b,E,S,0,0,m,x,-Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),D=I[0],R=I[1],T=I[2],L=I[3];!isNaN(D)&&D<1&&Math.abs(D-(R||0))>=o&&(0<D+o||0===D&&(R||0)>0)&&(y=D,_=T,v=L,p=!1)}if(!isNaN(y)){var A,V;if(p)if(0===m&&0===x){var O=u(w,b,E,S,0,0),F=O.x,N=O.y;Math.abs(F)<Math.abs(N)?N=0:F=0,_=Math.sign(F),v=Math.sign(N),A=t+F,V=e+N}else{var j=l(w,b,E,S,0,0,m,x,-Number.MAX_SAFE_INTEGER,1),B=j[0];if(_=j[2],v=j[3],!B)return;A=t+m*B,V=e+x*B}else A=t+m*y,V=e+x*y;return{overlaps:p,ti:y,move:{x:m,y:x},normal:{x:_,y:v},touch:{x:A,y:V},itemRect:{x:t,y:e,w:i,h:n},otherRect:{x:r,y:s,w:a,h:h}}}}function _(t,e,i){return[Math.floor(e/t)+1,Math.floor(i/t)+1]}function v(t,e,i,n){var r=n-i;return r>0?[1,t/r,((e+r)*t-i)/r]:r<0?[-1,-t/r,((e+r-1)*t-i)/r]:[0,Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER]}function y(t,e,i,n,r){var s=_(t,e,i),a=s[0],o=s[1];return[a,o,Math.ceil((e+n)/t)-a+1,Math.ceil((i+r)/t)-o+1]}function m(t,e,i){if(typeof e!==t)throw new Error('"'+i+'" must be a '+t+", but was a "+e+" ("+typeof e+")")}function x(t,e,i,n){m("number",t,"x"),m("number",e,"y"),a(i,"w"),a(n,"h")}function M(t,e,i,n,r,s,a,o,h){return{x:e.touch.x,y:e.touch.y,collisions:[]}}function w(t,e,i,n,r,s,a,o,h){return{x:a,y:o,collisions:t.project(e.item,i,n,r,s,a,o,h)}}function b(t,e,i,n,r,s,a,o,h){var u=isNaN(a)?i:a,l=isNaN(o)?n:o,c=e.touch,g=e.move;0===g.x&&0===g.y||(0!==e.normal.x?u=c.x:l=c.y),e.slide={x:u,y:l};var d=c.x,f=c.y;return{x:u,y:l,collisions:t.project(e.item,d,f,r,s,u,l,h)}}function E(t,e,i,n,r,s,a,o,h){var u=isNaN(a)?i:a,l=isNaN(o)?n:o,c=e.touch,g=e.move,d=c.x,f=c.y;if(0!==g.x||0!==g.y){var p=u-c.x,_=l-c.y;0===e.normal.x?_=-_:p=-p,d=c.x+p,f=c.y+_}return e.bounce={x:d,y:f},{x:d,y:f,collisions:t.project(e.item,c.x,c.y,r,s,d,f,h)}}function S(t,e){if(t.ti===e.ti){var i=t.itemRect,n=t.otherRect,r=e.otherRect;return f(i.x,i.y,i.w,i.h,n.x,n.y,n.w,n.h)-f(i.x,i.y,i.w,i.h,r.x,r.y,r.w,r.h)}return t.ti-e.ti}function C(){return"slide"}function k(t,e){return t.weight-e.weight}function P(t,e,i,n,r){var s=[],a={};return function(t,e,i,n,r,s){var a=_(t,e,i),o=a[0],h=a[1],u=_(t,n,r),l=u[0],c=u[1],g=v(t,o,e,n),d=g[0],f=g[1],p=g[2],y=v(t,h,i,r),m=y[0],x=y[1],M=y[2],w=o,b=h;s(w,b);do{if(p<M){var E=[p+f,w+d];p=E[0],s(w=E[1],b)}else p==M&&s(w+d,b),M+=x,s(w,b+=m)}while(Math.abs(w-l)+Math.abs(b-c)>1);w==l&&b==c||s(l,c)}(t.cellSize,e,i,n,r,(function(e,i){var n=t.rows[i];if(n){var r=n[e];r&&!a[r.ID]&&(a[r.ID]=!0,s.push(r))}})),s}function I(t,e,i,n,r,a){for(var o,h,u,c,g,d,f,p,_={},v=[],y=s(P(t,e,i,n,r));!(p=y()).done;){var m=p.value;if(null!=m&&m.items)for(var x=0,M=Object.keys(m.items);x<M.length;x++){var w=M[x];if(!_[w]&&(_[w]=!0,!a||a(w))){var b=l(h=(o=t.rects[w]).x,u=o.y,c=o.w,g=o.h,e,i,n,r,0,1);if(d=b[0],f=b[1],!isNaN(d)&&(0<d&&d<1||0<f&&f<1)){var E=l(h,u,c,g,e,i,n,r,-Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER),S=E[0],C=E[1];v.push({item:w,ti1:d,ti2:f,weight:Math.min(S||0,C||0)})}}}}return v.sort(k)}var D=function(){function t(t){this.responses={},this.cellSize=0,this.cellSize=t.cellSize,this.rects=t.rects,this.rows=t.rows,this.nonEmptyCells=t.nonEmptyCells,this.responses=t.responses}var e=t.prototype;return e.addResponse=function(t,e){this.responses[t]=e},e.getResponseByName=function(t){var e=this.responses[t];if(!e)throw new Error("Unknown collision type: "+t+" ("+typeof t+")");return e},e.project=function(t,e,i,n,r,s,a,o){x(e,i,n,r);var h=isNaN(s)?e:s,u=isNaN(a)?i:a,l=o||C,c=[],g={};t&&(g[t]=!0);for(var d=Math.min(h,e),f=Math.min(u,i),_=Math.max(h+n,e+n)-d,v=Math.max(u+r,i+r)-f,m=y(this.cellSize,d,f,_,v),M=m[0],w=m[1],b=m[2],E=m[3],k=this.getDictItemsInCellRect(M,w,b,E),P=0,I=Object.keys(k);P<I.length;P++){var D=I[P];if(!g[D]){g[D]=!0;var R=l(t,D);if(R&&this.hasItem(D)){var T=this.getRect(D),L=p(e,i,n,r,T.x,T.y,T.w,T.h,h,u);L&&(L.other=D,L.item=t,L.type=R,c.push(L))}}}return c.sort(S)},e.countCells=function(){for(var t,e=0,i=s(this.rows.filter((function(t){return!!t})));!(t=i()).done;)for(var n,r=s(t.value);!(n=r()).done;){n.value&&e++}return e},e.hasItem=function(t){return!!this.rects[t]},e.getItems=function(){var t=this;return Object.keys(this.rects).map((function(e){return t.rects[e]}))},e.countItems=function(){return Object.keys(this.rects).length},e.addItemToCell=function(t,e,i){this.rows[i]=this.rows[i]||[];var n=this.rows[i];n[e]||(n[e]={ID:"Cell_"+Math.ceil(Math.random()*Date.now()).toString(36),x:e,y:i,items:{}});var r=n[e];this.nonEmptyCells[r.ID]=!0,r.items[t]||(r.items[t]=!0)},e.getRect=function(t){var e=this.rects[t];if(!e)throw new Error('Item "'+t+'" must be added to the world before getting its rect. Use world:add(item, x,y,w,h) to add it first.');return{x:e.x,y:e.y,w:e.w,h:e.h}},e.getDictItemsInCellRect=function(t,e,i,n){for(var r={},s=e;s<=e+n-1;s++){var a=this.rows[s];if(a)for(var o=t;o<=t+i-1;o++){var h,u=a[o];if(null!=u&&u.items&&(null==(h=Object.keys(u.items))?void 0:h.length)>0)for(var l=0,c=Object.keys(u.items);l<c.length;l++){r[c[l]]=!0}}}return r},e.removeItemFromCell=function(t,e,i){var n,r,s,a=this.rows[i];if(null==a||null==(n=a[e])||null==(r=n.items)||!r[t])return!1;var o=a[e];return delete o.items[t],0===(null==(s=Object.keys(o.items))?void 0:s.length)&&delete this.nonEmptyCells[o.ID],!0},e.toWorld=function(t,e){return function(t,e,i){return[(e-1)*t,(i-1)*t]}(this.cellSize,t,e)},e.toCell=function(t,e){return _(this.cellSize,t,e)},e.queryRect=function(t,e,i,n,r){x(t,e,i,n);for(var s=y(this.cellSize,t,e,i,n),a=s[0],o=s[1],h=s[2],u=s[3],l=this.getDictItemsInCellRect(a,o,h,u),c=[],g=0,f=Object.keys(l);g<f.length;g++){var p=f[g];r&&!r(p)||!d(t,e,i,n,this.rects[p].x,this.rects[p].y,this.rects[p].w,this.rects[p].h)||c.push(p)}return c},e.queryPoint=function(t,e,i){for(var n=this.toCell(t,e),r=n[0],s=n[1],a=this.getDictItemsInCellRect(r,s,1,1),o=[],h=0,u=Object.keys(a);h<u.length;h++){var l=u[h];i&&!i(l)||!g(this.rects[l].x,this.rects[l].y,this.rects[l].w,this.rects[l].h,t,e)||o.push(l)}return o},e.querySegment=function(t,e,i,n,r){var a=I(this,t,e,i,n,r),o=[];if(a)for(var h,u=s(a);!(h=u()).done;){var l=h.value;o.push(l.item)}return o},e.querySegmentWithCoords=function(t,e,i,n,r){for(var a,o,h,u,l=I(this,t,e,i,n,r),c=i-t,g=n-e,d=s(l);!(u=d()).done;){o=(a=u.value).ti1,h=a.ti2,a.weight=null,a.x1=t+c*o,a.y1=e+g*o,a.x2=t+c*h,a.y2=e+g*h}return l},e.add=function(t,e,i,n,r){if(this.rects[t])throw new Error('Item "'+t+'" added to the world twice.');x(e,i,n,r),this.rects[t]={x:e,y:i,w:n,h:r};for(var s=y(this.cellSize,e,i,n,r),a=s[0],o=s[1],h=s[2],u=s[3],l=o;l<o+u;l++)for(var c=a;c<a+h;c++)this.addItemToCell(t,c,l);return t},e.remove=function(t){var e=JSON.parse(JSON.stringify(this.getRect(t)));delete this.rects[t];for(var i=y(this.cellSize,e.x,e.y,e.w,e.h),n=i[0],r=i[1],s=i[2],a=i[3],o=r;o<r+a;o++)for(var h=n;h<n+s;h++)this.removeItemFromCell(t,h,o)},e.update=function(t,e,i,n,r){var s=this.getRect(t);if(x(e,i,n=isNaN(n)?s.w:n,r=isNaN(r)?s.h:r),s.x!=e||s.y!=i||s.w!=n||s.h!=r){var a=y(this.cellSize,s.x,s.y,s.w,s.h),o=a[0],h=a[1],u=a[2],l=a[3],c=y(this.cellSize,e,i,n,r),g=c[0],d=c[1],f=c[2],p=c[3];if(o!=g||h!=d||u!=f||l!=p){for(var _,v=o+u-1,m=h+l-1,M=g+f-1,w=d+p-1,b=h;b<=m;b++){_=Number(b)<d||b>w;for(var E=o;E<=v;E++)(_||E<g||E>M)&&this.removeItemFromCell(t,E,b)}for(var S=d;S<=w;S++){_=S<h||S>m;for(var C=g;C<=M;C++)(_||C<o||C>v)&&this.addItemToCell(t,C,S)}}var k=this.rects[t];k.x=e,k.y=i,k.w=n,k.h=r}},e.move=function(t,e,i,n){var r=this.check(t,e,i,n),s=r.x,a=r.y,o=r.collisions;return this.update(t,s,a),{x:s,y:a,collisions:o}},e.check=function(t,e,i,n){var r,s=e,a=i,o=n||C,h={};h[t]=!0;for(var u=function(t,e){return!h[e]&&o(t,e)},l=[],c=this.getRect(t),g=this.project(t,c.x,c.y,c.w,c.h,s,a,u),d=(null==(r=g)?void 0:r.length)||0;d>0;){var f=g[0];l.push(f),h[f.other]=!0;var p=this.getResponseByName(f.type)(this,f,c.x,c.y,c.w,c.h,s,a,u),_=p.x,v=p.y,y=p.collisions;s=_,a=v,g=y,d=(null==y?void 0:y.length)||0}return{x:s,y:a,collisions:l}},t}(),R={newWorld:function(t){a(t=t||64,"cellSize");var e=new D({cellSize:t,rects:{},rows:[],nonEmptyCells:{},responses:{}});return e.addResponse("touch",M),e.addResponse("cross",w),e.addResponse("slide",b),e.addResponse("bounce",E),e},rect:{getNearestCorner:u,getSegmentIntersectionIndices:l,getDiff:c,containsPoint:g,isIntersecting:d,getSquareDistance:f,detectCollision:p},responses:{touch:M,cross:w,slide:b,bounce:E}},T=Object.freeze(R),L=i(7530),A=i(5547),V=i(3192),O=i(5777),F=i.n(O);function N(t,e,i,n){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function B(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function z(t,e,i){return e&&B(t.prototype,e),i&&B(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function G(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function W(t,e){return W=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},W(t,e)}function H(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&W(t,e)}function X(t){return X=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},X(t)}function Y(e,i){if(i&&("object"===t(i)||"function"===typeof i))return i;if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");return G(e)}function U(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=X(t);if(e){var r=X(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return Y(this,i)}}function q(t,e,i,n,r){var s={};return Object.keys(n).forEach((function(t){s[t]=n[t]})),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce((function(i,n){return n(t,e,i)||i}),s),r&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(r):void 0,s.initializer=void 0),void 0===s.initializer&&(Object.defineProperty(t,e,s),s=null),s}var Z,K,J,Q,$,tt,et,it,nt,rt,st,at,ot,ht,ut,lt,ct,gt,dt,ft,pt,_t=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).hp=void 0,t.maxHP=void 0,t}return z(i,[{key:"setHp",value:function(t){this.hp=t}},{key:"setMaxHP",value:function(t){this.maxHP=t}}]),i}(L.wA),vt=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).direction=new A.Vector2(0,0),t.speed=void 0,t.active=!1,t}return z(i,[{key:"setDirection",value:function(t,e){this.direction.set(t,e)}},{key:"setSpeed",value:function(t){this.speed=t}},{key:"setActive",value:function(t){this.active=t}}]),i}(L.wA),yt=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).target=new A.Vector2,t.path=[],t.index=-1,t.active=!1,t}return z(i,[{key:"setActive",value:function(t){this.active=t}},{key:"setTarget",value:function(t,e){this.target.set(t,e),this.active=!0,this.index=-1,this.path.length=0}}]),i}(L.wA),mt=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).target=-1,t.cooldownRequired=0,t.cooldownLeft=0,t}return z(i)}(L.wA),xt=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).pos=new A.Vector2(0,0),t.radius=0,t}return z(i,[{key:"setPos",value:function(t,e){this.pos.set(t,e)}},{key:"setRadius",value:function(t){this.radius=t}},{key:"setRotation",value:function(t){this.pos.rotate(t)}}]),i}(L.wA),Mt=z((function t(){j(this,t)}));Mt.MAP_WIDTH=320,Mt.MAP_HEIGHT=320,Mt.MAP_GRID_COLS=20,Mt.MAP_GRID_ROWS=20,Mt.CELL_WIDTH=Mt.MAP_WIDTH/Mt.MAP_GRID_COLS,Mt.CELL_HEIGHT=Mt.MAP_HEIGHT/Mt.MAP_GRID_ROWS,Mt.MAX_COUNT_MAP=3;var wt,bt,Et,St,Ct,kt,Pt,It,Dt,Rt,Tt,Lt,At,Vt,Ot,Ft,Nt,jt,Bt,zt,Gt,Wt=(Z=(0,L.tB)("bumpWorld"),K=(0,L.tB)("gameConfig"),J=(0,L.tB)("port"),Q=(0,L.tB)("layersMapRender"),$=(0,L.tB)("obstacles"),tt=(0,L.tB)("mapData"),et=(0,L.tB)("tempEnemyPos"),it=(0,L.tB)("gameState"),nt=(0,L.tB)("walkable"),rt=(0,L.tB)("walkableRect"),st=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"bumpWorld",at,G(t)),N(t,"gameConfig",ot,G(t)),N(t,"port",ht,G(t)),N(t,"layersMapRender",ut,G(t)),N(t,"obstacles",lt,G(t)),N(t,"mapData",ct,G(t)),N(t,"tempEnemyPos",gt,G(t)),N(t,"gameState",dt,G(t)),N(t,"walkable",ft,G(t)),N(t,"walkableRect",pt,G(t)),t.reload=!1,t.realNextMapPosY=0,t.realPreMapPosY=0,t.offsetTileMap=10,t.spartialPlayer=new A.Vector2,t.tempVec2=new A.Vector2,t.tempboolean=!1,t}return z(i,[{key:"initialized",value:function(){}},{key:"process",value:function(){var t=this.bumpWorld.getRect("player");if(this.spartialPlayer.set(t.x+t.w/2,t.y+t.h/2),this.gameConfig.mapNumber>1&&Math.abs(t.x-(this.port.preMap.x-5))<=this.offsetTileMap/1.5&&Math.abs(t.y-(Mt.MAP_HEIGHT-this.port.preMap.y+this.offsetTileMap+10))<=this.offsetTileMap/1.5){this.gameConfig.mapNumber--;for(var e=0;e<this.layersMapRender.obstacle.length;e++)this.layersMapRender.obstacle[e]&&this.bumpWorld.remove("obstacle".concat(e));for(var i=this.walkableRect.length-1;i>=0;i--)this.walkable.deleteObstacle(this.walkableRect[i]);if(1===this.gameConfig.mapNumber){this.tempEnemyPos.map2.length=0;for(var n=this.gameState.enemyIDs.length-1;n>=0;n--){var r=this.world.getComponent(this.gameState.enemyIDs[n],xt);this.tempEnemyPos.map2.push(r.pos),this.world.deleteEntity(this.gameState.enemyIDs[n]),this.gameState.enemyIDs.splice(n,1)}for(var s=0;s<this.tempEnemyPos.map1.length;s++){var a=new L.Yl([xt,_t,vt,yt,mt]),o=this.world.createEntityByArchetype(a);this.gameState.enemyIDs.push(o);var h=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],xt);h.pos.setVector(this.tempEnemyPos.map1[s]),h.setRadius(5),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],vt).setSpeed(.5);var u=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],mt);u.target=this.gameState.playerID,u.cooldownRequired=.025;var l=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],_t);l.setHp(100),l.setMaxHP(100),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],yt).setTarget(this.spartialPlayer.x,this.spartialPlayer.y)}this.port.nextMap=this.mapData.map1.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"nextMap"===t.name})),this.layersMapRender.walls=this.mapData.map1.layers.find((function(t){return"walls"===t.name})).data,this.layersMapRender.layer1=this.mapData.map1.layers.find((function(t){return"layer1"===t.name})).data,this.layersMapRender.layer2=this.mapData.map1.layers.find((function(t){return"layer2"===t.name})).data,this.layersMapRender.obstacle=this.mapData.map1.layers.find((function(t){return"obstacles"===t.name})).data,this.bumpWorld.move("player",this.port.nextMap.x-this.offsetTileMap/2,Mt.MAP_HEIGHT-this.port.nextMap.y+this.offsetTileMap+20)}if(2===this.gameConfig.mapNumber){this.tempEnemyPos.map3.length=0;for(var c=this.gameState.enemyIDs.length-1;c>=0;c--){var g=this.world.getComponent(this.gameState.enemyIDs[c],xt);this.tempEnemyPos.map3.push(g.pos),this.world.deleteEntity(this.gameState.enemyIDs[c]),this.gameState.enemyIDs.splice(c,1)}for(var d=0;d<this.tempEnemyPos.map2.length;d++){var f=new L.Yl([xt,_t,vt,yt,mt]),p=this.world.createEntityByArchetype(f);this.gameState.enemyIDs.push(p);var _=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],xt);_.pos.setVector(this.tempEnemyPos.map2[d]),_.setRadius(5),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],vt).setSpeed(.5);var v=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],mt);v.target=this.gameState.playerID,v.cooldownRequired=.025;var y=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],_t);y.setHp(100),y.setMaxHP(100),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],yt).setTarget(this.spartialPlayer.x,this.spartialPlayer.y)}this.port.preMap=this.mapData.map2.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"previousMap"===t.name})),this.port.nextMap=this.mapData.map2.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"nextMap"===t.name})),this.layersMapRender.walls=this.mapData.map2.layers.find((function(t){return"walls"===t.name})).data,this.layersMapRender.layer1=this.mapData.map2.layers.find((function(t){return"layer1"===t.name})).data,this.layersMapRender.layer2=this.mapData.map2.layers.find((function(t){return"layer2"===t.name})).data,this.layersMapRender.obstacle=this.mapData.map2.layers.find((function(t){return"obstacles"===t.name})).data,this.bumpWorld.move("player",this.port.nextMap.x-this.offsetTileMap/2,Mt.MAP_HEIGHT-this.port.nextMap.y+this.offsetTileMap-10)}if(3===this.gameConfig.mapNumber){this.tempEnemyPos.map4.length=0;for(var m=this.gameState.enemyIDs.length-1;m>=0;m--){var x=this.world.getComponent(this.gameState.enemyIDs[m],xt);this.tempEnemyPos.map4.push(x.pos),this.world.deleteEntity(this.gameState.enemyIDs[m]),this.gameState.enemyIDs.splice(m,1)}for(var M=0;M<this.tempEnemyPos.map3.length;M++){var w=new L.Yl([xt,_t,vt,yt,mt]),b=this.world.createEntityByArchetype(w);this.gameState.enemyIDs.push(b);var E=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],xt);E.pos.setVector(this.tempEnemyPos.map3[M]),E.setRadius(5),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],vt).setSpeed(.5);var S=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],mt);S.target=this.gameState.playerID,S.cooldownRequired=.025;var C=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],_t);C.setHp(100),C.setMaxHP(100),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],yt).setTarget(this.spartialPlayer.x,this.spartialPlayer.y)}this.port.preMap=this.mapData.map3.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"previousMap"===t.name})),this.port.nextMap=this.mapData.map3.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"nextMap"===t.name})),this.layersMapRender.walls=this.mapData.map3.layers.find((function(t){return"walls"===t.name})).data,this.layersMapRender.layer1=this.mapData.map3.layers.find((function(t){return"layer1"===t.name})).data,this.layersMapRender.layer2=this.mapData.map3.layers.find((function(t){return"layer2"===t.name})).data,this.layersMapRender.obstacle=this.mapData.map3.layers.find((function(t){return"obstacles"===t.name})).data,this.bumpWorld.move("player",this.port.nextMap.x-this.offsetTileMap/2,Mt.MAP_HEIGHT-this.port.nextMap.y+this.offsetTileMap+20)}for(var k=0;k<this.layersMapRender.obstacle.length;k++)this.layersMapRender.obstacle[k]&&(this.bumpWorld.add("obstacle".concat(k),this.obstacles[k].x,this.obstacles[k].y,this.obstacles[k].width,this.obstacles[k].height),this.walkableRect.push(this.walkable.addRect(this.obstacles[k].width,this.obstacles[k].height,this.obstacles[k].x,this.obstacles[k].y)))}if(this.gameConfig.mapNumber<4&&Math.abs(t.x-(this.port.nextMap.x-5))<=this.offsetTileMap/1.5&&Math.abs(t.y-(Mt.MAP_HEIGHT-this.port.nextMap.y+this.offsetTileMap+10))<=this.offsetTileMap/1.5){this.gameConfig.mapNumber++;for(var P=0;P<this.layersMapRender.obstacle.length;P++)this.layersMapRender.obstacle[P]&&this.bumpWorld.remove("obstacle".concat(P));for(var I=this.walkableRect.length-1;I>=0;I--)this.walkable.deleteObstacle(this.walkableRect[I]);if(2===this.gameConfig.mapNumber){this.tempEnemyPos.map1.length=0;for(var D=this.gameState.enemyIDs.length-1;D>=0;D--){var R=this.world.getComponent(this.gameState.enemyIDs[D],xt);this.tempEnemyPos.map1.push(R.pos),this.world.deleteEntity(this.gameState.enemyIDs[D]),this.gameState.enemyIDs.splice(D,1)}for(var T=0;T<this.tempEnemyPos.map2.length;T++){var A=new L.Yl([xt,_t,vt,yt,mt]),V=this.world.createEntityByArchetype(A);this.gameState.enemyIDs.push(V);var O=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],xt);O.pos.setVector(this.tempEnemyPos.map2[T]),O.setRadius(5),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],vt).setSpeed(.5);var F=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],mt);F.target=this.gameState.playerID,F.cooldownRequired=.025;var N=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],_t);N.setHp(100),N.setMaxHP(100),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],yt).setTarget(this.spartialPlayer.x,this.spartialPlayer.y)}this.port.spawn=this.mapData.map2.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"spawn"===t.name})),this.port.preMap=this.mapData.map2.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"previousMap"===t.name})),this.port.nextMap=this.mapData.map2.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"nextMap"===t.name})),this.layersMapRender.walls=this.mapData.map2.layers.find((function(t){return"walls"===t.name})).data,this.layersMapRender.layer1=this.mapData.map2.layers.find((function(t){return"layer1"===t.name})).data,this.layersMapRender.layer2=this.mapData.map2.layers.find((function(t){return"layer2"===t.name})).data,this.layersMapRender.obstacle=this.mapData.map2.layers.find((function(t){return"obstacles"===t.name})).data,this.bumpWorld.move("player",this.port.preMap.x-this.offsetTileMap/2,Mt.MAP_HEIGHT-this.port.preMap.y+this.offsetTileMap-10)}if(3===this.gameConfig.mapNumber){this.tempEnemyPos.map2.length=0;for(var j=this.gameState.enemyIDs.length-1;j>=0;j--){var B=this.world.getComponent(this.gameState.enemyIDs[j],xt);this.tempEnemyPos.map2.push(B.pos),this.world.deleteEntity(this.gameState.enemyIDs[j]),this.gameState.enemyIDs.splice(j,1)}for(var z=0;z<this.tempEnemyPos.map3.length;z++){var G=new L.Yl([xt,_t,vt,yt,mt]),W=this.world.createEntityByArchetype(G);this.gameState.enemyIDs.push(W);var H=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],xt);H.pos.setVector(this.tempEnemyPos.map3[z]),H.setRadius(5),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],vt).setSpeed(.5);var X=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],mt);X.target=this.gameState.playerID,X.cooldownRequired=.025;var Y=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],_t);Y.setHp(100),Y.setMaxHP(100),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],yt).setTarget(this.spartialPlayer.x,this.spartialPlayer.y)}this.layersMapRender.walls=this.mapData.map3.layers.find((function(t){return"walls"===t.name})).data,this.layersMapRender.layer1=this.mapData.map3.layers.find((function(t){return"layer1"===t.name})).data,this.layersMapRender.layer2=this.mapData.map3.layers.find((function(t){return"layer2"===t.name})).data,this.layersMapRender.obstacle=this.mapData.map3.layers.find((function(t){return"obstacles"===t.name})).data,this.port.preMap=this.mapData.map3.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"previousMap"===t.name})),this.port.nextMap=this.mapData.map3.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"nextMap"===t.name})),this.bumpWorld.move("player",this.port.preMap.x-this.offsetTileMap/2,Mt.MAP_HEIGHT-this.port.preMap.y+this.offsetTileMap+20)}if(4===this.gameConfig.mapNumber){this.tempEnemyPos.map3.length=0;for(var U=this.gameState.enemyIDs.length-1;U>=0;U--){var q=this.world.getComponent(this.gameState.enemyIDs[U],xt);this.tempEnemyPos.map3.push(q.pos),this.world.deleteEntity(this.gameState.enemyIDs[U]),this.gameState.enemyIDs.splice(U,1)}for(var Z=0;Z<this.tempEnemyPos.map4.length;Z++){var K=new L.Yl([xt,_t,vt,yt,mt]),J=this.world.createEntityByArchetype(K);this.gameState.enemyIDs.push(J);var Q=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],xt);Q.pos.setVector(this.tempEnemyPos.map4[Z]),Q.setRadius(5),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],vt).setSpeed(.5);var $=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],mt);$.target=this.gameState.playerID,$.cooldownRequired=.025;var tt=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],_t);tt.setHp(100),tt.setMaxHP(100),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],yt).setTarget(this.spartialPlayer.x,this.spartialPlayer.y)}this.layersMapRender.walls=this.mapData.map4.layers.find((function(t){return"walls"===t.name})).data,this.layersMapRender.layer1=this.mapData.map4.layers.find((function(t){return"layer1"===t.name})).data,this.layersMapRender.layer2=this.mapData.map4.layers.find((function(t){return"layer2"===t.name})).data,this.layersMapRender.obstacle=this.mapData.map4.layers.find((function(t){return"obstacles"===t.name})).data,this.port.preMap=this.mapData.map4.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"previousMap"===t.name})),this.bumpWorld.move("player",this.port.preMap.x-this.offsetTileMap/2,Mt.MAP_HEIGHT-this.port.preMap.y+this.offsetTileMap-20)}for(var et=0;et<this.layersMapRender.obstacle.length;et++)this.layersMapRender.obstacle[et]&&(this.bumpWorld.add("obstacle".concat(et),this.obstacles[et].x,this.obstacles[et].y,this.obstacles[et].width,this.obstacles[et].height),this.walkableRect.push(this.walkable.addRect(this.obstacles[et].width,this.obstacles[et].height,this.obstacles[et].x,this.obstacles[et].y)))}}}]),i}(L.xP),at=q(st.prototype,"bumpWorld",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ot=q(st.prototype,"gameConfig",[K],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ht=q(st.prototype,"port",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ut=q(st.prototype,"layersMapRender",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lt=q(st.prototype,"obstacles",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ct=q(st.prototype,"mapData",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gt=q(st.prototype,"tempEnemyPos",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),dt=q(st.prototype,"gameState",[it],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ft=q(st.prototype,"walkable",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pt=q(st.prototype,"walkableRect",[rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),st),Ht=(wt=(0,L.tB)("gameState"),bt=(0,L.tB)("bumpWorld"),Et=(0,L.tB)("layersMapRender"),St=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"gameState",Ct,G(t)),N(t,"bumpWorld",kt,G(t)),N(t,"layersMapRender",Pt,G(t)),t.spartialPlayer=new A.Vector2,t.direction=new A.Vector2,t.tempVec2=new A.Vector2,t.dcm=!1,t.spartialEnemy=new A.Vector2,t}return z(i,[{key:"process",value:function(){this.spartialPlayer.set(this.bumpWorld.getRect("player").x+this.bumpWorld.getRect("player").w/2,this.bumpWorld.getRect("player").y+this.bumpWorld.getRect("player").h/2);for(var t=0;t<this.gameState.enemyIDs.length;t++){var e=this.world.getComponent(this.gameState.enemyIDs[t],xt),i=this.world.getComponent(this.gameState.enemyIDs[t],vt);this.direction.setVector(i.direction).subVector(e.pos).nor(),e.pos.add(this.direction.x,this.direction.y)}}}]),i}(L.xP),Ct=q(St.prototype,"gameState",[wt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kt=q(St.prototype,"bumpWorld",[bt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pt=q(St.prototype,"layersMapRender",[Et],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),St),Xt=(It=(0,L.tB)("shapeRenderer"),Dt=(0,L.tB)("gameState"),Rt=(0,L.tB)("bumpWorld"),Tt=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",Lt,G(t)),N(t,"gameState",At,G(t)),N(t,"bumpWorld",Vt,G(t)),t}return z(i,[{key:"process",value:function(){this.shapeRenderer.begin();for(var t=0;t<this.gameState.enemyIDs.length;t++){var e=this.world.getComponent(this.gameState.enemyIDs[t],xt);this.world.getComponent(this.gameState.enemyIDs[t],_t);this.shapeRenderer.circle(!0,e.pos.x,e.pos.y,e.radius)}this.shapeRenderer.end()}}]),i}(L.xP),Lt=q(Tt.prototype,"shapeRenderer",[It],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=q(Tt.prototype,"gameState",[Dt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Vt=q(Tt.prototype,"bumpWorld",[Rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Tt);function Yt(t,e){return Math.floor(Math.random()*(e-t))+t}var Ut,qt,Zt,Kt,Jt,Qt,$t,te,ee,ie,ne,re,se,ae,oe,he,ue,le,ce,ge,de,fe,pe,_e,ve,ye,me,xe,Me,we,be,Ee,Se,Ce,ke,Pe,Ie,De,Re,Te,Le,Ae,Ve,Oe,Fe,Ne=(Ot=(0,L.tB)("gameState"),Ft=(0,L.tB)("bumpWorld"),Nt=(0,L.tB)("layersMapRender"),jt=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"gameState",Bt,G(t)),N(t,"bumpWorld",zt,G(t)),N(t,"layersMapRender",Gt,G(t)),t.MAX_ENEMIES=2,t.remainingTimeSpawnEnemy=0,t.posSpawnEnemy=new A.Vector2,t.tempVec2=new A.Vector2,t.tempboolean=!1,t.spartialPlayer=new A.Vector2,t}return z(i,[{key:"process",value:function(){if(this.remainingTimeSpawnEnemy+=this.world.delta,this.spartialPlayer.set(this.bumpWorld.getRect("player").x+this.bumpWorld.getRect("player").w/2,this.bumpWorld.getRect("player").y+this.bumpWorld.getRect("player").h/2),this.remainingTimeSpawnEnemy>1&&this.gameState.enemyIDs.length<this.MAX_ENEMIES){var t=new L.Yl([xt,_t,vt,yt,mt]),e=this.world.createEntityByArchetype(t);do{this.posSpawnEnemy.set(Yt(0,Mt.MAP_WIDTH),Yt(20,Mt.MAP_HEIGHT)),this.tempboolean=!1;for(var i=0;i<this.layersMapRender.obstacle.length;i++)this.layersMapRender.obstacle[i]&&this.tempVec2.set(this.bumpWorld.getRect("obstacle".concat(i)).x+this.bumpWorld.getRect("obstacle".concat(i)).w/2,this.bumpWorld.getRect("obstacle".concat(i)).y+this.bumpWorld.getRect("obstacle".concat(i)).h/2),this.posSpawnEnemy.distance(this.tempVec2)<15&&(this.tempboolean=!0)}while(this.tempboolean);this.gameState.enemyIDs.push(e);var n=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],xt);n.pos.setVector(this.posSpawnEnemy),n.setRadius(5),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],vt).setSpeed(.5);var r=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],mt);r.target=this.gameState.playerID,r.cooldownRequired=.025;var s=this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],_t);s.setHp(100),s.setMaxHP(100),this.world.getComponent(this.gameState.enemyIDs[this.gameState.enemyIDs.length-1],yt).setTarget(this.spartialPlayer.x,this.spartialPlayer.y),this.remainingTimeSpawnEnemy=0}}}]),i}(L.xP),Bt=q(jt.prototype,"gameState",[Ot],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zt=q(jt.prototype,"bumpWorld",[Ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gt=q(jt.prototype,"layersMapRender",[Nt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),jt),je=(Ut=(0,L.tB)("shapeRenderer"),qt=(0,L.tB)("batch"),Zt=(0,L.tB)("tileSetsRegions"),Kt=(0,L.tB)("layersMapRender"),Jt=(0,L.tB)("rects"),Qt=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",$t,G(t)),N(t,"batch",te,G(t)),N(t,"tileSetsRegions",ee,G(t)),N(t,"layersMapRender",ie,G(t)),N(t,"rects",ne,G(t)),t}return z(i,[{key:"initialized",value:function(){for(var t=0;t<Mt.MAP_GRID_COLS;t++)for(var e=0;e<Mt.MAP_GRID_ROWS;e++)this.rects.push({x:Mt.CELL_WIDTH*e,y:Mt.CELL_HEIGHT*Mt.MAP_GRID_ROWS-Mt.CELL_HEIGHT*t,width:Mt.CELL_WIDTH,height:Mt.CELL_HEIGHT})}},{key:"process",value:function(){var t=this;this.batch.begin(),this.layersMapRender.walls.forEach((function(e,i){var n=t.tileSetsRegions[e-1],r=t.rects[i];n.draw(t.batch,r.x,r.y,r.width,r.height)})),this.layersMapRender.layer1.forEach((function(e,i){if(e){var n=t.tileSetsRegions[e-1],r=t.rects[i];n.draw(t.batch,r.x,r.y,r.width,r.height)}})),this.layersMapRender.layer2.forEach((function(e,i){if(e){var n=t.tileSetsRegions[e-1],r=t.rects[i];n.draw(t.batch,r.x,r.y,r.width,r.height)}})),this.batch.end()}}]),i}(L.xP),$t=q(Qt.prototype,"shapeRenderer",[Ut],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=q(Qt.prototype,"batch",[qt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ee=q(Qt.prototype,"tileSetsRegions",[Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ie=q(Qt.prototype,"layersMapRender",[Kt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ne=q(Qt.prototype,"rects",[Jt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Qt),Be=(re=(0,L.rr)(vt),se=(0,L.rr)(xt),ae=function(t){H(i,t);var e=U(i);function i(){var t;return j(this,i),N(t=e.call(this,[xt,vt]),"movableMapper",oe,G(t)),N(t,"spartialMapper",he,G(t)),t.tmp=new A.Vector2(0,0),t}return z(i,[{key:"processEntity",value:function(t){var e=this.movableMapper,i=this.spartialMapper,n=this.tmp,r=e.get(t),s=i.get(t),a=this.world.delta,o=s.pos,h=r.direction,u=r.speed;n.setVector(h).subVector(o),n.len()>=u*a?n.nor().scale(u):(n.scale(a),r.setActive(!1))}}]),i}(L.Iw),oe=q(ae.prototype,"movableMapper",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),he=q(ae.prototype,"spartialMapper",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae),ze=(ue=(0,L.tB)("bumpWorld"),le=(0,L.tB)("mapData"),ce=(0,L.tB)("obstacles"),ge=(0,L.tB)("layersMapRender"),de=(0,L.tB)("walkable"),fe=(0,L.tB)("shapeRenderer"),pe=(0,L.tB)("walkableRect"),_e=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"bumpWorld",ve,G(t)),N(t,"mapData",ye,G(t)),N(t,"obstacles",me,G(t)),N(t,"layersMapRender",xe,G(t)),N(t,"walkable",Me,G(t)),t.temp=void 0,N(t,"shapeRenderer",we,G(t)),N(t,"walkableRect",be,G(t)),t}return z(i,[{key:"initialized",value:function(){for(var t=0;t<this.layersMapRender.obstacle.length;t++)this.layersMapRender.obstacle[t]&&(this.bumpWorld.add("obstacle".concat(t),this.obstacles[t].x,this.obstacles[t].y,this.obstacles[t].width,this.obstacles[t].height),this.walkableRect.push(this.walkable.addRect(this.obstacles[t].width,this.obstacles[t].height,this.obstacles[t].x,this.obstacles[t].y)))}},{key:"process",value:function(){}}]),i}(L.xP),ve=q(_e.prototype,"bumpWorld",[ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ye=q(_e.prototype,"mapData",[le],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),me=q(_e.prototype,"obstacles",[ce],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xe=q(_e.prototype,"layersMapRender",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Me=q(_e.prototype,"walkable",[de],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),we=q(_e.prototype,"shapeRenderer",[fe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),be=q(_e.prototype,"walkableRect",[pe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_e),Ge=(Ee=(0,L.tB)("walkable"),Se=(0,L.tB)("shapeRenderer"),Ce=function(t){H(i,t);var e=U(i);function i(){var t;return j(this,i),N(t=e.call(this,[yt,vt,xt]),"walkable",ke,G(t)),N(t,"shapeRenderer",Pe,G(t)),t}return z(i,[{key:"processEntity",value:function(t){var e=this.world,i=this.walkable,n=e.getComponent(t,yt),r=e.getComponent(t,vt),s=e.getComponent(t,xt);if(n.active){if(0===n.path.length)try{i.findPath(s.pos.x,s.pos.y,n.target.x+s.radius,n.target.y+s.radius,s.radius/2,n.path)}catch(a){console.log("pathfinding issue")}n.path.length>0&&(n.index<n.path.length/2-1?(n.index++,r.setDirection(n.path[2*n.index],n.path[2*n.index+1])):(n.index=-1,n.path.length=0))}}}]),i}(L.Iw),ke=q(Ce.prototype,"walkable",[Ee],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Pe=q(Ce.prototype,"shapeRenderer",[Se],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ce),We=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(t=e.call.apply(e,[this].concat(r))).damage=void 0,t}return z(i,[{key:"setDmg",value:function(t){this.damage=t}}]),i}(L.wA);var He,Xe,Ye,Ue,qe,Ze,Ke,Je,Qe,$e,ti,ei,ii,ni,ri,si,ai,oi,hi,ui,li,ci,gi,di,fi,pi,_i,vi,yi,mi,xi,Mi,wi,bi,Ei=(Ie=(0,L.tB)("inputHandler"),De=(0,L.tB)("joyStick"),Re=(0,L.tB)("bumpWorld"),Te=(0,L.tB)("gameState"),Le=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"inputHandler",Ae,G(t)),N(t,"joyStick",Ve,G(t)),N(t,"bumpWorld",Oe,G(t)),N(t,"gameState",Fe,G(t)),t}return z(i,[{key:"initialized",value:function(){var t=new L.Yl([xt,_t,We]),e=this.world.createEntityByArchetype(t);this.gameState.playerID=e,this.world.getComponent(this.gameState.playerID,xt).setPos(this.bumpWorld.getRect("player").x,this.bumpWorld.getRect("player").y);var i=this.world.getComponent(this.gameState.playerID,_t);i.setHp(100),i.setMaxHP(100),this.world.getComponent(this.gameState.playerID,We).setDmg(3)}},{key:"process",value:function(){var t=this.bumpWorld.getRect("player"),e=function(t,e,i){return t.isTouched()?(e.origin.set(i.x,i.y),e.thumbPos.setVector(t.getTouchedWorldCoord()),e.direction.setVector(e.thumbPos).subVector(e.origin).nor()):e.direction.set(0,0),e.direction}(this.inputHandler,this.joyStick,t),i=this.world.getComponent(this.gameState.playerID,xt);this.bumpWorld.move("player",t.x+e.x,t.y+e.y),i.setPos(this.bumpWorld.getRect("player").x,this.bumpWorld.getRect("player").y)}}]),i}(L.xP),Ae=q(Le.prototype,"inputHandler",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ve=q(Le.prototype,"joyStick",[De],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oe=q(Le.prototype,"bumpWorld",[Re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fe=q(Le.prototype,"gameState",[Te],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Le),Si=(He=(0,L.tB)("shapeRenderer"),Xe=(0,L.tB)("bumpWorld"),Ye=(0,L.tB)("currentMapData"),Ue=(0,L.tB)("port"),qe=(0,L.tB)("gameState"),Ze=(0,L.tB)("obstacles"),Ke=(0,L.tB)("layersMapRender"),Je=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",Qe,G(t)),N(t,"bumpWorld",$e,G(t)),N(t,"currentMapData",ti,G(t)),N(t,"port",ei,G(t)),N(t,"gameState",ii,G(t)),N(t,"obstacles",ni,G(t)),N(t,"layersMapRender",ri,G(t)),t.checkWall=!1,t}return z(i,[{key:"process",value:function(){var t=this.bumpWorld.getRect("player"),e=this.world.getComponent(this.gameState.playerID,xt);this.shapeRenderer.begin(),this.shapeRenderer.rect(!0,e.pos.x,e.pos.y,t.w,t.h,A.Color.GREEN),this.shapeRenderer.end()}}]),i}(L.xP),Qe=q(Je.prototype,"shapeRenderer",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),$e=q(Je.prototype,"bumpWorld",[Xe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ti=q(Je.prototype,"currentMapData",[Ye],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ei=q(Je.prototype,"port",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ii=q(Je.prototype,"gameState",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=q(Je.prototype,"obstacles",[Ze],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ri=q(Je.prototype,"layersMapRender",[Ke],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Je),Ci=(si=(0,L.tB)("gameState"),ai=(0,L.tB)("bumpWorld"),oi=(0,L.tB)("layersMapRender"),hi=(0,L.tB)("obstacles"),ui=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"gameState",li,G(t)),N(t,"bumpWorld",ci,G(t)),N(t,"layersMapRender",gi,G(t)),N(t,"obstacles",di,G(t)),t.tempVec2Obstacle=new A.Vector2,t}return z(i,[{key:"process",value:function(){for(var t=this.gameState.bulletIDs.length-1;t>=0;t--){var e=this.world.getComponent(this.gameState.bulletIDs[t],xt),i=this.world.getComponent(this.gameState.bulletIDs[t],vt);this.world.getComponent(this.gameState.bulletIDs[t],We);e.pos.add(i.direction.x*i.speed,i.direction.y*i.speed);for(var n=0;n<this.layersMapRender.obstacle.length;n++)this.layersMapRender.obstacle[n]&&(this.tempVec2Obstacle.set(this.bumpWorld.getRect("obstacle".concat(n)).x+this.bumpWorld.getRect("obstacle".concat(n)).w/2,this.bumpWorld.getRect("obstacle".concat(n)).y+this.bumpWorld.getRect("obstacle".concat(n)).h/2),e.pos.distance(this.tempVec2Obstacle)<this.bumpWorld.getRect("obstacle".concat(n)).w/2&&(this.world.deleteEntity(this.gameState.bulletIDs[t]),this.gameState.bulletIDs.splice(t,1)));for(var r=this.gameState.enemyIDs.length-1;r>=0;r--){this.world.getComponent(this.gameState.enemyIDs[r],xt).pos.distance(e.pos)<5&&(this.world.deleteEntity(this.gameState.enemyIDs[r]),this.gameState.enemyIDs.splice(r,1),this.world.deleteEntity(this.gameState.bulletIDs[t]),this.gameState.bulletIDs.splice(t,1))}}}}]),i}(L.xP),li=q(ui.prototype,"gameState",[si],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ci=q(ui.prototype,"bumpWorld",[ai],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gi=q(ui.prototype,"layersMapRender",[oi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),di=q(ui.prototype,"obstacles",[hi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ui),ki=(fi=(0,L.tB)("shapeRenderer"),pi=(0,L.tB)("gameState"),_i=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"shapeRenderer",vi,G(t)),N(t,"gameState",yi,G(t)),t}return z(i,[{key:"process",value:function(){this.shapeRenderer.begin();for(var t=0;t<this.gameState.bulletIDs.length;t++){var e=this.world.getComponent(this.gameState.bulletIDs[t],xt);this.shapeRenderer.circle(!0,e.pos.x,e.pos.y,e.radius)}this.shapeRenderer.end()}}]),i}(L.xP),vi=q(_i.prototype,"shapeRenderer",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),yi=q(_i.prototype,"gameState",[pi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_i),Pi=(mi=(0,L.tB)("gameState"),xi=(0,L.tB)("bumpWorld"),Mi=function(t){H(i,t);var e=U(i);function i(){var t;j(this,i);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return N(t=e.call.apply(e,[this].concat(r)),"gameState",wi,G(t)),N(t,"bumpWorld",bi,G(t)),t.attackSpeed=1,t.time=0,t.tempDistance=0,t.spartialPlayer=new A.Vector2,t.tempVec2=new A.Vector2,t.offsetW=0,t.offsetH=0,t.checkEnemy=!1,t}return z(i,[{key:"initialized",value:function(){this.offsetW=this.bumpWorld.getRect("player").w,this.offsetH=this.bumpWorld.getRect("player").h}},{key:"process",value:function(){this.time+=this.world.delta,this.spartialPlayer.set(this.bumpWorld.getRect("player").x+this.bumpWorld.getRect("player").w/2,this.bumpWorld.getRect("player").y+this.bumpWorld.getRect("player").h/2);for(var t=0;t<this.gameState.enemyIDs.length;t++){if(4===this.world.getComponent(this.gameState.enemyIDs[t],yt).path.length){this.checkEnemy=!0;break}this.checkEnemy=!1}if(this.time>=this.attackSpeed&&this.checkEnemy){var e=new L.Yl([xt,vt,We]),i=this.world.createEntityByArchetype(e);this.gameState.bulletIDs.push(i);var n=this.world.getComponent(this.gameState.bulletIDs[this.gameState.bulletIDs.length-1],xt),r=this.world.getComponent(this.gameState.bulletIDs[this.gameState.bulletIDs.length-1],vt);this.world.getComponent(this.gameState.bulletIDs[this.gameState.bulletIDs.length-1],We).setDmg(5);var s=this.world.getComponent(this.gameState.enemyIDs[0],xt);this.tempDistance=s.pos.distance(this.spartialPlayer),this.tempVec2.setVector(s.pos).subVector(this.spartialPlayer).nor();for(var a=0;a<this.gameState.enemyIDs.length;a++){var o=this.world.getComponent(this.gameState.enemyIDs[a],xt);this.tempDistance>=o.pos.distance(this.spartialPlayer)&&(this.tempDistance=o.pos.distance(this.spartialPlayer),this.tempVec2.setVector(o.pos).subVector(this.spartialPlayer).nor())}n.setPos(this.spartialPlayer.x,this.spartialPlayer.y),n.setRadius(3),r.setDirection(this.tempVec2.x,this.tempVec2.y),r.speed=5,this.time=0}}}]),i}(L.xP),wi=q(Mi.prototype,"gameState",[mi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),bi=q(Mi.prototype,"bumpWorld",[xi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Mi),Ii=function(t){H(i,t);var e=U(i);function i(){return j(this,i),e.call(this,[mt,yt])}return z(i,[{key:"processEntity",value:function(t){var e=this.world.getComponent(t,mt),i=this.world.getComponent(t,yt);if(e.cooldownLeft>0)e.cooldownLeft-=this.world.delta;else{var n=this.world.getComponent(e.target,xt).pos;i.setTarget(n.x,n.y),e.cooldownLeft=e.cooldownRequired}}}]),i}(L.Iw),Di=function(){var t,i=(t=e().mark((function t(){var i,n,r,s,a,o,h,u,l,c,g,d,f,p,_,v,y,m,x,M,w,b,E,S,C;return e().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=(0,A.createStage)(),n=i.getCanvas(),r=(0,A.createViewport)(n,Mt.MAP_WIDTH,Mt.MAP_HEIGHT+20),s=r.getContext(),a=new A.PolygonBatch(s),o=new A.ShapeRenderer(s),h=r.getCamera(),u=new L.q3,t.next=10,A.Texture.load(s,"./tiles_dungeon_v1.1.png");case 10:return l=t.sent,c=A.TextureRegion.splitTexture(l,20,24),s.clearColor(0,0,0,1),g=new A.ViewportInputHandler(r),d={mapNumber:1,changePreMap:!1,changeCurrentMap:!0,changeNextMap:!1},f={preMap:null,spawn:null,nextMap:null},t.next=18,fetch("./01.tmj").then((function(t){return t.json()}));case 18:return t.t0=t.sent,t.next=21,fetch("./02.tmj").then((function(t){return t.json()}));case 21:return t.t1=t.sent,t.next=24,fetch("./03.tmj").then((function(t){return t.json()}));case 24:return t.t2=t.sent,t.next=27,fetch("./04.tmj").then((function(t){return t.json()}));case 27:for(t.t3=t.sent,p={map1:t.t0,map2:t.t1,map3:t.t2,map4:t.t3},f.spawn=p.map1.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"spawn"===t.name})),f.preMap=p.map1.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"previousMap"===t.name})),f.nextMap=p.map1.layers.find((function(t){return"data"===t.name})).objects.find((function(t){return"nextMap"===t.name})),_={origin:new V.Vector2,direction:new V.Vector2,thumbPos:new V.Vector2,touched:!1,move:!1,dragging:!1},v={walls:p.map1.layers.find((function(t){return"walls"===t.name})).data,layer1:p.map1.layers.find((function(t){return"layer1"===t.name})).data,layer2:p.map1.layers.find((function(t){return"layer2"===t.name})).data,obstacle:p.map1.layers.find((function(t){return"obstacles"===t.name})).data},y=[],m=[],x=0;x<Mt.MAP_GRID_COLS;x++)for(M=0;M<Mt.MAP_GRID_ROWS;M++)m.push({x:Mt.CELL_WIDTH*M,y:Mt.CELL_HEIGHT*Mt.MAP_GRID_ROWS-Mt.CELL_HEIGHT*x,width:Mt.CELL_WIDTH,height:Mt.CELL_HEIGHT});w=T.newWorld(Mt.CELL_WIDTH),b=new(F())(Mt.MAP_WIDTH,Mt.MAP_HEIGHT),w.add("player",f.spawn.x-5,Mt.MAP_HEIGHT-f.spawn.y+10,10,10),E={playerID:0,enemyIDs:[],bulletIDs:[]},S={map1:[],map2:[],map3:[],map4:[]},C=[],u.register("bumpWorld",w),u.register("walkable",b),u.register("gameState",E),u.register("inputHandler",g),u.register("joyStick",_),u.register("shapeRenderer",o),u.register("batch",a),u.register("rects",y),u.register("obstacles",m),u.register("tileSetsRegions",c),u.register("gameConfig",d),u.register("port",f),u.register("walkableRect",C),u.register("tempEnemyPos",S),u.register("layersMapRender",v),u.register("mapData",p),u.addSystem(new ze,!0),u.addSystem(new Ei,!0),u.addSystem(new Wt,!0),u.addSystem(new Ge,!0),u.addSystem(new Ne,!0),u.addSystem(new Ht,!0),u.addSystem(new Ii,!0),u.addSystem(new Be,!0),u.addSystem(new Pi,!0),u.addSystem(new Ci,!0),u.addSystem(new je,!1),u.addSystem(new Si,!1),u.addSystem(new Xt,!1),u.addSystem(new ki,!1),(0,A.createGameLoop)((function(t){s.clear(s.COLOR_BUFFER_BIT),a.setProjection(h.combined),o.setProjection(h.combined),u.setDelta(t),u.processActiveSystem(),u.processPassiveSystem()}));case 75:case"end":return t.stop()}}),t)})),function(){var e=this,i=arguments;return new Promise((function(r,s){var a=t.apply(e,i);function o(t){n(a,r,s,o,h,"next",t)}function h(t){n(a,r,s,o,h,"throw",t)}o(void 0)}))});return function(){return i.apply(this,arguments)}}();Di()}()}();
//# sourceMappingURL=main.42ee9153.js.map